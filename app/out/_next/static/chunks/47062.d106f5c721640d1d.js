"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[47062],{47062:function(e,t,r){r.r(t),r.d(t,{ChartScatterplotVisualization:function(){return Q}});var n=r(17043),i=r(27378),a=r(93226),o=r(80491);let l=(e,t,r)=>{let{transition:n}=r;e.selectAll("circle").data(t,e=>e.key).join(e=>e.append("circle").attr("data-index",(e,t)=>t).attr("cx",e=>e.cx).attr("cy",e=>e.cy).attr("r",4).attr("fill",e=>e.color).attr("opacity",0).call(e=>(0,o.u5)(e,{transition:n,s:e=>e.attr("opacity",1)})),e=>(0,o.u5)(e,{transition:n,s:e=>e.attr("cx",e=>e.cx).attr("cy",e=>e.cy).attr("fill",e=>e.color).attr("opacity",1)}),e=>(0,o.u5)(e,{transition:n,s:e=>e.attr("opacity",0).remove()}))};var s=r(43137),c=r(80733),u=r(24246);let p=()=>{let{chartData:e,bounds:t,getX:r,xScale:n,getY:a,yScale:p,getSegment:d,colors:f,getRenderingKey:m}=(0,s.gH)(),{margins:b}=t,g=(0,i.useRef)(null),y=(0,c.K)(e=>e.enable),h=(0,c.K)(e=>e.duration),j=(0,i.useMemo)(()=>e.map(e=>{let t=d(e);return{key:m(e),cx:n(r(e)??NaN),cy:p(a(e)??NaN),color:f(t)}}),[e,d,m,n,r,p,a,f]);return(0,i.useEffect)(()=>{g.current&&j&&(0,o.sS)(g.current,{id:"scatterplot",transform:`translate(${b.left} ${b.top})`,transition:{enable:y,duration:h},render:(e,t)=>l(e,j,t)})},[y,b.left,b.top,j,h]),(0,u.jsx)("g",{ref:g})};var d=r(90089),f=r(49951),m=r(47626),b=r(36890),g=r(67291),y=r(43605),h=r.n(y),j=r(97091),x=r(25390);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let w=e=>{let{chartConfig:t,observations:r,dimensions:n,dimensionsById:i,measuresById:a}=e,{fields:l}=t,{x:c,y:u,segment:p,animation:d}=l,f=(0,x.In)(t),m=(0,s.Ck)(t),b=(0,s.Zr)("scatterplot",c,{measuresById:a}),g=(0,s.rl)("scatterplot",u,{measuresById:a}),y=(0,s.HR)(p,{dimensionsById:i,observations:r}),h=(0,o.Tw)(n,f,d);return O(O(O(O(O({},m),b),g),y),{},{getRenderingKey:h})},k=(e,t)=>{let{chartConfig:r,observations:n}=e,{getX:i,getY:a,getSegmentAbbreviationOrLabel:o}=t,l=(0,j.Tq)(n,{getX:i,getY:a});return(0,s.q1)(l,{chartConfig:r,timeRangeDimensionId:void 0,getSegmentAbbreviationOrLabel:o})};var P=r(86932),N=r(71532),S=r(91160),Z=r(81364),D=r(93477),C=r(41494),E=r(41282),T=r(7673),M=r(98016);let $=["children"];function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let H=(e,t,r)=>{let{chartConfig:n}=e,{getX:a,getMinX:o,xAxisLabel:l,getY:s,getMinY:c,yAxisLabel:p,segmentDimension:d,segmentsByAbbreviationOrLabel:y,getSegment:j,getSegmentAbbreviationOrLabel:x,getSegmentLabel:v}=t,{chartData:O,scalesData:w,segmentData:k,paddingData:Z,allData:$}=r,{fields:L,interactiveFiltersConfig:H}=n,{width:I,height:z}=(0,D.tH)(),F=(0,C.D2)({decimals:"auto"}),R=(0,i.useMemo)(()=>new Map((d?.values||[]).map(e=>[e.value,e])),[d?.values]),K=o(w,a),V=(0,f.Z)(w,e=>a(e))??0,U=(0,m.Z)().domain([K,V]).nice(),W=c(w,s),X=(0,f.Z)(w,s)??0,_=(0,m.Z)().domain([W,X]).nice(),B=c(Z,s),Y=(0,f.Z)(Z,s)??0,q=(0,m.Z)().domain([B,Y]).nice(),G=d?.id?n.cubes.find(e=>e.iri===d.cubeIri)?.filters[d.id]:void 0,J=(0,i.useMemo)(()=>{let e=Array.from(new Set(k.map(j))),t={sortingType:"byAuto",sortingOrder:"asc"},r=(0,T.tf)(d,{sorting:t,useAbbreviations:L.segment?.useAbbreviations,dimensionFilter:G});return h()(e,r,(0,T.jS)(r,t))},[L.segment?.useAbbreviations,j,k,d,G]),Q=(0,b.Z)();if(L.segment&&d&&L.color){let e=J.map(e=>{let t=y.get(e)?.value||R.get(e)?.value||"";return{label:e,color:"segment"===L.color.type?L.color.colorMapping[t]??g.Z[0]:g.Z[0]}});Q.domain(e.map(e=>e.label)),Q.range(e.map(e=>e.color))}else Q.domain(J),Q.range((0,E.XN)({paletteId:L.color.paletteId,colorField:L.color}));let{top:ee,left:et,bottom:er}=(0,P.u8)({xLabelPresent:!!l,yScale:q,width:I,height:z,interactiveFiltersConfig:H,formatNumber:F}),en=(0,P.Ti)({label:p,width:I}),ei=(0,P.Ti)({label:l,width:I}),ea={top:S.L+ee+en.offset,right:40,bottom:er+ei.offset,left:et},eo=(0,P.vG)({width:I,left:et,right:40}),el=(0,P.dE)({width:I,chartWidth:eo,height:z,margins:ea}),{chartHeight:es}=el;U.range([0,eo]),_.range([es,0]);let ec=(0,M.d)(),eu=(0,i.useCallback)((e,t)=>{let{segment:r}=t;return{x:U(a(e)??0),y:_(s(e)??0),color:Q(r)}},[U,a,_,s,Q]);return A({chartType:"scatterplot",bounds:el,chartData:O,allData:$,xScale:U,yScale:_,segments:J,colors:Q,getColorLabel:v,getAnnotationInfo:eu,getTooltipInfo:e=>{let t=U(a(e)??NaN),r=_(s(e)??NaN),n=ec?0:r,i=t<.33*eo?"right":t>.66*eo?"left":"center",o=n>.33*es?"top":n<.66*es?"bottom":"middle";return{xAnchor:t,yAnchor:n,placement:ec?{x:"center",y:"top"}:{x:i,y:o},value:F(a(e)),tooltipContent:(0,u.jsx)(N.E5,{firstLine:L.segment&&x(e),secondLine:`${l}: ${F(a(e))}`,thirdLine:`${p}: ${F(s(e))}`}),datum:{label:L.segment&&x(e),value:F(s(e)),color:Q(j(e))},values:void 0}},leftAxisLabelSize:en,leftAxisLabelOffsetTop:ee,bottomAxisLabelSize:ei},t)},I=e=>{let{children:t}=e,r=(0,d.Z)(e,$),n=w(r),i=k(r,n),a=H(r,n,i);return(0,u.jsx)(s._M.Provider,{value:a,children:t})},z=e=>(0,u.jsx)(Z.o,{children:(0,u.jsx)(I,A({},e))});var F=r(93730),R=r(35696),K=r(48660),V=r(2424),U=r(83001),W=r(36831),X=r(83002),_=r(18984),B=r(80750),Y=r(62500),q=r(4148);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function J(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let Q=e=>(0,u.jsx)(a.F,J(J({},e),{},{Component:ee})),ee=(0,i.memo)(e=>{let{chartConfig:t,dimensions:r,dimensionsById:n}=e,{fields:i,interactiveFiltersConfig:a}=t,o=(0,x.In)(t),l=(0,F.I4)();return(0,u.jsxs)(z,J(J({},e),{},{children:[(0,u.jsxs)(U.BO,{children:[(0,u.jsxs)(U.ST,{children:[(0,u.jsx)(V.L,{}),(0,u.jsx)(K.aP,{}),(0,u.jsx)(V.b,{}),(0,u.jsx)(K.jV,{}),(0,u.jsx)(p,{}),(0,u.jsx)(Y.w,{})]}),(0,u.jsx)(X.x,{}),l?(0,u.jsx)(W.r,{}):(0,u.jsx)(_.u,{type:"single"})]}),(0,u.jsx)(R.u,{}),(i.animation||i.segment)&&(0,u.jsxs)(U.dt,{children:[i.animation&&(0,u.jsx)(q.j,J({filters:o,dimensions:r},i.animation)),i.segment&&(0,u.jsx)(B.Ek,{dimensionsById:n,chartConfig:t,symbol:"circle",interactive:a.legend.active,showTitle:i.segment.showTitle})]})]}))})},2424:function(e,t,r){r.d(t,{L:function(){return m},b:function(){return b}});var n=r(27454),i=r(27378),a=r(86932),o=r(43137),l=r(80491),s=r(3663),c=r(97358),u=r(41494),p=r(80733),d=r(87358),f=r(24246);let m=()=>{let e=(0,u.D2)(),{xScale:t,bounds:r,xAxisLabel:m,xMeasure:b,chartType:g,bottomAxisLabelSize:y}=(0,o.gH)(),{chartWidth:h,chartHeight:j,margins:x}=r,{labelColor:v,labelFontSize:O,axisLabelFontSize:w,gridColor:k,fontFamily:P}=(0,s.$)(),N=(0,a.Fc)(),S=(0,i.useRef)(null),Z=(0,p.K)(e=>e.enable),D=(0,p.K)(e=>e.duration);return(0,i.useEffect)(()=>{if(S.current){let i=(0,d.m)(e(t.domain()[1]),{fontSize:O}),a=Math.min(r.chartWidth/(i+20),4),o=t.ticks(a),s=(0,n.LL)(t).tickValues(o).tickSizeInner(-j-10).tickSizeOuter(-j).tickFormat(e),c=(0,l.sS)(S.current,{id:"axis-width-linear",transform:`translate(${x.left} ${j+x.top})`,transition:{enable:Z,duration:D},render:e=>e.call(s),renderUpdate:(e,t)=>(0,l.u5)(e,{transition:t.transition,s:e=>e.call(s)})});c.selectAll(".tick line").attr("y1",10).attr("stroke",(e,t)=>0===t?"#000000":k).attr("stroke-width",1),c.selectAll(".tick text").attr("font-size",O).attr("font-family",P).attr("fill",v).attr("dy",O+10).attr("text-anchor","middle"),c.select("path.domain").attr("stroke",k),"bar"===g&&c.select("path.domain").remove()}},[g,r.chartWidth,j,Z,P,e,k,v,O,x.left,x.top,D,t]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("foreignObject",{x:x.left+h/2-y.width/2,y:x.top+j+N,width:h,height:y.height,style:{display:"flex"},children:(0,f.jsx)(c.K,{component:b,children:(0,f.jsx)("span",{style:{fontSize:w,lineHeight:1.5},children:m})})}),(0,f.jsx)("g",{ref:S})]})},b=()=>{let{xScale:e,yScale:t,bounds:r}=(0,o.gH)(),{chartHeight:a,margins:c}=r,{domainColor:u}=(0,s.$)(),d=(0,i.useRef)(null),m=(0,p.K)(e=>e.enable),b=(0,p.K)(e=>e.duration);return(0,i.useEffect)(()=>{if(d.current){let i=(0,n.LL)(e).tickSizeOuter(0),o=(0,l.sS)(d.current,{id:"axis-width-linear-domain",transform:`translate(${c.left} ${a+c.top})`,transition:{enable:m,duration:b},render:e=>e.call(i),renderUpdate:(e,t)=>(0,l.u5)(e,{transition:t.transition,s:e=>e.call(i)})});o.selectAll(".tick line").remove(),o.selectAll(".tick text").remove(),o.select("path.domain").attr("data-name","width-axis-domain").attr("transform",`translate(0, -${r.chartHeight-t(0)})`).attr("stroke",u)}},[r.chartHeight,a,u,m,c.left,c.top,b,e,t]),(0,f.jsx)("g",{ref:d})}},83002:function(e,t,r){r.d(t,{x:function(){return s}});var n=r(64986),i=r(43137),a=r(81364),o=r(98016),l=r(24246);let s=e=>{let{rotate:t=!1}=e,[{type:r,visible:n,observation:i}]=(0,a.X)();return(0,l.jsx)(l.Fragment,{children:"tooltip"===r&&n&&i&&(0,l.jsx)(c,{d:i,rotate:t})})},c=e=>{let{d:t,rotate:r}=e,{getTooltipInfo:n,bounds:a}=(0,i.gH)(),{xAnchor:o,value:s,datum:c,placement:u,values:d}=n(t);return(0,l.jsx)(p,{rotate:r,xValue:s,values:d,chartHeight:a.chartHeight,margins:a.margins,xAnchor:o,datum:c,placement:u})},u=(0,n.Z)(e=>({left:{width:0,position:"absolute",borderWidth:.5,borderStyle:"solid",borderColor:e.palette.cobalt[50],pointerEvents:"none",transform:"translateX(-50%)"},right:{position:"absolute",fontWeight:"bold",backgroundColor:e.palette.background.paper,transform:e=>{let{rotate:t}=e;return t?"translateX(-50%) translateY(50%) rotate(90deg)":"translateX(-50%)"},paddingLeft:e.spacing(1),paddingRight:e.spacing(1),fontSize:"0.875rem"}})),p=e=>{let{rotate:t,xValue:r,chartHeight:n,margins:i,xAnchor:a}=e,s=u({rotate:t}),c=(0,o.d)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:s.left,style:{height:n,left:a+i.left,top:i.top}}),!c&&(0,l.jsx)("div",{className:s.right,style:{left:a+i.left,top:n+i.top+6},children:r})]})}},91160:function(e,t,r){r.d(t,{L:function(){return n}});let n=40},62500:function(e,t,r){r.d(t,{w:function(){return c}});var n=r(16315),i=r(28810),a=r(27378),o=r(43137),l=r(40907),s=r(24246);let c=(0,a.memo)(function(e){let{debug:t}=e,r=(0,a.useRef)(null),c=(0,o.gH)(),{bounds:{chartWidth:d,chartHeight:f,margins:m},getSegment:b,colors:g}=c,{onClick:y,onHover:h,onHoverOut:j}=(0,l.A)({focusingSegment:!0}),x=(0,a.useMemo)(()=>u(c),[c]),v=(0,a.useMemo)(()=>n.Z.from(x,e=>e.x,e=>e.y),[x]),O=(0,a.useMemo)(()=>v.voronoi([0,0,p(d),p(f)]),[d,f,v]),w=(0,a.useCallback)(e=>{if(!r.current)return;let[t,n]=(0,i.Z)(e,r.current);return x[v.find(t,n)]},[x,v]),k=(0,a.useCallback)(e=>{let t=w(e);t&&h(t.observation,{segment:t.segment})},[w,h]),P=(0,a.useCallback)(e=>{let t=w(e);t&&y(t.observation,{segment:t.segment})},[w,y]);return(0,s.jsxs)("g",{ref:r,transform:`translate(${m.left} ${m.top})`,children:[t&&x.map((e,t)=>{let{observation:r}=e;return(0,s.jsx)("path",{d:O.renderCell(t),stroke:"white",strokeOpacity:1,fill:g(b(r)),fillOpacity:.2},t)}),(0,s.jsx)("rect",{width:d,height:f,fillOpacity:0,onMouseOver:k,onMouseMove:k,onMouseOut:j,onClick:P})]})}),u=e=>{let{chartData:t,xScale:r,getX:n,yScale:i,getY:a,getSegment:o}=e;switch(e.chartType){case"area":{let{series:t}=e;return t.flatMap(e=>{let a=e.key;return e.map(e=>{let o=e.data;return{x:r(n(o)??NaN),y:i(1===t.length?e[0]:(e[0]+e[1])*.5),observation:o,segment:a}}).filter(e=>!Number.isNaN(e.x)&&!Number.isNaN(e.y))})}case"line":case"scatterplot":return t.map(e=>{let t=o(e);return{observation:e,x:r(n(e)??NaN),y:i(a(e)??NaN),segment:t}}).filter(e=>!Number.isNaN(e.x)&&!Number.isNaN(e.y));default:return e}},p=e=>e<0?0:e},4148:function(e,t,r){r.d(t,{j:function(){return M}});var n=r(17043),i=r(60116),a=r(87026),o=r(12548),l=r(56125),s=r(64986),c=r(40624),u=r(43605),p=r.n(u),d=r(27378),f=r(70644),m=r(43137),b=r(99990),g=r(10359),y=r(15658),h=r(64103),j=r(17510),x=r(41494),v=r(48947),O=r(27102),w=r(8788),k=r(7378),P=r(7673),N=r(77142),S=r(71171),Z=r(24246);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let E=(0,d.createContext)(void 0),T=()=>{let e=(0,d.useContext)(E);if(!e)throw Error("useTimeline must be called inside a TimelineContext.Provider!");return(0,f.useSyncExternalStore)(e.subscribe,e.getUpdateKey),e},M=e=>{let{componentId:t,showPlayButton:r,type:n,duration:i,filters:a,dimensions:o}=e,[l]=(0,O.lY)(y.Sc),s=(0,d.useMemo)(()=>o.find(e=>e.id===t),[t,o]),c=(0,h.fF)(s),u=(0,h.eP)(s),f=(0,h.a6)(s);if(!(c||u||f))throw Error("You can only use TimeSlider with temporal dimensions!");let b=(0,x.z6)(),v="timeUnit"in s?s.timeUnit:void 0,w=(0,m.gH)(),N=a[s.id],S=(0,d.useMemo)(()=>{let e={animationType:n,msDuration:1e3*i},t=Array.from(new Set(w.allData.map(e=>e[s.id]).filter(j.y)));if(c)return C({type:"interval",msValues:t.map(e=>(0,g.sG)(e).getTime()),formatValue:e=>b(new Date(e),v)},e);{let r={sortingType:"byAuto",sortingOrder:"asc"},n=(0,P.tf)(s,{dimensionFilter:N,sorting:r}),i=(0,P.jS)(n,r);return C({type:"ordinal",sortedData:p()(t,n,i)},e)}},[n,i,w.allData,c,s,b,v,N]),D=(0,d.useMemo)(()=>new k.T(S),[S]);return l.dashboardFilters?.timeRange.active?null:(0,Z.jsx)(E.Provider,{value:D,children:(0,Z.jsx)($,{showPlayButton:r})})},$=e=>{let{showPlayButton:t}=e,[r,n]=T().formattedExtent;return(0,Z.jsxs)(i.Z,C(C({},S.nT),{},{sx:{display:"flex",alignItems:"center",gap:5,mb:5,mr:2.5},children:[t&&(0,Z.jsx)(L,{}),(0,Z.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,Z.jsx)(H,{}),(0,Z.jsx)(a.Z,{variant:"caption",sx:{position:"absolute",left:0,mt:2},children:r}),(0,Z.jsx)(a.Z,{variant:"caption",sx:{position:"absolute",right:0,mt:2},children:n})]})]}))},L=()=>{let e=T(),t=(0,N.z)(()=>{e.playing?e.stop():e.start()});return(0,Z.jsx)(o.Z,{onClick:t,variant:"outlined",style:{minHeight:32,minWidth:32,padding:0,borderRadius:"50%"},children:(0,Z.jsx)(v.JO,{name:e.playing?"pause":"play",size:16})})},A=(0,s.Z)(()=>({root:{width:"100%",[`& .${l.Z.root}`]:{height:"6px",[`& .${l.Z.thumb}`]:{width:"16px",height:"16px"}}},playing:{[`& .${l.Z.thumb}`]:{transition:"none"},[`& .${l.Z.track}`]:{transition:"none"}}})),H=()=>{let e=T(),t=(0,w.bI)(e=>e.timeSlider),r=(0,w.bI)(e=>e.setTimeSlider),n=A(),i=(0,d.useMemo)(()=>e.domain.map(e=>({value:e}))??[],[e.domain]),a=(0,N.z)(t=>{e.setProgress(+t.target.value)}),o=(0,N.z)(()=>{e.stop()});return(0,d.useEffect)(()=>{e.type!==t.type&&r({type:e.type,value:void 0}),"interval"===e.type&&"interval"===t.type&&t.value?.getTime()!==e.value&&r({type:"interval",value:new Date(e.value)}),"ordinal"===e.type&&"ordinal"===t.type&&t?.value!==e.value&&r({type:"ordinal",value:e.value})},[e.value,e.type,t.type,t.value,r]),(0,Z.jsx)(b.iR,{name:"time-slider",renderTextInput:!1,min:0,max:1,step:null,marks:i,value:e.progress,onChange:a,onClick:o,valueLabelDisplay:"on",valueLabelFormat:e.formattedValue,className:(0,c.Z)(n.root,e.playing&&n.playing)})}}}]);
//# sourceMappingURL=47062.d106f5c721640d1d.js.map