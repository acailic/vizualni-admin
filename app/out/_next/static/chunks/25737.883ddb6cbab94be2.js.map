{"version":3,"file":"static/chunks/25737.883ddb6cbab94be2.js","mappings":"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","sources":["webpack://_N_E/./charts/shared/a11y-table.tsx","webpack://_N_E/./charts/chart-data-wrapper.tsx","webpack://_N_E/./charts/shared/axis-height-linear.tsx","webpack://_N_E/./charts/shared/axis-height-title.tsx","webpack://_N_E/./charts/shared/brush/constants.ts","webpack://_N_E/./charts/shared/chart-dimensions.tsx","webpack://_N_E/./charts/shared/interaction/tooltip-box.tsx","webpack://_N_E/./charts/shared/rendering-utils.ts","webpack://_N_E/./charts/shared/ticks.tsx","webpack://_N_E/./charts/shared/use-chart-theme.ts","webpack://_N_E/./charts/shared/use-interaction.tsx","webpack://_N_E/./utils/get-text-size.ts","webpack://_N_E/./utils/get-text-width.ts","webpack://_N_E/./utils/use-is-mobile.ts"],"sourcesContent":["import { Box } from \"@mui/material\";\nimport { memo, useMemo } from \"react\";\n\nimport { VisuallyHidden } from \"@/components/visually-hidden\";\nimport { Dimension, Measure, Observation } from \"@/domain/data\";\n\nexport const A11yTable = memo(\n  ({\n    title,\n    dimensions,\n    measures,\n    observations,\n  }: {\n    title: string;\n    dimensions: Dimension[];\n    measures: Measure[];\n    observations: Observation[];\n  }) => {\n    const headers = useMemo(() => {\n      const obsKeys = new Set(Object.keys(observations[0]));\n      return [...dimensions, ...measures].filter((d) => obsKeys.has(d.id));\n    }, [dimensions, measures, observations]);\n\n    return (\n      <VisuallyHidden>\n        <table>\n          <caption>{title}</caption>\n          <tbody>\n            <tr>\n              {headers.map(({ id, label }) => {\n                return (\n                  <th key={id} role=\"columnheader\" scope=\"col\">\n                    <Box>{label}</Box>\n                  </th>\n                );\n              })}\n            </tr>\n            {observations.map((obs, i) => {\n              return (\n                <tr key={i}>\n                  {headers.map(({ id }) => (\n                    <td key={id}>{obs[id]}</td>\n                  ))}\n                </tr>\n              );\n            })}\n          </tbody>\n        </table>\n      </VisuallyHidden>\n    );\n  }\n);\n","import { makeStyles } from \"@mui/styles\";\nimport { AnimatePresence } from \"framer-motion\";\nimport keyBy from \"lodash/keyBy\";\nimport {\n  ComponentProps,\n  createElement,\n  ElementType,\n  useEffect,\n  useMemo,\n} from \"react\";\n\nimport { A11yTable } from \"@/charts/shared/a11y-table\";\nimport { useLoadingState } from \"@/charts/shared/chart-loading-state\";\nimport { ChartProps } from \"@/charts/shared/chart-props\";\nimport { EmbedQueryParams } from \"@/components/embed-params\";\nimport { Flex } from \"@/components/flex\";\nimport {\n  Loading,\n  LoadingDataError,\n  LoadingOverlay,\n  NoDataHint,\n} from \"@/components/hint\";\nimport { ChartConfig, DataSource } from \"@/configurator\";\nimport {\n  useDataCubesComponentsQuery,\n  useDataCubesMetadataQuery,\n  useDataCubesObservationsQuery,\n} from \"@/graphql/hooks\";\nimport { DataCubeObservationFilter } from \"@/graphql/query-hooks\";\nimport { useLocale } from \"@/locales/use-locale\";\n\ntype ElementProps<RE> = RE extends ElementType<infer P> ? P : never;\n\nconst useStyles = makeStyles(() => ({\n  dataWrapper: {\n    position: \"relative\",\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n  },\n}));\n\n/**\n * Responsible for fetching the data for the chart.\n * - Provides observations, dimensions and measures to the chart Component\n * - Handles loading & error state\n */\nconst ChartDataWrapperInner = <\n  TChartConfig extends ChartConfig,\n  TOtherProps,\n  TChartComponent extends ElementType,\n>({\n  chartConfig,\n  LoadingOverlayComponent = LoadingOverlay,\n  Component,\n  ComponentProps,\n  componentIds,\n  dataSource,\n  embedParams,\n  observationQueryFilters,\n  fetching: fetchingProp = false,\n  error: propError,\n}: {\n  chartConfig: TChartConfig;\n  LoadingOverlayComponent?: ElementType;\n  Component: TChartComponent;\n  ComponentProps?: Omit<\n    ElementProps<TChartComponent>,\n    keyof ChartProps<TChartConfig>\n  >;\n  componentIds?: string[];\n  dataSource: DataSource;\n  embedParams?: EmbedQueryParams;\n  observationQueryFilters: DataCubeObservationFilter[];\n  fetching?: boolean;\n  /* Use this if extra data is loaded and the possible error must be shown by ChartDataWrapper*/\n  error?: Error;\n}) => {\n  const chartLoadingState = useLoadingState();\n  const classes = useStyles();\n\n  const locale = useLocale();\n  const commonQueryVariables = {\n    sourceType: dataSource.type,\n    sourceUrl: dataSource.url,\n    locale,\n  };\n  const [metadataQuery] = useDataCubesMetadataQuery({\n    variables: {\n      ...commonQueryVariables,\n      cubeFilters: chartConfig.cubes.map((cube) => ({ iri: cube.iri })),\n    },\n    keepPreviousData: true,\n  });\n  const [componentsQuery] = useDataCubesComponentsQuery({\n    chartConfig,\n    variables: {\n      ...commonQueryVariables,\n      cubeFilters: chartConfig.cubes.map((cube) => ({\n        iri: cube.iri,\n        componentIds,\n        joinBy: cube.joinBy,\n        loadValues: true,\n      })),\n    },\n    keepPreviousData: true,\n  });\n  const [observationsQuery] = useDataCubesObservationsQuery({\n    chartConfig,\n    variables: {\n      ...commonQueryVariables,\n      cubeFilters: observationQueryFilters,\n    },\n    keepPreviousData: true,\n  });\n\n  const {\n    data: metadataData,\n    fetching: fetchingMetadata,\n    error: metadataError,\n  } = metadataQuery;\n  const {\n    data: componentsData,\n    fetching: fetchingComponents,\n    error: componentsError,\n  } = componentsQuery;\n  const {\n    data: observationsData,\n    fetching: fetchingObservations,\n    error: observationsError,\n  } = observationsQuery;\n\n  const metadata = metadataData?.dataCubesMetadata;\n  const observations = observationsData?.dataCubesObservations?.data;\n  const dimensions = componentsData?.dataCubesComponents.dimensions;\n  const measures = componentsData?.dataCubesComponents.measures;\n\n  const fetching =\n    fetchingProp ||\n    fetchingMetadata ||\n    fetchingComponents ||\n    fetchingObservations;\n  const error =\n    propError || metadataError || componentsError || observationsError;\n\n  useEffect(() => {\n    chartLoadingState.set(\"data\", fetching);\n  }, [chartLoadingState, fetching]);\n\n  const { dimensionsById, measuresById } = useMemo(() => {\n    return {\n      dimensionsById: keyBy(dimensions ?? [], (d) => d.id),\n      measuresById: keyBy(measures ?? [], (d) => d.id),\n    };\n  }, [dimensions, measures]);\n\n  if (error) {\n    return (\n      <Flex sx={{ flexDirection: \"column\", gap: 3 }}>\n        {metadataError && <Error message={metadataError.message} />}\n        {componentsError && <Error message={componentsError.message} />}\n        {observationsError && <Error message={observationsError.message} />}\n        {propError && <Error message={propError.message} />}\n      </Flex>\n    );\n  } else if (\n    fetching &&\n    (!metadata || !dimensions || !measures || !observations)\n  ) {\n    return <Loading />;\n  } else if (metadata && dimensions && measures && observations) {\n    // FIXME: adapt to design\n    const title = metadata.map((d) => d.title).join(\", \");\n\n    return (\n      <div\n        className={classes.dataWrapper}\n        data-chart-loaded={!chartLoadingState.loading}\n      >\n        {observations.length > 0 && (\n          <A11yTable\n            title={title}\n            observations={observations}\n            dimensions={dimensions}\n            measures={measures}\n          />\n        )}\n\n        {createElement(Component, {\n          observations,\n          dimensions,\n          dimensionsById,\n          measures,\n          measuresById,\n          chartConfig,\n          embedParams,\n          ...ComponentProps,\n        } as ChartProps<TChartConfig> & TOtherProps)}\n\n        <AnimatePresence>\n          {chartLoadingState.loading ? (\n            <LoadingOverlayComponent />\n          ) : observations.length === 0 ? (\n            <NoDataHint />\n          ) : null}\n        </AnimatePresence>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\n\n/**\n * Makes sure the ChartDataWrapper is re-rendered when the cube iris and/or joinBy change.\n * This ensures that data hooks do not keep stale data.\n */\nexport const ChartDataWrapper = (\n  props: ComponentProps<typeof ChartDataWrapperInner>\n) => {\n  const key = useMemo(\n    () =>\n      props.chartConfig.cubes\n        .map((c) => `${c.iri}${c.joinBy ? `:${c.joinBy}` : \"\"}`)\n        .join(\" / \"),\n    [props.chartConfig.cubes]\n  );\n  return <ChartDataWrapperInner key={key} {...props} />;\n};\n\nconst Error = ({ message }: { message: string }) => {\n  return (\n    <Flex flexGrow={1} justifyContent=\"center\" minHeight={300}>\n      <LoadingDataError message={message} />\n    </Flex>\n  );\n};\n","import { axisLeft, axisRight } from \"d3-axis\";\nimport { NumberValue, ScaleLinear } from \"d3-scale\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\n\nimport type { AreasState } from \"@/charts/area/areas-state\";\nimport type { GroupedColumnsState } from \"@/charts/column/columns-grouped-state\";\nimport type { StackedColumnsState } from \"@/charts/column/columns-stacked-state\";\nimport type { ColumnsState } from \"@/charts/column/columns-state\";\nimport { ComboLineSingleState } from \"@/charts/combo/combo-line-single-state\";\nimport type { LinesState } from \"@/charts/line/lines-state\";\nimport type { ScatterplotState } from \"@/charts/scatterplot/scatterplot-state\";\nimport { AxisHeightTitle } from \"@/charts/shared/axis-height-title\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  maybeTransition,\n  renderContainer,\n} from \"@/charts/shared/rendering-utils\";\nimport { getTickNumber } from \"@/charts/shared/ticks\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { useFormatNumber } from \"@/formatters\";\nimport { useChartInteractiveFilters } from \"@/stores/interactive-filters\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport type AxisHeightLinearChartState =\n  | AreasState\n  | ColumnsState\n  | GroupedColumnsState\n  | StackedColumnsState\n  | LinesState\n  | ScatterplotState\n  | ComboLineSingleState;\n\nexport const TICK_PADDING = 6;\n\nexport const AxisHeightLinear = () => {\n  const { gridColor, labelColor } = useChartTheme();\n  const [ref, setRef] = useState<SVGGElement | null>(null);\n  const { yScale, bounds } = useChartState() as AxisHeightLinearChartState;\n\n  useRenderAxisHeightLinear(ref, {\n    id: \"axis-height-linear\",\n    orientation: \"left\",\n    scale: yScale,\n    width: bounds.chartWidth,\n    height: bounds.chartHeight,\n    margins: bounds.margins,\n    lineColor: gridColor,\n    textColor: labelColor,\n  });\n\n  return (\n    <>\n      <AxisHeightTitle />\n      <g ref={(newRef) => setRef(newRef)} />\n    </>\n  );\n};\n\nexport const useRenderAxisHeightLinear = (\n  container: SVGGElement | null,\n  {\n    id,\n    orientation,\n    scale,\n    width,\n    height,\n    margins,\n    lineColor,\n    textColor,\n  }: {\n    id: string;\n    orientation: \"left\" | \"right\";\n    scale: ScaleLinear<number, number>;\n    width: number;\n    height: number;\n    margins: { left: number; top: number };\n    lineColor: string;\n    textColor: string;\n  }\n) => {\n  const leftAligned = orientation === \"left\";\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const { labelFontSize, fontFamily } = useChartTheme();\n  const formatNumber = useFormatNumber({ decimals: \"auto\" });\n  const calculationType = useChartInteractiveFilters((d) => d.calculation.type);\n  const normalized = calculationType === \"percent\";\n  const ticks = getTickNumber(height);\n  const tickFormat = useCallback(\n    (d: NumberValue) => {\n      return normalized ? `${formatNumber(d)}%` : formatNumber(d);\n    },\n    [formatNumber, normalized]\n  );\n\n  useEffect(() => {\n    if (!container) {\n      return;\n    }\n\n    const axis = (leftAligned ? axisLeft : axisRight)(scale)\n      .ticks(ticks)\n      .tickSizeInner((leftAligned ? -1 : 1) * width)\n      .tickFormat(tickFormat)\n      .tickPadding(TICK_PADDING);\n    const g = renderContainer(container, {\n      id,\n      transform: `translate(${margins.left}, ${margins.top})`,\n      transition: { enable: enableTransition, duration: transitionDuration },\n      render: (g) => g.call(axis),\n      renderUpdate: (g, opts) =>\n        maybeTransition(g, {\n          transition: opts.transition,\n          s: (g) => g.call(axis),\n        }),\n    });\n\n    g.select(\".domain\").remove();\n    g.selectAll(\".tick line\").attr(\"stroke\", lineColor).attr(\"stroke-width\", 1);\n    g.selectAll(\".tick text\")\n      .attr(\"dy\", 3)\n      .attr(\"fill\", textColor)\n      .attr(\"font-family\", fontFamily)\n      .style(\"font-size\", labelFontSize)\n      .attr(\"text-anchor\", leftAligned ? \"end\" : \"start\");\n  }, [\n    container,\n    enableTransition,\n    fontFamily,\n    id,\n    labelFontSize,\n    leftAligned,\n    lineColor,\n    margins.left,\n    margins.top,\n    scale,\n    textColor,\n    tickFormat,\n    ticks,\n    transitionDuration,\n    width,\n  ]);\n};\n\nexport const AxisHeightLinearDomain = () => {\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const { xScale, yScale, bounds } = useChartState() as\n    | ColumnsState\n    | LinesState\n    | AreasState;\n  const { margins } = bounds;\n  const { domainColor } = useChartTheme();\n\n  useEffect(() => {\n    if (ref.current) {\n      const axis = axisLeft(yScale).tickSizeOuter(0);\n      const g = renderContainer(ref.current, {\n        id: \"axis-height-linear-domain\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g) => g.call(axis),\n        renderUpdate: (g, opts) =>\n          maybeTransition(g, {\n            transition: opts.transition,\n            s: (g) => g.call(axis),\n          }),\n      });\n\n      g.select(\".domain\")\n        .attr(\"data-name\", \"height-axis-domain\")\n        .attr(\"transform\", `translate(${xScale(0 as $FixMe)}, 0)`)\n        .attr(\"stroke\", domainColor);\n      g.selectAll(\".tick line\").remove();\n      g.selectAll(\".tick text\").remove();\n    }\n  }, [\n    domainColor,\n    enableTransition,\n    margins.left,\n    margins.top,\n    transitionDuration,\n    xScale,\n    yScale,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { PieState } from \"@/charts/pie/pie-state\";\nimport { AxisHeightLinearChartState } from \"@/charts/shared/axis-height-linear\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { OpenMetadataPanelWrapper } from \"@/components/metadata-panel\";\n\n// Axis title can be used in both \"linear\" and pie charts.\ntype AxisHeightTitleChartState = AxisHeightLinearChartState | PieState;\n\nexport const AxisHeightTitle = () => {\n  const { axisLabelFontSize } = useChartTheme();\n  const { chartType, yAxisLabel, leftAxisLabelSize, leftAxisLabelOffsetTop } =\n    useChartState() as AxisHeightTitleChartState;\n  // Axis title can also be used in combo line single charts.\n  const { yMeasure } = useChartState() as Exclude<\n    AxisHeightTitleChartState,\n    { chartType: \"comboLineSingle\" }\n  >;\n\n  return (\n    <>\n      {chartType === \"comboLineSingle\" ? (\n        <text\n          y={axisLabelFontSize}\n          style={{ fontSize: axisLabelFontSize, fill: \"black\" }}\n        >\n          {yAxisLabel}\n        </text>\n      ) : (\n        <foreignObject\n          y={leftAxisLabelOffsetTop}\n          width={leftAxisLabelSize.width}\n          height={leftAxisLabelSize.height}\n          style={{ display: \"flex\" }}\n        >\n          <OpenMetadataPanelWrapper component={yMeasure}>\n            <span style={{ fontSize: axisLabelFontSize, lineHeight: 1.5 }}>\n              {yAxisLabel}\n            </span>\n          </OpenMetadataPanelWrapper>\n        </foreignObject>\n      )}\n    </>\n  );\n};\n","// Space used in chart states as bottom margin\nexport const BRUSH_BOTTOM_SPACE = 40;\n","import { max } from \"d3-array\";\nimport { ScaleBand, ScaleLinear } from \"d3-scale\";\nimport { useMemo } from \"react\";\n\nimport { TICK_PADDING } from \"@/charts/shared/axis-height-linear\";\nimport { BRUSH_BOTTOM_SPACE } from \"@/charts/shared/brush/constants\";\nimport { getTickNumber } from \"@/charts/shared/ticks\";\nimport { TICK_FONT_SIZE, useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { Bounds, Margins } from \"@/charts/shared/use-size\";\nimport { CHART_GRID_MIN_HEIGHT } from \"@/components/react-grid\";\nimport {\n  ChartConfig,\n  DashboardFiltersConfig,\n  hasChartConfigs,\n  isLayoutingFreeCanvas,\n  useConfiguratorState,\n} from \"@/configurator\";\nimport { TimeUnit } from \"@/graphql/resolver-types\";\nimport { getTextSize } from \"@/utils/get-text-size\";\nimport { getTextWidth } from \"@/utils/get-text-width\";\n\ntype ComputeChartPaddingProps = {\n  xLabelPresent?: boolean;\n  yScale: ScaleLinear<number, number>;\n  width: number;\n  height: number;\n  interactiveFiltersConfig: ChartConfig[\"interactiveFiltersConfig\"];\n  formatNumber: (n: number) => string;\n  bandDomain?: string[];\n  normalize?: boolean;\n  //Chart is flipped in the case of bar charts where the position of the axes is inverted\n  isFlipped?: boolean;\n};\n\nconst computeChartPadding = ({\n  xLabelPresent,\n  yScale,\n  height,\n  interactiveFiltersConfig,\n  formatNumber,\n  bandDomain,\n  normalize,\n  dashboardFilters,\n  isFlipped,\n}: ComputeChartPaddingProps & {\n  dashboardFilters: DashboardFiltersConfig | undefined;\n}) => {\n  // Fake ticks to compute maximum tick length as\n  // we need to take into account n between [0, 1] where numbers\n  // with decimals have greater text length than the extremes.\n  const fakeTicks = yScale.ticks(getTickNumber(height));\n  const minLeftTickWidth =\n    interactiveFiltersConfig.calculation.active || normalize\n      ? getTextWidth(\"100%\", { fontSize: TICK_FONT_SIZE }) + TICK_PADDING\n      : 0;\n  const left = Math.max(\n    ...fakeTicks.map(\n      (x) =>\n        getTextWidth(formatNumber(x), { fontSize: TICK_FONT_SIZE }) +\n        TICK_PADDING\n    ),\n    minLeftTickWidth\n  );\n\n  const interactiveBottomElement =\n    !dashboardFilters?.timeRange.active &&\n    interactiveFiltersConfig.timeRange.active;\n\n  let bottom = isFlipped\n    ? 15 // Eyeballed value\n    : 48;\n\n  if (bandDomain?.length) {\n    bottom +=\n      max(bandDomain, (d) => getTextWidth(d, { fontSize: TICK_FONT_SIZE })) ??\n      70;\n  }\n\n  const top = interactiveFiltersConfig.calculation.active ? 24 : 0;\n\n  return isFlipped\n    ? {\n        top,\n        bottom:\n          left +\n          (xLabelPresent ? 20 : 0) +\n          (interactiveBottomElement ? BRUSH_BOTTOM_SPACE : 0),\n        left: bottom,\n      }\n    : {\n        top,\n        left,\n        bottom:\n          bottom +\n          (xLabelPresent ? 20 : 0) +\n          (interactiveBottomElement ? BRUSH_BOTTOM_SPACE : 0),\n      };\n};\n\nexport const useChartPadding = (props: ComputeChartPaddingProps) => {\n  const {\n    xLabelPresent,\n    yScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    bandDomain,\n    normalize,\n    isFlipped,\n  } = props;\n  const [{ dashboardFilters }] = useConfiguratorState(hasChartConfigs);\n  return useMemo(() => {\n    return computeChartPadding({\n      xLabelPresent,\n      yScale,\n      width,\n      height,\n      interactiveFiltersConfig,\n      formatNumber,\n      bandDomain,\n      normalize,\n      dashboardFilters,\n      isFlipped,\n    });\n  }, [\n    xLabelPresent,\n    yScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    bandDomain,\n    normalize,\n    dashboardFilters,\n    isFlipped,\n  ]);\n};\n\nconst ASPECT_RATIO = 2 / 5;\n\ntype ChartWidth = number & { __chartWidth: true };\n\nexport const getChartWidth = ({\n  width,\n  left,\n  right,\n}: {\n  width: number;\n  left: number;\n  right: number;\n}): ChartWidth => {\n  return (width - left - right) as ChartWidth;\n};\n\nexport const useChartBounds = ({\n  width,\n  chartWidth,\n  height,\n  margins,\n}: {\n  width: number;\n  chartWidth: ChartWidth;\n  height: number;\n  margins: Margins;\n}): Bounds => {\n  const [state] = useConfiguratorState(hasChartConfigs);\n  const { top, bottom } = margins;\n  const chartHeight = isLayoutingFreeCanvas(state)\n    ? Math.max(\n        Math.max(40, CHART_GRID_MIN_HEIGHT - top - bottom),\n        height - top - bottom\n      )\n    : chartWidth * ASPECT_RATIO;\n\n  return {\n    width,\n    height: chartHeight + top + bottom,\n    aspectRatio: ASPECT_RATIO,\n    margins,\n    chartWidth,\n    chartHeight,\n  };\n};\n\nconst LINE_HEIGHT = 1.25;\n\nexport type AxisLabelSizeVariables = {\n  width: number;\n  height: number;\n  offset: number;\n};\n\nexport const useAxisLabelSizeVariables = ({\n  label,\n  width: _width,\n}: {\n  label: string;\n  width: number;\n}): AxisLabelSizeVariables => {\n  const { axisLabelFontSize: fontSize } = useChartTheme();\n  const { width, height } = getTextSize(label, {\n    width: _width,\n    fontSize,\n    fontWeight: 400,\n  });\n\n  return {\n    width,\n    height,\n    offset: height - fontSize,\n  };\n};\n\nconst AXIS_TITLE_PADDING = 20;\n\nexport const useXAxisTitleOffset = (\n  xScale?: ScaleBand<string>,\n  getXLabel?: (d: string) => string,\n  xTimeUnit?: TimeUnit,\n  fontSize?: number\n) => {\n  const { axisLabelFontSize } = useChartTheme();\n\n  return useMemo(() => {\n    return (\n      (xScale && getXLabel\n        ? getLongestXLabel({\n            xScale,\n            getXLabel,\n            xTimeUnit,\n            fontSize: fontSize ?? axisLabelFontSize,\n          })\n        : axisLabelFontSize * LINE_HEIGHT) + AXIS_TITLE_PADDING\n    );\n  }, [xScale, getXLabel, xTimeUnit, fontSize, axisLabelFontSize]);\n};\n\nconst getLongestXLabel = ({\n  xScale,\n  getXLabel,\n  xTimeUnit,\n  formatDate,\n  fontSize,\n}: {\n  xScale: ScaleBand<string>;\n  getXLabel: (d: string) => string;\n  xTimeUnit?: string;\n  formatDate?: (d: string, timeUnit: string) => string;\n  fontSize: number;\n}) => {\n  const domain = xScale.domain();\n  const formattedLabels = domain.map((d) => {\n    if (xTimeUnit && formatDate) {\n      return formatDate(d, xTimeUnit);\n    } else {\n      return getXLabel(d);\n    }\n  });\n\n  const labelWidths = formattedLabels.map((text) =>\n    getTextWidth(text, { fontSize })\n  );\n\n  const longestLabel = Math.max(...labelWidths);\n\n  return longestLabel;\n};\n","import { Box } from \"@mui/material\";\nimport throttle from \"lodash/throttle\";\nimport { ReactNode, useEffect, useMemo, useRef, useState } from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { getChartWidth } from \"@/charts/shared/chart-dimensions\";\nimport { Margins, useSize } from \"@/charts/shared/use-size\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\nimport { useResizeObserver } from \"@/utils/use-resize-observer\";\n\nconst TRIANGLE_SIZE = 8;\nconst TOOLTIP_OFFSET = 4;\nexport const MOBILE_TOOLTIP_PLACEMENT: TooltipPlacement = {\n  x: \"center\",\n  y: \"bottom\",\n};\n\ntype XPlacement = \"left\" | \"center\" | \"right\";\ntype YPlacement = \"top\" | \"middle\" | \"bottom\";\nexport type TooltipPlacement = {\n  x: XPlacement;\n  y: YPlacement;\n};\n\ntype TooltipBoxProps = {\n  x: number | undefined;\n  y: number | undefined;\n  placement: TooltipPlacement;\n  withTriangle?: boolean;\n  margins: Margins;\n  children: ReactNode;\n};\n\nconst Portal = ({ children }: { children: ReactNode }) => {\n  return ReactDOM.createPortal(children, document.body);\n};\n\nconst useScroll = () => {\n  const [state, setState] = useState([0, 0]);\n  useEffect(() => {\n    const handleScroll = throttle(() => {\n      setState([window.scrollX, window.scrollY]);\n    }, 16);\n\n    document.scrollingElement?.addEventListener(\"scroll\", handleScroll);\n    handleScroll();\n    return () => {\n      document.scrollingElement?.removeEventListener(\"scroll\", handleScroll);\n    };\n  }, []);\n\n  return state;\n};\n\nconst usePosition = (yKey?: number) => {\n  const yKeyRef = useRef<number>();\n  const [rect, rectRect] = useState<[number, number]>();\n  const [x, y] = rect ?? [0, 0];\n  const setRef = useMemo(() => {\n    return (node: HTMLDivElement) => {\n      if (yKey === yKeyRef.current || !node) {\n        return;\n      }\n\n      const { left, top } = node.getBoundingClientRect();\n      rectRect([left, top]);\n      yKeyRef.current = yKey;\n    };\n  }, [yKey]);\n  const [scrollX, scrollY] = useScroll();\n  const bbox = useMemo(() => {\n    return {\n      left: x + scrollX,\n      top: y + scrollY,\n    };\n  }, [x, y, scrollX, scrollY]);\n\n  return [bbox, setRef] as const;\n};\n\n/**\n * Responsible for folding the container size into a single value based on breakpoints.\n * After accepting the container width, it accepts functions each breakpoint to return the generic value.\n */\nconst foldContainerSize =\n  <T,>(containerWidth: number) =>\n  ({\n    xs,\n    md,\n    lg,\n  }: {\n    xs: (width: number) => T;\n    md?: (width: number) => T;\n    lg?: (width: number) => T;\n  }) => {\n    if (lg && containerWidth >= 900) {\n      return lg(containerWidth);\n    }\n\n    if (md && containerWidth >= 600) {\n      return md(containerWidth);\n    }\n\n    return xs(containerWidth);\n  };\n\nexport const getCenteredTooltipPlacement = (props: {\n  chartWidth: number;\n  xAnchor: number;\n  topAnchor: boolean;\n}): TooltipPlacement => {\n  const { chartWidth, xAnchor, topAnchor } = props;\n\n  return topAnchor\n    ? {\n        x: \"center\",\n        y: \"top\",\n      }\n    : {\n        x: foldContainerSize<XPlacement>(chartWidth)({\n          xs: (w) => (xAnchor < w * 0.5 ? \"right\" : \"left\"),\n          md: (w) => (xAnchor < w * 0.25 ? \"right\" : \"left\"),\n        }),\n        y: \"middle\",\n      };\n};\n\nexport const TooltipBox = ({\n  x,\n  y,\n  placement,\n  margins,\n  children,\n  withTriangle = true,\n}: TooltipBoxProps) => {\n  const triangle = withTriangle ? mkTriangle(placement) : null;\n  const [position, positionRef] = usePosition(y);\n  const [tooltipRef, tooltipWidth] = useResizeObserver<HTMLDivElement>();\n  const isMobile = useIsMobile();\n  const { width } = useSize();\n  const chartWidth = getChartWidth({\n    width,\n    left: margins.left,\n    right: margins.right,\n  });\n  const tooltipXBoundary = isMobile\n    ? getTooltipXBoundary(x!, tooltipWidth, chartWidth)\n    : x!;\n  const mobileTriangleXPosition = getTriangleXPos(x!, tooltipWidth, chartWidth);\n  const desktopTriangleXPosition = {\n    left: triangle?.left,\n    right: triangle?.right,\n  };\n  const triangleXPosition = isMobile\n    ? { left: mobileTriangleXPosition }\n    : desktopTriangleXPosition;\n\n  return (\n    <>\n      <div ref={positionRef} />\n      <Portal>\n        <Box\n          ref={tooltipRef}\n          data-testid=\"chart-tooltip\"\n          style={{\n            zIndex: 1301,\n            position: \"absolute\",\n            left: tooltipXBoundary! + margins.left + position.left,\n            top: mxYOffset(y!, placement) + margins.top + position.top,\n            transform: mkTranslation(placement),\n            maxWidth: \"100%\",\n            pointerEvents: \"none\",\n          }}\n        >\n          <Box\n            sx={{\n              width: \"fit-content\",\n              padding: 3,\n              whiteSpace: \"nowrap\",\n              pointerEvents: \"none\",\n              backgroundColor: \"background.paper\",\n              borderRadius: 1,\n              filter: `drop-shadow(0 2px 8px rgba(0, 0, 0, 0.25))`,\n\n              \"&::before\": {\n                content: \"''\",\n                display: withTriangle ? \"block\" : \"none\",\n                position: \"absolute\",\n                pointerEvents: \"none\",\n                zIndex: -1,\n                width: 0,\n                height: 0,\n                borderStyle: \"solid\",\n                top: triangle?.top,\n                bottom: triangle?.bottom,\n                ...triangleXPosition,\n                borderWidth: triangle?.borderWidth,\n                borderTopColor: triangle?.borderTopColor,\n                borderRightColor: triangle?.borderRightColor,\n                borderBottomColor: triangle?.borderBottomColor,\n                borderLeftColor: triangle?.borderLeftColor,\n              },\n            }}\n          >\n            {children}\n          </Box>\n        </Box>\n      </Portal>\n    </>\n  );\n};\n\nconst mxYOffset = (yAnchor: number, p: TooltipPlacement) =>\n  p.y === \"top\"\n    ? yAnchor - TRIANGLE_SIZE - TOOLTIP_OFFSET\n    : p.y === \"bottom\"\n      ? yAnchor + TRIANGLE_SIZE + TOOLTIP_OFFSET\n      : yAnchor;\n\nconst mkTranslation = (p: TooltipPlacement) =>\n  `translate3d(${mkXTranslation(p.x, p.y)}, ${mkYTranslation(p.y)}, 0)`;\n\ntype XTranslation = \"-100%\" | \"-50%\" | 0 | string;\n\ntype YTranslation = \"-100%\" | \"-50%\" | 0;\n\nconst mkXTranslation = (xP: XPlacement, yP: YPlacement): XTranslation => {\n  if (yP !== \"middle\") {\n    return xP === \"left\" ? \"-100%\" : xP === \"center\" ? \"-50%\" : 0;\n  } else {\n    return xP === \"left\"\n      ? `calc(-100% - ${TRIANGLE_SIZE + TOOLTIP_OFFSET}px)`\n      : xP === \"center\"\n        ? \"-50%\"\n        : `${TRIANGLE_SIZE + TOOLTIP_OFFSET}px`;\n  }\n};\n\nconst mkYTranslation = (yP: YPlacement): YTranslation =>\n  yP === \"top\" ? \"-100%\" : yP === \"middle\" ? \"-50%\" : 0;\n\nconst mkTriangle = (p: TooltipPlacement) => {\n  switch (true) {\n    case p.x === \"right\" && p.y === \"bottom\":\n      return {\n        left: 0,\n        right: \"unset\",\n        bottom: \"unset\",\n        top: `-${TRIANGLE_SIZE}px`,\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `transparent`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `background.paper`,\n        borderLeftColor: `background.paper`,\n      };\n    case p.x === \"center\" && p.y === \"bottom\":\n      return {\n        left: `calc(50% - ${TRIANGLE_SIZE}px)`,\n        right: \"unset\",\n        bottom: \"unset\",\n        top: `-${TRIANGLE_SIZE}px`,\n        borderWidth: `0 ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `transparent`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `background.paper`,\n        borderLeftColor: `transparent`,\n      };\n    case p.x === \"left\" && p.y === \"bottom\":\n      return {\n        left: `calc(100% - ${TRIANGLE_SIZE * 2}px)`,\n        right: \"unset\",\n        bottom: \"unset\",\n        top: `-${TRIANGLE_SIZE}px`,\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `transparent`,\n        borderRightColor: `background.paper`,\n        borderBottomColor: `background.paper`,\n        borderLeftColor: `transparent`,\n      };\n    // triangle position downwards pointing (placement \"top\")\n    case p.x === \"right\" && p.y === \"top\":\n      return {\n        left: 0,\n        right: \"unset\",\n        bottom: `-${TRIANGLE_SIZE}px`,\n        top: \"unset\",\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `background.paper`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `background.paper`,\n      };\n    case p.x === \"center\" && p.y === \"top\":\n      return {\n        left: `calc(50% - ${TRIANGLE_SIZE}px)`,\n        right: \"unset\",\n        bottom: `-${TRIANGLE_SIZE}px`,\n        top: \"unset\",\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px 0 ${TRIANGLE_SIZE}px`,\n        borderTopColor: `background.paper`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `transparent`,\n      };\n    case p.x === \"left\" && p.y === \"top\":\n      return {\n        left: `calc(100% - ${TRIANGLE_SIZE * 2}px)`,\n        right: \"unset\",\n        bottom: `-${TRIANGLE_SIZE}px`,\n        top: \"unset\",\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `background.paper`,\n        borderRightColor: `background.paper`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `transparent`,\n      };\n    // triangle pointing towards the side (left /right) (placement \"middle\")\n    case p.x === \"left\" && p.y === \"middle\":\n      return {\n        left: \"100%\",\n        right: \"unset\", // -TRIANGLE_SIZE, //`calc(100% + ${TRIANGLE_SIZE * 2}px)`,\n        bottom: \"unset\",\n        top: `calc(50% - ${TRIANGLE_SIZE}px)`,\n        borderWidth: `${TRIANGLE_SIZE}px 0 ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `transparent`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `background.paper`,\n      };\n    case p.x === \"right\" && p.y === \"middle\":\n      return {\n        left: `${-TRIANGLE_SIZE}px`, //`calc(100% + ${TRIANGLE_SIZE * 2}px)`,\n        right: \"unset\",\n        bottom: \"unset\",\n        top: `calc(50% - ${TRIANGLE_SIZE}px)`,\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px 0`,\n        borderTopColor: `transparent`,\n        borderRightColor: `background.paper`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `transparent`,\n      };\n    case p.x === \"center\" && p.y === \"middle\":\n      return {\n        left: `${-TRIANGLE_SIZE}px`, //`calc(100% + ${TRIANGLE_SIZE * 2}px)`,\n        right: \"unset\",\n        bottom: \"unset\",\n        top: `calc(50% - ${TRIANGLE_SIZE}px)`,\n        borderWidth: 0,\n        borderTopColor: `transparent`,\n        borderRightColor: `transparent`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `transparent`,\n      };\n\n    default:\n      return {\n        left: `calc(100% - ${TRIANGLE_SIZE * 2}px)`,\n        right: \"unset\",\n        bottom: `-${TRIANGLE_SIZE}px`,\n        top: \"unset\",\n        borderWidth: `${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px ${TRIANGLE_SIZE}px`,\n        borderTopColor: `background.paper`,\n        borderRightColor: `background.paper`,\n        borderBottomColor: `transparent`,\n        borderLeftColor: `transparent`,\n      };\n  }\n};\n\nconst getTooltipXBoundary = (\n  x: number,\n  tooltipWidth: number,\n  chartWidth: number\n) => {\n  return Math.max(\n    tooltipWidth / 2 - TRIANGLE_SIZE,\n    Math.min(chartWidth - tooltipWidth / 2 + TRIANGLE_SIZE, x)\n  );\n};\n\nconst getTriangleXPos = (\n  x: number,\n  tooltipWidth: number,\n  chartWidth: number\n): number => {\n  if (chartWidth < tooltipWidth) {\n    const xMax = chartWidth + TRIANGLE_SIZE;\n\n    return Math.min(\n      Math.max(\n        x,\n        Math.min(\n          tooltipWidth / 2 - TRIANGLE_SIZE,\n          Math.min(chartWidth - tooltipWidth / 2 + TRIANGLE_SIZE, x)\n        )\n      ),\n      xMax\n    );\n  }\n\n  const hasReachedMax = chartWidth - tooltipWidth / 2 + TRIANGLE_SIZE < x;\n\n  if (hasReachedMax) {\n    const overflow = x - (chartWidth - tooltipWidth / 2 + TRIANGLE_SIZE);\n    const maxOverflow = tooltipWidth / 2 - TRIANGLE_SIZE;\n\n    const proportion = Math.min(overflow / maxOverflow, 1);\n\n    return (\n      tooltipWidth / 2 + proportion * (tooltipWidth / 2) - TRIANGLE_SIZE * 2\n    );\n  } else {\n    return Math.min(\n      tooltipWidth / 2 - TRIANGLE_SIZE,\n      Math.min(chartWidth - tooltipWidth / 2 + TRIANGLE_SIZE, x)\n    );\n  }\n};\n","import { select, Selection } from \"d3-selection\";\nimport { Transition } from \"d3-transition\";\nimport { useCallback, useMemo } from \"react\";\n\nimport { AnimationField, Filters } from \"@/configurator\";\nimport {\n  Component,\n  isStandardErrorDimension,\n  Observation,\n} from \"@/domain/data\";\nimport { TransitionStore } from \"@/stores/transition\";\n\n/** Use to create a unique key for rendering the shapes.\n * It's important to animate them correctly when using d3.\n */\nexport const useRenderingKeyVariable = (\n  dimensions: Component[],\n  filters: Filters,\n  animationField: AnimationField | undefined\n) => {\n  const filterableDimensionKeys = useMemo(() => {\n    // Remove single filters from the rendering key, as we want to be able\n    // to animate them.\n    const keysToRemove = Object.entries(filters)\n      .filter((d) => d[1].type === \"single\")\n      .map((d) => d[0]);\n\n    if (animationField) {\n      keysToRemove.push(animationField.componentId);\n    }\n\n    return dimensions\n      .filter((d) => !isStandardErrorDimension(d))\n      .map((d) => d.id)\n      .filter((d) => !keysToRemove.includes(d));\n  }, [dimensions, filters, animationField]);\n\n  /** Optionally provide an option to pass a segment to the key.\n   * This is useful for stacked charts, where we can't easily\n   * access the segment value from the data.\n   */\n  const getRenderingKey = useCallback(\n    (d: Observation, segment = \"\") => {\n      return filterableDimensionKeys\n        .map((key) => d[key])\n        .concat(segment)\n        .join(\"\");\n    },\n    [filterableDimensionKeys]\n  );\n\n  return getRenderingKey;\n};\n\nexport type RenderOptions = {\n  transition: Pick<TransitionStore, \"enable\" | \"duration\">;\n};\n\nexport type RenderContainerOptions = {\n  id: string;\n  transform: string;\n  transition: RenderOptions[\"transition\"];\n  render: (\n    g: Selection<SVGGElement, null, SVGGElement, unknown>,\n    parentRenderOptions: RenderOptions\n  ) => void;\n  renderUpdate?: (\n    g: Selection<SVGGElement, null, SVGGElement, unknown>,\n    parentRenderOptions: RenderOptions\n  ) => void;\n};\n\nexport function renderContainer(\n  g: SVGGElement,\n  options: RenderContainerOptions\n) {\n  const { id, transform, render, renderUpdate, transition } = options;\n\n  return select(g)\n    .selectAll<SVGGElement, null>(`#${id}`)\n    .data([null])\n    .join(\n      (enter) => {\n        const g = enter.append(\"g\").attr(\"id\", id).attr(\"transform\", transform);\n        render(g, options);\n        return g;\n      },\n      (update) => {\n        const g = maybeTransition(update, {\n          // We need to use a unique name for the transition, otherwise there could\n          // be conflicts with other transitions.\n          name: `${id}-transform`,\n          transition,\n          s: (g) => g.attr(\"transform\", transform),\n          t: (g) => g.attr(\"transform\", transform),\n        });\n        (renderUpdate ?? render)(g, options);\n        return g;\n      },\n      (exit) => {\n        return exit.remove();\n      }\n    );\n}\n\ntype MaybeTransitionOptions<S extends AnySelection, T extends AnyTransition> = {\n  name?: string;\n  transition: Pick<TransitionStore, \"enable\" | \"duration\">;\n  /** Render selection. */\n  s: (g: S) => S;\n  /** Render transition. If empty, defaults to `s`. */\n  t?: (g: T) => T;\n};\n\n/** Use to conditionally call a transition if required. */\nexport function maybeTransition<\n  S extends AnySelection,\n  T extends AnyTransition,\n>(g: S, options: MaybeTransitionOptions<S, T>) {\n  const { name, transition, s, t } = options;\n\n  return transition.enable\n    ? // If transition render is not defined, we use the selection render.\n      // (as selection methods can be called with a transition, we cast the type here\n      // to avoid a type error).\n      (t ?? s)(\n        g.transition(name).duration(transition.duration) as any\n      ).selection()\n    : s(g);\n}\n\ntype AnySelection = Selection<any, any, any, any>;\ntype AnyTransition = Transition<any, any, any, any>;\n\nconst ERROR_WHISKER_SIZE = 1;\nconst ERROR_WHISKER_MIDDLE_CIRCLE_RADIUS = 3.5;\n\nexport type RenderVerticalWhiskerDatum = {\n  key: string;\n  x: number;\n  y: number;\n  y1: number;\n  y2: number;\n  width: number;\n  fill?: string;\n  renderMiddleCircle?: boolean;\n};\n\nexport type RenderHorizontalWhiskerDatum = {\n  key: string;\n  y: number;\n  x1: number;\n  x2: number;\n  height: number;\n  fill?: string;\n  renderMiddleCircle?: boolean;\n};\n\nexport const renderVerticalWhiskers = (\n  g: Selection<SVGGElement, null, SVGGElement, unknown>,\n  data: RenderVerticalWhiskerDatum[],\n  options: RenderOptions\n) => {\n  const { transition } = options;\n\n  g.selectAll<SVGGElement, RenderVerticalWhiskerDatum>(\"g\")\n    .data(data, (d) => d.key)\n    .join(\n      (enter) =>\n        enter\n          .append(\"g\")\n          .attr(\"opacity\", 0)\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"top\")\n              .attr(\"x\", (d) => d.x)\n              .attr(\"y\", (d) => d.y2)\n              .attr(\"width\", (d) => d.width)\n              .attr(\"height\", ERROR_WHISKER_SIZE)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"middle\")\n              .attr(\"x\", (d) => d.x + (d.width - ERROR_WHISKER_SIZE) / 2)\n              .attr(\"y\", (d) => d.y2)\n              .attr(\"width\", ERROR_WHISKER_SIZE)\n              .attr(\"height\", (d) => Math.max(0, d.y1 - d.y2))\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"bottom\")\n              .attr(\"x\", (d) => d.x)\n              .attr(\"y\", (d) => d.y1)\n              .attr(\"width\", (d) => d.width)\n              .attr(\"height\", ERROR_WHISKER_SIZE)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((g) =>\n            g\n              .filter((d) => d.renderMiddleCircle ?? false)\n              .append(\"circle\")\n              .attr(\"class\", \"middle-circle\")\n              .attr(\"cx\", (d) => d.x + d.width / 2)\n              .attr(\"cy\", (d) => d.y)\n              .attr(\"r\", ERROR_WHISKER_MIDDLE_CIRCLE_RADIUS)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((enter) =>\n            maybeTransition(enter, {\n              s: (g) => g.attr(\"opacity\", 1),\n              transition,\n            })\n          ),\n      (update) =>\n        maybeTransition(update, {\n          s: (g) =>\n            g\n              .attr(\"opacity\", 1)\n              .call((g) =>\n                g\n                  .select(\".top\")\n                  .attr(\"x\", (d) => d.x)\n                  .attr(\"y\", (d) => d.y2)\n                  .attr(\"width\", (d) => d.width)\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              )\n              .call((g) =>\n                g\n                  .select(\".middle\")\n                  .attr(\"x\", (d) => d.x + (d.width - ERROR_WHISKER_SIZE) / 2)\n                  .attr(\"y\", (d) => d.y2)\n                  .attr(\"height\", (d) => Math.max(0, d.y1 - d.y2))\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              )\n              .call((g) =>\n                g\n                  .select(\".bottom\")\n                  .attr(\"x\", (d) => d.x)\n                  .attr(\"y\", (d) => d.y1)\n                  .attr(\"width\", (d) => d.width)\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              )\n              .call((g) =>\n                g\n                  .select(\".middle-circle\")\n                  .attr(\"cx\", (d) => d.x + d.width / 2)\n                  .attr(\"cy\", (d) => d.y)\n                  .attr(\"r\", ERROR_WHISKER_MIDDLE_CIRCLE_RADIUS)\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n                  .attr(\"stroke\", \"none\")\n              ),\n          transition,\n        }),\n      (exit) =>\n        maybeTransition(exit, {\n          transition,\n          s: (g) => g.attr(\"opacity\", 0).remove(),\n        })\n    );\n};\n\nexport const renderHorizontalWhisker = (\n  g: Selection<SVGGElement, null, SVGGElement, unknown>,\n  data: RenderHorizontalWhiskerDatum[],\n  options: RenderOptions\n) => {\n  const { transition } = options;\n\n  g.selectAll<SVGGElement, RenderHorizontalWhiskerDatum>(\"g\")\n    .data(data, (d) => d.key)\n    .join(\n      (enter) =>\n        enter\n          .append(\"g\")\n          .attr(\"opacity\", 0)\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"right\")\n              .attr(\"y\", (d) => d.y)\n              .attr(\"x\", (d) => d.x2)\n              .attr(\"width\", ERROR_WHISKER_SIZE)\n              .attr(\"height\", (d) => d.height)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"middle\")\n              .attr(\"y\", (d) => d.y + (d.height - ERROR_WHISKER_SIZE) / 2)\n              .attr(\"x\", (d) => d.x1)\n              .attr(\"width\", (d) => Math.abs(Math.min(0, d.x1 - d.x2)))\n              .attr(\"height\", ERROR_WHISKER_SIZE)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"class\", \"left\")\n              .attr(\"y\", (d) => d.y)\n              .attr(\"x\", (d) => d.x1)\n              .attr(\"width\", ERROR_WHISKER_SIZE)\n              .attr(\"height\", (d) => d.height)\n              .attr(\"fill\", (d) => d.fill ?? \"black\")\n              .attr(\"stroke\", \"none\")\n          )\n          .call((enter) =>\n            maybeTransition(enter, {\n              s: (g) => g.attr(\"opacity\", 1),\n              transition,\n            })\n          ),\n      (update) =>\n        maybeTransition(update, {\n          s: (g) =>\n            g\n              .attr(\"opacity\", 1)\n              .call((g) =>\n                g\n                  .select(\".right\")\n                  .attr(\"y\", (d) => d.y)\n                  .attr(\"x\", (d) => d.x2)\n                  .attr(\"height\", (d) => d.height)\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              )\n              .call((g) =>\n                g\n                  .select(\".middle\")\n                  .attr(\"y\", (d) => d.y + (d.height - ERROR_WHISKER_SIZE) / 2)\n                  .attr(\"x\", (d) => d.x1)\n                  .attr(\"width\", (d) => Math.abs(Math.min(0, d.x1 - d.x2)))\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              )\n              .call((g) =>\n                g\n                  .select(\".left\")\n                  .attr(\"y\", (d) => d.y)\n                  .attr(\"x\", (d) => d.x1)\n                  .attr(\"height\", (d) => d.height)\n                  .attr(\"fill\", (d) => d.fill ?? \"black\")\n              ),\n          transition,\n        }),\n      (exit) =>\n        maybeTransition(exit, {\n          transition,\n          s: (g) => g.attr(\"opacity\", 0).remove(),\n        })\n    );\n};\n\nexport const toggleFocusBorder = <T extends { focused?: boolean }>(\n  s: Selection<SVGGElement, T, SVGGElement, unknown>\n) => {\n  s.attr(\"stroke\", (d) => (d.focused ? ANNOTATION_FOCUS_COLOR : \"none\")).attr(\n    \"stroke-width\",\n    (d) => (d.focused ? ANNOTATION_FOCUS_WIDTH : 0)\n  );\n};\n\nexport const ANNOTATION_FOCUS_COLOR = \"#A332DE\";\nexport const ANNOTATION_FOCUS_WIDTH = 4;\n","const TICK_MIN_HEIGHT = 50;\n\nexport const getTickNumber = (height: number) => {\n  return Math.min(height / TICK_MIN_HEIGHT, 4);\n};\n","import { useMediaQuery } from \"@mui/material\";\n\nimport { useTheme } from \"../../themes\";\n\nexport const TICK_FONT_SIZE = 12;\nconst AXIS_LABEL_FONT_SIZE_XXS = 12;\nconst AXIS_LABEL_FONT_SIZE_XL = 14;\n\nexport const useChartTheme = () => {\n  const theme = useTheme();\n  const labelColor = theme.palette.text.primary;\n  const domainColor = theme.palette.monochrome[800];\n  const gridColor = theme.palette.cobalt[100];\n  const fontFamily = theme.typography.fontFamily as string;\n  const brushOverlayColor = theme.palette.monochrome[300];\n  const brushSelectionColor = theme.palette.monochrome[500];\n  const brushHandleStrokeColor = theme.palette.monochrome[500];\n  const brushHandleFillColor = theme.palette.background.paper;\n\n  const smallerTexts = useMediaQuery(theme.breakpoints.down(\"xl\"));\n  const axisLabelFontSize = smallerTexts\n    ? AXIS_LABEL_FONT_SIZE_XXS\n    : AXIS_LABEL_FONT_SIZE_XL;\n\n  return {\n    axisLabelFontSize,\n    labelColor,\n    labelFontSize: TICK_FONT_SIZE,\n    domainColor,\n    gridColor,\n    fontFamily,\n    brushOverlayColor,\n    brushSelectionColor,\n    brushHandleStrokeColor,\n    brushHandleFillColor,\n  };\n};\n","import {\n  createContext,\n  Dispatch,\n  ReactNode,\n  Reducer,\n  useContext,\n  useReducer,\n} from \"react\";\n\nimport { Observation } from \"@/domain/data\";\n\ntype BaseInteraction = {\n  visible: boolean;\n  observation: Observation | undefined;\n};\n\ntype TooltipInteraction = BaseInteraction & {\n  type: \"tooltip\";\n  mouse?: {\n    x: number;\n    y: number;\n  };\n};\n\ntype AnnotationInteraction = BaseInteraction & {\n  type: \"annotation\";\n  focusingSegment?: boolean;\n  segment?: string;\n};\n\ntype InteractionState = TooltipInteraction | AnnotationInteraction;\n\ntype InteractionStateAction =\n  | {\n      type: \"INTERACTION_UPDATE\";\n      value: InteractionState;\n    }\n  | {\n      type: \"INTERACTION_HIDE\";\n    };\n\nconst INTERACTION_INITIAL_STATE: InteractionState = {\n  type: \"tooltip\",\n  observation: undefined,\n  visible: false,\n  mouse: undefined,\n};\n\nconst InteractionStateReducer = (\n  state: InteractionState,\n  action: InteractionStateAction\n) => {\n  switch (action.type) {\n    case \"INTERACTION_UPDATE\":\n      return action.value satisfies InteractionState;\n    case \"INTERACTION_HIDE\":\n      return {\n        type: state.type,\n        observation: undefined,\n        visible: false,\n        mouse: undefined,\n      } satisfies InteractionState;\n    default:\n      const _exhaustiveCheck: never = action;\n      return _exhaustiveCheck;\n  }\n};\n\nconst InteractionStateContext = createContext<\n  [InteractionState, Dispatch<InteractionStateAction>] | undefined\n>(undefined);\n\nexport const useInteraction = () => {\n  const ctx = useContext(InteractionStateContext);\n\n  if (ctx === undefined) {\n    throw Error(\n      \"You need to wrap your component in <InteractionProvider /> to useInteraction()\"\n    );\n  }\n\n  return ctx;\n};\n\nexport const InteractionProvider = ({ children }: { children: ReactNode }) => {\n  const [state, dispatch] = useReducer<\n    Reducer<InteractionState, InteractionStateAction>\n  >(InteractionStateReducer, INTERACTION_INITIAL_STATE);\n\n  return (\n    <InteractionStateContext.Provider value={[state, dispatch]}>\n      {children}\n    </InteractionStateContext.Provider>\n  );\n};\n","import { select } from \"d3-selection\";\n\nexport type GetTextSizeOptions = {\n  width: number;\n  fontSize: number;\n  fontWeight: number;\n  lineHeight?: number;\n  paddingLeft?: number;\n  paddingTop?: number;\n  paddingRight?: number;\n  paddingBottom?: number;\n};\n\nexport const getTextSize = (\n  text: string | number,\n  options: GetTextSizeOptions\n): DOMRect => {\n  const {\n    width,\n    fontSize,\n    fontWeight,\n    lineHeight = 1.5,\n    paddingLeft = 0,\n    paddingTop = 0,\n    paddingRight = 0,\n    paddingBottom = 0,\n  } = options ?? {};\n  const root = select(\"body\")\n    .append(\"div\")\n    .attr(\"aria-hidden\", \"true\")\n    .style(\"z-index\", -1)\n    .style(\"position\", \"absolute\")\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"opacity\", 0)\n    .style(\"pointer-events\", \"none\")\n    .style(\"box-sizing\", \"border-box\")\n    .style(\"max-width\", `${width}px`);\n  const node = root\n    .append(\"div\")\n    .style(\"width\", \"fit-content\")\n    .style(\"height\", \"fit-content\")\n    .style(\"padding-left\", `${paddingLeft}px`)\n    .style(\"padding-top\", `${paddingTop}px`)\n    .style(\"padding-right\", `${paddingRight}px`)\n    .style(\"padding-bottom\", `${paddingBottom}px`)\n    .style(\"line-height\", lineHeight)\n    .style(\"font-size\", `${fontSize}px`)\n    .style(\"font-weight\", fontWeight)\n    .style(\"word-break\", \"break-word\")\n    .text(text)\n    .node() as HTMLDivElement;\n  const rect = node.getBoundingClientRect();\n  root.remove();\n\n  return {\n    ...rect,\n    width: rect.width + 1,\n    height: rect.height + 1,\n  };\n};\n","import { theme } from \"@/themes/theme\";\n\nlet canvas: HTMLCanvasElement;\nlet ctx: CanvasRenderingContext2D;\nconst fontFamily = theme.typography.fontFamily as string;\n\nexport const getTextWidth = (text: string, options: { fontSize: number }) => {\n  if (canvas === undefined && ctx === undefined) {\n    canvas = document.createElement(\"canvas\");\n    ctx = canvas.getContext(\"2d\") as CanvasRenderingContext2D;\n  }\n\n  ctx.font = `${options.fontSize}px ${fontFamily}`;\n\n  return ctx.measureText(text).width;\n};\n","import { useMediaQuery, useTheme } from \"@mui/material\";\n\nexport const useIsMobile = () => {\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down(\"sm\"));\n  return isMobile;\n};\n"],"names":["A11yTable","memo","_ref","title","dimensions","measures","observations","headers","useMemo","obsKeys","Set","Object","keys","filter","d","has","id","_jsx","VisuallyHidden","children","_jsxs","map","_ref2","label","role","scope","Box","obs","i","_ref3","useStyles","makeStyles","dataWrapper","position","width","height","display","flexDirection","ChartDataWrapperInner","chartConfig","LoadingOverlayComponent","LoadingOverlay","Component","ComponentProps","componentIds","dataSource","embedParams","observationQueryFilters","fetching","fetchingProp","error","propError","chartLoadingState","useLoadingState","classes","locale","useLocale","commonQueryVariables","sourceType","type","sourceUrl","url","metadataQuery","useDataCubesMetadataQuery","variables","_objectSpread","cubeFilters","cubes","cube","iri","keepPreviousData","componentsQuery","useDataCubesComponentsQuery","joinBy","loadValues","observationsQuery","useDataCubesObservationsQuery","data","metadataData","fetchingMetadata","metadataError","componentsData","fetchingComponents","componentsError","observationsData","fetchingObservations","observationsError","metadata","dataCubesMetadata","dataCubesObservations","dataCubesComponents","useEffect","set","dimensionsById","measuresById","keyBy","Flex","sx","gap","Error","message","Loading","join","className","loading","length","createElement","AnimatePresence","NoDataHint","ChartDataWrapper","props","key","c","flexGrow","justifyContent","minHeight","LoadingDataError","TICK_PADDING","AxisHeightLinear","gridColor","labelColor","useChartTheme","ref","setRef","useState","yScale","bounds","useChartState","useRenderAxisHeightLinear","orientation","scale","chartWidth","chartHeight","margins","lineColor","textColor","_Fragment","AxisHeightTitle","newRef","container","leftAligned","enableTransition","useTransitionStore","state","enable","transitionDuration","duration","labelFontSize","fontFamily","formatNumber","useFormatNumber","decimals","normalized","calculationType","useChartInteractiveFilters","calculation","ticks","getTickNumber","tickFormat","useCallback","axis","axisLeft","axisRight","tickSizeInner","tickPadding","g","renderContainer","transform","left","top","transition","render","call","renderUpdate","opts","maybeTransition","s","select","remove","selectAll","attr","style","AxisHeightLinearDomain","useRef","xScale","domainColor","current","tickSizeOuter","axisLabelFontSize","chartType","yAxisLabel","leftAxisLabelSize","leftAxisLabelOffsetTop","yMeasure","y","fontSize","fill","OpenMetadataPanelWrapper","component","lineHeight","computeChartPadding","xLabelPresent","interactiveFiltersConfig","bandDomain","normalize","dashboardFilters","isFlipped","fakeTicks","minLeftTickWidth","active","getTextWidth","TICK_FONT_SIZE","Math","max","x","interactiveBottomElement","timeRange","bottom","useChartPadding","useConfiguratorState","hasChartConfigs","getChartWidth","right","useChartBounds","isLayoutingFreeCanvas","CHART_GRID_MIN_HEIGHT","aspectRatio","useAxisLabelSizeVariables","_ref4","_width","getTextSize","fontWeight","offset","useXAxisTitleOffset","getXLabel","xTimeUnit","getLongestXLabel","LINE_HEIGHT","_ref5","formatDate","formattedLabels","domain","text","MOBILE_TOOLTIP_PLACEMENT","Portal","ReactDOM","document","body","useScroll","setState","handleScroll","throttle","window","scrollX","scrollY","scrollingElement","addEventListener","removeEventListener","usePosition","yKey","yKeyRef","rect","rectRect","node","getBoundingClientRect","foldContainerSize","containerWidth","xs","md","lg","getCenteredTooltipPlacement","xAnchor","topAnchor","w","TooltipBox","placement","withTriangle","triangle","mkTriangle","positionRef","tooltipRef","tooltipWidth","useResizeObserver","isMobile","useIsMobile","useSize","tooltipXBoundary","getTooltipXBoundary","mobileTriangleXPosition","getTriangleXPos","desktopTriangleXPosition","zIndex","mxYOffset","mkTranslation","maxWidth","pointerEvents","padding","whiteSpace","backgroundColor","borderRadius","content","borderStyle","borderWidth","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","yAnchor","p","mkXTranslation","mkYTranslation","xP","yP","min","proportion","overflow","TRIANGLE_SIZE","useRenderingKeyVariable","filters","animationField","filterableDimensionKeys","keysToRemove","entries","push","componentId","isStandardErrorDimension","includes","segment","arguments","undefined","concat","options","enter","append","update","name","t","exit","selection","renderVerticalWhiskers","y2","ERROR_WHISKER_SIZE","y1","renderMiddleCircle","renderHorizontalWhisker","x2","x1","abs","toggleFocusBorder","focused","ANNOTATION_FOCUS_COLOR","ANNOTATION_FOCUS_WIDTH","theme","useTheme","palette","primary","monochrome","cobalt","typography","brushOverlayColor","brushSelectionColor","brushHandleStrokeColor","brushHandleFillColor","background","paper","smallerTexts","useMediaQuery","breakpoints","down","INTERACTION_INITIAL_STATE","observation","visible","mouse","InteractionStateReducer","action","value","InteractionStateContext","createContext","useInteraction","ctx","useContext","InteractionProvider","dispatch","useReducer","Provider","paddingLeft","paddingTop","paddingRight","paddingBottom","root","canvas","getContext","font","measureText"],"sourceRoot":""}