{"version":3,"file":"static/chunks/pages/_pivot-8986b8982301a6ce.js","mappings":"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","sources":["webpack://_N_E/../node_modules/@mui/styles/styled/styled.js","webpack://_N_E/./pages/_pivot.tsx","webpack://_N_E/?960e"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose\";\nconst _excluded = [\"name\"],\n  _excluded2 = [\"children\", \"className\", \"clone\", \"component\"];\nimport * as React from 'react';\nimport clsx from 'clsx';\nimport PropTypes from 'prop-types';\nimport { chainPropTypes, getDisplayName } from '@mui/utils';\nimport hoistNonReactStatics from 'hoist-non-react-statics';\nimport makeStyles from '../makeStyles';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nfunction omit(input, fields) {\n  const output = {};\n  Object.keys(input).forEach(prop => {\n    if (fields.indexOf(prop) === -1) {\n      output[prop] = input[prop];\n    }\n  });\n  return output;\n}\n\n// styled-components's API removes the mapping between components and styles.\n// Using components as a low-level styling construct can be simpler.\nexport default function styled(Component) {\n  const componentCreator = (style, options = {}) => {\n    const {\n        name\n      } = options,\n      stylesOptions = _objectWithoutPropertiesLoose(options, _excluded);\n    if (process.env.NODE_ENV !== 'production' && Component === undefined) {\n      throw new Error(['You are calling styled(Component)(style) with an undefined component.', 'You may have forgotten to import it.'].join('\\n'));\n    }\n    let classNamePrefix = name;\n    if (process.env.NODE_ENV !== 'production') {\n      if (!name) {\n        // Provide a better DX outside production.\n        const displayName = getDisplayName(Component);\n        if (displayName !== undefined) {\n          classNamePrefix = displayName;\n        }\n      }\n    }\n    const stylesOrCreator = typeof style === 'function' ? theme => ({\n      root: props => style(_extends({\n        theme\n      }, props))\n    }) : {\n      root: style\n    };\n    const useStyles = makeStyles(stylesOrCreator, _extends({\n      Component,\n      name: name || Component.displayName,\n      classNamePrefix\n    }, stylesOptions));\n    let filterProps;\n    let propTypes = {};\n    if (style.filterProps) {\n      filterProps = style.filterProps;\n      delete style.filterProps;\n    }\n\n    /* eslint-disable react/forbid-foreign-prop-types */\n    if (style.propTypes) {\n      propTypes = style.propTypes;\n      delete style.propTypes;\n    }\n    /* eslint-enable react/forbid-foreign-prop-types */\n\n    const StyledComponent = /*#__PURE__*/React.forwardRef(function StyledComponent(props, ref) {\n      const {\n          children,\n          className: classNameProp,\n          clone,\n          component: ComponentProp\n        } = props,\n        other = _objectWithoutPropertiesLoose(props, _excluded2);\n      const classes = useStyles(props);\n      const className = clsx(classes.root, classNameProp);\n      let spread = other;\n      if (filterProps) {\n        spread = omit(spread, filterProps);\n      }\n      if (clone) {\n        return /*#__PURE__*/React.cloneElement(children, _extends({\n          className: clsx(children.props.className, className)\n        }, spread));\n      }\n      if (typeof children === 'function') {\n        return children(_extends({\n          className\n        }, spread));\n      }\n      const FinalComponent = ComponentProp || Component;\n      return /*#__PURE__*/_jsx(FinalComponent, _extends({\n        ref: ref,\n        className: className\n      }, spread, {\n        children: children\n      }));\n    });\n    process.env.NODE_ENV !== \"production\" ? StyledComponent.propTypes = _extends({\n      /**\n       * A render function or node.\n       */\n      children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\n      /**\n       * @ignore\n       */\n      className: PropTypes.string,\n      /**\n       * If `true`, the component will recycle it's children HTML element.\n       * It's using `React.cloneElement` internally.\n       *\n       * This prop will be deprecated and removed in v5\n       */\n      clone: chainPropTypes(PropTypes.bool, props => {\n        if (props.clone && props.component) {\n          return new Error('You can not use the clone and component prop at the same time.');\n        }\n        return null;\n      }),\n      /**\n       * The component used for the root node.\n       * Either a string to use a HTML element or a component.\n       */\n      component: PropTypes /* @typescript-to-proptypes-ignore */.elementType\n    }, propTypes) : void 0;\n    if (process.env.NODE_ENV !== 'production') {\n      StyledComponent.displayName = `Styled(${classNamePrefix})`;\n    }\n    hoistNonReactStatics(StyledComponent, Component);\n    return StyledComponent;\n  };\n  return componentCreator;\n}","import {\n  Box,\n  Card as MUICard,\n  CircularProgress,\n  FormControlLabel,\n  lighten,\n  Switch,\n  Theme,\n  Typography,\n} from \"@mui/material\";\nimport { makeStyles, styled } from \"@mui/styles\";\nimport clsx from \"clsx\";\nimport groupBy from \"lodash/groupBy\";\nimport mapValues from \"lodash/mapValues\";\nimport { ChangeEvent, useEffect, useMemo, useState } from \"react\";\nimport { Inspector } from \"react-inspector\";\nimport { Column, useExpanded, useSortBy, useTable } from \"react-table\";\n\nimport { Loading } from \"@/components/hint\";\nimport { ChartConfig } from \"@/config-types\";\nimport { Dimension, HierarchyValue, Measure } from \"@/domain/data\";\nimport {\n  useDataCubesComponentsQuery,\n  useDataCubesObservationsQuery,\n} from \"@/graphql/hooks\";\nimport { ComponentId } from \"@/graphql/make-component-id\";\nimport { visitHierarchy } from \"@/rdf/tree-utils\";\nimport { useEvent } from \"@/utils/use-event\";\n\nconst Card = styled(MUICard)({\n  border: \"1px solid #ccc\",\n  backgroundColor: \"#eee\",\n  padding: \"1rem\",\n  marginTop: 16,\n  marginBottom: 16,\n});\n\nconst intDatasource = {\n  sourceUrl: \"https://lindas-cached.int.cluster.ldbar.ch/query\",\n  sourceType: \"sparql\",\n};\n\ntype Dataset = {\n  label: string;\n  iri: string;\n  datasource: typeof intDatasource;\n};\n\nconst datasets: Record<string, Dataset> = mapValues(\n  {\n    \"https://environment.ld.admin.ch/foen/fab_Offentliche_Ausgaben_test3/8\": {\n      label: \"ausgaben\",\n      datasource: intDatasource,\n    },\n    \"https://environment.ld.admin.ch/foen/ubd000502_sad_01/7\": {\n      label: \"Gas\",\n      datasource: intDatasource,\n    },\n  },\n  (v, k) => ({ ...v, iri: k })\n);\n\ntype Observation = Record<string, any>;\ntype PivottedObservation = Record<string, any>;\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  pivotTableRoot: {\n    display: \"grid\",\n    gridTemplateColumns: \"280px 1fr\",\n    gridTemplateAreas: `\n\"options chart\"\n    `,\n    gridGap: \"1rem\",\n  },\n  pivotTableOptions: {\n    paddingTop: \"1rem\",\n    gridArea: \"options\",\n  },\n  pivotTableChart: {\n    gridArea: \"chart\",\n    overflowX: \"hidden\",\n  },\n  pivotTableContainer: {\n    overflowX: \"scroll\",\n  },\n  pivotTableTable: {\n    width: \"100%\",\n    fontSize: \"12px\",\n    borderCollapse: \"collapse\",\n    \"& td, & th\": {\n      border: \"1px solid #ccc\",\n      whiteSpace: \"nowrap\",\n      padding: \"4px\",\n    },\n  },\n  optionGroup: {\n    \"& + &\": {\n      marginTop: \"0.75rem\",\n    },\n  },\n  row: {\n    transition: \"background-color 0.3s ease\",\n  },\n  expanded: {},\n  depth_0: {\n    \"&$expanded\": {\n      background: lighten(theme.palette.primary.light, 0.75),\n    },\n  },\n  depth_1: {\n    \"&$expanded\": {\n      background: lighten(theme.palette.primary.light, 0.5),\n    },\n  },\n  depth_2: {\n    \"&$expanded\": {\n      background: lighten(theme.palette.primary.light, 0.15),\n    },\n  },\n}));\n\nconst indexHierarchy = (hierarchy: HierarchyValue[]) => {\n  const byLabel = new Map<string, HierarchyValue>();\n  const parentsByIri = new Map<string, HierarchyValue>();\n  const childrenByIri = new Map<string, HierarchyValue[]>();\n  const byIri = new Map<string, HierarchyValue>();\n  visitHierarchy(hierarchy, (x_) => {\n    const x = x_ as HierarchyValue;\n    byLabel.set(x.label, x);\n    byIri.set(x.value, x);\n\n    const children = x.children as HierarchyValue[];\n    if (children) {\n      childrenByIri.set(x.value, children);\n      for (let child of children) {\n        parentsByIri.set(child.value, x);\n      }\n    }\n  });\n  return { byLabel, parentsByIri, childrenByIri, byIri };\n};\n\nconst useBarStyles = makeStyles<Theme>((theme) => ({\n  root: {\n    backgroundColor: theme.palette.primary.main,\n  },\n}));\n\nconst Bar = ({ percent }: { percent: number }) => {\n  const classes = useBarStyles();\n  return (\n    <div\n      className={classes.root}\n      style={{ height: 4, width: (100 * percent) / 100 }}\n    ></div>\n  );\n};\n\nconst PivotTable = ({ dataset }: { dataset: (typeof datasets)[string] }) => {\n  const [activeMeasures, setActiveMeasures] = useState<\n    Record<Measure[\"id\"], boolean>\n  >({});\n  const [pivotDimension, setPivotDimension] = useState<Dimension>();\n  const [hierarchyDimension, setHierarchyDimension] = useState<Dimension>();\n  const [ignoredDimensions, setIgnoredDimensions] = useState<\n    Record<Dimension[\"id\"], boolean>\n  >({});\n\n  const [{ data: componentsData, fetching: fetchingComponents }] =\n    useDataCubesComponentsQuery({\n      chartConfig: {\n        conversionUnitsByComponentId: {},\n      } as ChartConfig,\n      variables: {\n        ...intDatasource,\n        locale: \"en\",\n        cubeFilters: [{ iri: dataset.iri }],\n      },\n    });\n  const [{ data: observationsData, fetching: fetchingObservations }] =\n    useDataCubesObservationsQuery({\n      chartConfig: {\n        conversionUnitsByComponentId: {},\n      } as ChartConfig,\n      variables: {\n        ...intDatasource,\n        locale: \"en\",\n        cubeFilters: [{ iri: dataset.iri }],\n      },\n    });\n\n  const classes = useStyles();\n\n  const allDimensions = componentsData?.dataCubesComponents?.dimensions;\n  const dimensions = useMemo(() => {\n    return allDimensions?.filter((d) => !ignoredDimensions[d.id]);\n  }, [allDimensions, ignoredDimensions]);\n  const measures = componentsData?.dataCubesComponents?.measures;\n  const observations = useMemo(() => {\n    return observationsData?.dataCubesObservations?.data ?? [];\n  }, [observationsData?.dataCubesObservations?.data]);\n\n  const handleChangePivot = (ev: ChangeEvent<HTMLSelectElement>) => {\n    const name = ev.currentTarget.value;\n    setPivotDimension(dimensions?.find((d) => d.id === name));\n  };\n\n  const handleChangeHierarchy = (ev: ChangeEvent<HTMLSelectElement>) => {\n    const name = ev.currentTarget.value;\n    setHierarchyDimension(dimensions?.find((d) => d.id === name));\n  };\n\n  const handleToggleMeasure = useEvent((ev: ChangeEvent<HTMLInputElement>) => {\n    const measureId = ev.currentTarget.getAttribute(\"name\") as Measure[\"id\"];\n\n    if (!measureId) {\n      return;\n    }\n    setActiveMeasures((am) =>\n      am ? { ...am, [measureId]: !am[measureId] } : {}\n    );\n  });\n\n  const handleToggleIgnoredDimension = useEvent(\n    (ev: ChangeEvent<HTMLInputElement>) => {\n      const dimensionIri = ev.currentTarget.getAttribute(\"name\") as\n        | ComponentId\n        | undefined;\n\n      if (!dimensionIri) {\n        return;\n      }\n\n      setIgnoredDimensions((ignored) =>\n        ignored ? { ...ignored, [dimensionIri]: !ignored[dimensionIri] } : {}\n      );\n    }\n  );\n\n  const hierarchy = componentsData?.dataCubesComponents.dimensions.find(\n    (d) => d.id === hierarchyDimension?.id\n  )?.hierarchy;\n\n  const hierarchyIndexes = useMemo(() => {\n    if (hierarchy) {\n      return indexHierarchy(hierarchy);\n    }\n  }, [hierarchy]);\n\n  const { pivotted, pivotUniqueValues, tree } = useMemo(() => {\n    if (!pivotDimension || !dimensions || !measures) {\n      return {\n        pivotted: [],\n        pivotUniqueValues: [],\n      };\n    } else {\n      const restDimensions =\n        dimensions.filter((f) => f !== pivotDimension) || [];\n      const rowKey = (row: Observation) => {\n        return restDimensions.map((d) => row[d.id]).join(\"/\");\n      };\n      const pivotGroups = Object.values(\n        groupBy(observations, (x) =>\n          restDimensions?.map((d) => x[d.id]).join(\"/\")\n        )\n      );\n      const pivotUniqueValues = new Set<Observation[string]>();\n      const rowIndex = new Map<string, { subRows?: PivottedObservation[] }>();\n\n      // Create pivotted rows with pivot dimension values as columns\n      const pivotted: PivottedObservation[] = [];\n      pivotGroups.forEach((g) => {\n        // Start from values that are the same within the group\n        const row = Object.fromEntries(\n          restDimensions.map((d) => [d.id, g[0][d.id]])\n        );\n\n        // Add pivoted dimensions\n        for (let item of g) {\n          const pivotValueAttr = `${pivotDimension.id}/${\n            item[pivotDimension.id]\n          }`;\n          // @ts-ignore\n          row[pivotValueAttr] = Object.fromEntries(\n            measures.map((m) => [m.id, item[m.id]])\n          );\n          pivotUniqueValues.add(item[pivotDimension.id]);\n        }\n        rowIndex.set(rowKey(row), row);\n        pivotted.push(row);\n      });\n\n      // Regroup rows with their parent row\n      const tree: PivottedObservation[] = [];\n      pivotted.forEach((row) => {\n        if (hierarchyDimension && hierarchyIndexes) {\n          const hierarchyLabel = row[hierarchyDimension.id];\n          const hierarchyNode = hierarchyIndexes.byLabel.get(hierarchyLabel);\n          const parentNode = hierarchyIndexes.parentsByIri.get(\n            hierarchyNode?.value!\n          );\n          const parentKey = rowKey({\n            ...row,\n            [hierarchyDimension.id]: parentNode?.label,\n          });\n          const parentRow = rowIndex.get(parentKey);\n          if (parentRow) {\n            parentRow.subRows = parentRow.subRows || [];\n            parentRow.subRows.push(row);\n          } else {\n            tree.push(row);\n          }\n\n          return;\n        }\n\n        tree.push(row);\n      });\n      return {\n        pivotted,\n        tree,\n        pivotUniqueValues: Array.from(pivotUniqueValues).sort(),\n      } as const;\n    }\n  }, [\n    pivotDimension,\n    dimensions,\n    measures,\n    observations,\n    hierarchyDimension,\n    hierarchyIndexes,\n  ]);\n\n  const columns = useMemo((): Column<Observation>[] => {\n    if (!dimensions || !measures) {\n      return [];\n    } else if (pivotDimension) {\n      const dimensionColumns: Column<Observation>[] = dimensions\n        .filter((d) => d.id !== pivotDimension.id)\n        .sort((a) => {\n          if (a.id === hierarchyDimension?.id) {\n            return 1;\n          } else {\n            return 0;\n          }\n        })\n        .map((d) => ({\n          id: d.id,\n          accessor: (x: Observation) => x[d.id],\n          Header: d.label,\n        }));\n\n      const pivotColumns: Column<Observation>[] = pivotUniqueValues.map(\n        (uv) => ({\n          Header: uv,\n          columns: measures\n            .filter((m) => activeMeasures?.[m.id] !== false)\n            .map((m) => {\n              const showBars = m.label.includes(\"%\");\n              return {\n                Header: m.label,\n                Cell: ({ cell }) => {\n                  return (\n                    <>\n                      {cell.value}\n                      {showBars ? (\n                        <Bar percent={parseFloat(cell.value)} />\n                      ) : null}\n                    </>\n                  );\n                },\n                id: `${pivotDimension.id}/${uv}/${m.id}`,\n                accessor: (x) => {\n                  return x[`${pivotDimension.id}/${uv}`]?.[m.id] || \"\";\n                },\n              };\n            }),\n        })\n      );\n\n      const dimensionAndHierarchyColumns = dimensionColumns.map((d) => {\n        if (d.id === hierarchyDimension?.id) {\n          const col: Column<Observation> = {\n            ...d,\n            Cell: ({ cell, row }) => {\n              const style = {\n                // We can even use the row.depth property\n                // and paddingLeft to indicate the depth\n                // of the row\n                paddingLeft: `${row.depth * 1}rem`,\n              };\n              return (\n                // Use the row.canExpand and row.getToggleRowExpandedProps prop getter\n                // to build the toggle for expanding a row\n                <span\n                  {...(row.canExpand\n                    ? row.getToggleRowExpandedProps({\n                        style,\n                      })\n                    : {\n                        style,\n                      })}\n                >\n                  {row.canExpand ? (row.isExpanded ? \"â–¼  \" : \"â–¶  \") : null}\n                  {cell.value}\n                </span>\n              );\n            },\n          };\n          return col;\n        } else {\n          return d;\n        }\n      });\n\n      return [...dimensionAndHierarchyColumns, ...pivotColumns];\n    } else {\n      const all = [...dimensions, ...measures];\n      return all.map((d) => {\n        return {\n          accessor: (x) => x[d.id],\n          Header: d.label,\n        };\n      });\n    }\n  }, [\n    dimensions,\n    measures,\n    pivotDimension,\n    pivotUniqueValues,\n    hierarchyDimension?.id,\n    activeMeasures,\n  ]);\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    rows,\n    prepareRow,\n    expandedDepth,\n  } = useTable(\n    {\n      columns: columns,\n      data: pivotDimension && tree ? tree : observations,\n    },\n    useSortBy,\n    useExpanded\n  );\n\n  useEffect(() => {\n    if (!Object.keys(activeMeasures).length && measures) {\n      setActiveMeasures(Object.fromEntries(measures.map((m) => [m.id, true])));\n    }\n  }, [activeMeasures, measures]);\n\n  return (\n    <Box className={classes.pivotTableRoot}>\n      <div className={classes.pivotTableOptions}>\n        <div className={classes.optionGroup}>\n          <Typography variant=\"h6\" gutterBottom display=\"block\">\n            Pivot columns\n          </Typography>\n          <select\n            onChange={handleChangePivot}\n            value={pivotDimension?.id || \"-\"}\n          >\n            <option value=\"-\">-</option>\n            {dimensions?.map((d) => {\n              return (\n                <option key={d.id} value={d.id}>\n                  {d.label}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n        <div className={classes.optionGroup}>\n          <Typography variant=\"h6\" gutterBottom display=\"block\">\n            Group rows by\n          </Typography>\n          <select\n            onChange={handleChangeHierarchy}\n            value={hierarchyDimension?.id || \"-\"}\n          >\n            <option value=\"-\">-</option>\n            {dimensions?.map((d) => {\n              return (\n                <option key={d.id} value={d.id}>\n                  {d.label}\n                </option>\n              );\n            })}\n          </select>\n\n          {fetchingComponents ? (\n            <CircularProgress size={12} sx={{ ml: 2 }} />\n          ) : null}\n        </div>\n        <div className={classes.optionGroup}>\n          <Typography variant=\"h6\" gutterBottom display=\"block\">\n            Measures\n          </Typography>\n          {measures?.map((m) => {\n            return (\n              <FormControlLabel\n                key={m.id}\n                label={m.label}\n                componentsProps={{ typography: { variant: \"caption\" } }}\n                control={\n                  <Switch\n                    size=\"small\"\n                    checked={activeMeasures?.[m.id]}\n                    onChange={handleToggleMeasure}\n                    name={m.id}\n                  />\n                }\n              />\n            );\n          })}\n        </div>\n        <div className={classes.optionGroup}>\n          <Typography variant=\"h6\" display=\"block\">\n            Ignored dimensions\n          </Typography>\n          <Typography variant=\"caption\" gutterBottom display=\"block\">\n            If some dimensions contain duplicate information with another\n            dimension, it is necessary to ignore them for the grouping to work.\n            <br />\n            Ex: the Hierarchy column of the Gas dataset is a duplicate of the\n            Source of emission column, it needs to be ignored.\n          </Typography>\n          {allDimensions?.map((d) => {\n            return (\n              <FormControlLabel\n                key={d.id}\n                label={d.label}\n                componentsProps={{ typography: { variant: \"caption\" } }}\n                control={\n                  <Switch\n                    size=\"small\"\n                    checked={ignoredDimensions?.[d.id]}\n                    onChange={handleToggleIgnoredDimension}\n                    name={d.id}\n                  />\n                }\n              />\n            );\n          })}\n        </div>\n      </div>\n      <div className={classes.pivotTableChart}>\n        <Card elevation={0}>\n          <details>\n            <summary>\n              <Typography variant=\"h6\" display=\"inline\">\n                Debug\n              </Typography>\n            </summary>\n\n            <Typography variant=\"overline\" display=\"block\">\n              Columns\n            </Typography>\n            <Inspector data={columns} table={false} />\n            <Typography variant=\"overline\" display=\"block\">\n              Pivoted\n            </Typography>\n            <Inspector data={pivotted} table={false} />\n            <Typography variant=\"overline\" display=\"block\">\n              Pivoted tree\n            </Typography>\n            <Inspector data={tree} table={false} />\n            <Typography variant=\"overline\" display=\"block\">\n              Hierarchy\n            </Typography>\n            <Inspector data={hierarchy} table={false} />\n            <Typography variant=\"overline\" display=\"block\">\n              Hierarchy indexes\n            </Typography>\n            <Inspector data={hierarchyIndexes} table={false} />\n          </details>\n        </Card>\n        {fetchingComponents || fetchingObservations ? <Loading /> : null}\n        <div className={classes.pivotTableContainer}>\n          <table {...getTableProps()} className={classes.pivotTableTable}>\n            <thead>\n              {headerGroups.map((headerGroup) => (\n                // eslint-disable-next-line react/jsx-key\n                <tr {...headerGroup.getHeaderGroupProps()}>\n                  {headerGroup.headers.map((column) => (\n                    // eslint-disable-next-line react/jsx-key\n                    <th\n                      {...column.getHeaderProps(column.getSortByToggleProps())}\n                    >\n                      {column.render(\"Header\")}\n                      <span>\n                        {column.isSorted\n                          ? column.isSortedDesc\n                            ? \" ðŸ”½\"\n                            : \" ðŸ”¼\"\n                          : \"\"}\n                      </span>\n                    </th>\n                  ))}\n                </tr>\n              ))}\n            </thead>\n            <tbody {...getTableBodyProps()}>\n              {rows.map((row) => {\n                prepareRow(row);\n                return (\n                  // eslint-disable-next-line react/jsx-key\n                  <tr\n                    {...row.getRowProps()}\n                    className={clsx(\n                      classes.row,\n                      row.isExpanded ? classes.expanded : null,\n                      classes[\n                        `depth_${\n                          expandedDepth - row.depth\n                        }` as keyof typeof classes\n                      ]\n                    )}\n                  >\n                    {row.cells.map((cell) => {\n                      return (\n                        // eslint-disable-next-line react/jsx-key\n                        <td {...cell.getCellProps()}>{cell.render(\"Cell\")}</td>\n                      );\n                    })}\n                  </tr>\n                );\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </Box>\n  );\n};\n\nconst Page = () => {\n  const [dataset, setDataset] = useState(\n    datasets[Object.keys(datasets)[0] as keyof typeof datasets]!\n  );\n\n  const handleChangeDataset = (ev: ChangeEvent<HTMLSelectElement>) => {\n    const name = ev.currentTarget.value;\n    if (name in datasets) {\n      setDataset(datasets[name as keyof typeof datasets]);\n    }\n  };\n\n  return (\n    <Box m={5}>\n      <Typography variant=\"h2\">Pivot table</Typography>\n      <Typography variant=\"overline\" display=\"block\">\n        Dataset\n      </Typography>\n\n      <select onChange={handleChangeDataset} value={dataset.iri}>\n        {Object.keys(datasets).map((k) => {\n          const dataset = datasets[k as keyof typeof datasets];\n          return (\n            <option key={dataset.iri} value={dataset.iri}>\n              {dataset.label}\n            </option>\n          );\n        })}\n      </select>\n      <PivotTable key={dataset.iri} dataset={dataset} />\n    </Box>\n  );\n};\n\nexport default Page;\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/_pivot\",\n      function () {\n        return require(\"private-next-pages/_pivot.tsx\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/_pivot\"])\n      });\n    }\n  "],"names":["Component","_excluded","_excluded2","Card","styled","MUICard","style","options","filterProps","name","stylesOptions","objectWithoutPropertiesLoose","Z","useStyles","makeStyles","theme","root","props","esm_extends","displayName","classNamePrefix","propTypes","StyledComponent","react","forwardRef","ref","children","className","classNameProp","clone","component","ComponentProp","other","classes","clsx","spread","omit","input","fields","output","Object","keys","forEach","prop","indexOf","cloneElement","FinalComponent","jsx_runtime","jsx","hoist_non_react_statics_cjs_default","border","backgroundColor","padding","marginTop","marginBottom","intDatasource","sourceUrl","sourceType","datasets","mapValues","label","datasource","v","k","_objectSpread","iri","pivotTableRoot","display","gridTemplateColumns","gridTemplateAreas","gridGap","pivotTableOptions","paddingTop","gridArea","pivotTableChart","overflowX","pivotTableContainer","pivotTableTable","width","fontSize","borderCollapse","whiteSpace","optionGroup","row","transition","expanded","depth_0","background","lighten","palette","primary","light","depth_1","depth_2","indexHierarchy","hierarchy","byLabel","Map","parentsByIri","childrenByIri","byIri","visitHierarchy","x_","set","x","value","child","useBarStyles","main","Bar","_ref","percent","_jsx","height","PivotTable","_ref2","dataset","activeMeasures","setActiveMeasures","useState","pivotDimension","setPivotDimension","hierarchyDimension","setHierarchyDimension","ignoredDimensions","setIgnoredDimensions","data","componentsData","fetching","fetchingComponents","useDataCubesComponentsQuery","chartConfig","conversionUnitsByComponentId","variables","locale","cubeFilters","observationsData","fetchingObservations","useDataCubesObservationsQuery","allDimensions","dataCubesComponents","dimensions","useMemo","filter","d","id","measures","observations","dataCubesObservations","handleToggleMeasure","useEvent","ev","measureId","currentTarget","getAttribute","am","handleToggleIgnoredDimension","dimensionIri","ignored","find","hierarchyIndexes","pivotted","pivotUniqueValues","tree","restDimensions","f","rowKey","map","join","pivotGroups","values","groupBy","Set","rowIndex","g","fromEntries","item","m","add","push","hierarchyLabel","hierarchyNode","get","parentNode","parentKey","parentRow","subRows","Array","from","sort","columns","all","accessor","Header","dimensionColumns","a","pivotColumns","uv","showBars","includes","Cell","_ref3","cell","_jsxs","_Fragment","parseFloat","_ref4","paddingLeft","depth","canExpand","getToggleRowExpandedProps","isExpanded","getTableProps","getTableBodyProps","headerGroups","rows","prepareRow","expandedDepth","useTable","useSortBy","useExpanded","useEffect","length","Box","Typography","variant","gutterBottom","onChange","CircularProgress","size","sx","ml","FormControlLabel","componentsProps","typography","control","Switch","checked","elevation","Inspector","table","Loading","headerGroup","getHeaderGroupProps","headers","column","getHeaderProps","getSortByToggleProps","render","isSorted","isSortedDesc","getRowProps","cells","getCellProps","_pivot","Page","setDataset","window","__NEXT_P","__webpack_require__"],"sourceRoot":""}