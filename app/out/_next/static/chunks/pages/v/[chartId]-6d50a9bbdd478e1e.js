(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[39078],{1283:function(e,t,r){"use strict";r.d(t,{F:function(){return z}});var s=r(17043),n=r(90089),a=r(96338),i=r(19914),o=r(60116),l=r(64986),c=r(40624),d=r(27378),u=r(58555),p=r(97091),h=r(48863),x=r(62050),f=r(93477),m=r(78222),j=r(16370),y=r(97971),g=r(47612),b=r(52137),v=r(32597),C=r(78081),k=r(10369),w=r(65619),S=r(53082),O=r(17899),P=r(5680),_=r(78839),Z=r(25390),I=r(71238),B=r(62075),D=r(56436),E=r(87182),F=r(80207),M=r(94460),K=r(49148),T=r(8788),A=r(82395),N=r(24246);let R=["dataSource","state","chartConfig","configKey","children","embedParams","shouldShrink"];function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let W=(0,d.forwardRef)((e,t)=>{let{dataSource:r,state:s,chartConfig:a,configKey:i,children:o,embedParams:l,shouldShrink:c}=e,u=(0,n.Z)(e,R),p=(0,d.useMemo)(()=>(0,P.ag)(),[]);return(0,N.jsx)(P.ax.Provider,{value:p,children:(0,N.jsx)(C.Ig,{children:(0,N.jsx)(b.hC,U(U({layout:s.layout,ref:t,chartKey:a.key},u),{},{children:(0,N.jsx)(G,{dataSource:r,state:s,chartConfig:a,configKey:i,metadataPanelStore:p,embedParams:l,shouldShrink:c,children:o},a.key)}),a.key)},a.key)})}),z=e=>{let{configKey:t,embedParams:r,shouldShrink:s,isPreview:n}=e,[a]=(0,I.lY)(I.s9),{dataSource:l}=a,c=(0,K.bU)(),u=(0,d.useMemo)(()=>(0,P.ag)(),[]),p=L({shrink:!0}),h=(0,d.useCallback)(e=>(0,N.jsx)(W,{dataSource:l,state:a,chartConfig:e,configKey:t,embedParams:r},e.key),[t,l,r,a]),x=(0,d.useCallback)(e=>{switch(e.type){case"chart":return h(a.chartConfigs.find(t=>t.key===e.key));case"text":return(0,_.aW)(e);default:return e}},[a.chartConfigs,h]),m=(0,d.useCallback)(e=>{let{height:t}=e;window.parent.postMessage({type:f.m2,height:t},"*")},[]),[j]=(0,A.y)(m);return(0,N.jsx)(P.ax.Provider,{value:u,children:(0,N.jsx)(T.ch,{chartConfigs:a.chartConfigs,children:(0,N.jsx)(o.Z,{ref:j,children:"dashboard"===a.layout.type?(0,N.jsxs)(o.Z,{className:p.dashboardBoxWrapper,children:[a.layout.meta.title[c]||a.layout.meta.description[c]?(0,N.jsxs)(S.k,{flexDirection:"column",children:[a.layout.meta.title[c]&&(0,N.jsx)(B.Dx,{text:a.layout.meta.title[c]}),a.layout.meta.description[c]&&(0,N.jsx)(B.dk,{text:a.layout.meta.description[c]})]}):null,(0,N.jsx)(b.WK,{layoutType:a.layout.layout,renderBlock:x}),1!==a.chartConfigs.length&&t&&(0,N.jsx)(g.cS,{configKey:t,createdWith:i.ag._({id:"metadata.link.created.with"})})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(S.k,{sx:{flexDirection:"column",mb:a.layout.meta.title[c]||a.layout.meta.description[c]?4:0},children:[a.layout.meta.title[c]&&(0,N.jsx)(B.Dx,{text:a.layout.meta.title[c]}),a.layout.meta.description[c]&&(0,N.jsx)(B.dk,{text:a.layout.meta.description[c]})]}),(0,N.jsxs)(C.Ig,{children:[(0,N.jsx)(w.u,{}),(0,N.jsx)(b.hC,{layout:a.layout,chartKey:a.activeChartKey,children:(0,N.jsx)(G,{dataSource:l,state:a,chartConfig:(0,Z.f6)(a),configKey:t,metadataPanelStore:u,embedParams:r,shouldShrink:s,isPreview:n})})]})]})})})})},L=(0,l.Z)(e=>({root:{position:"relative",paddingLeft:t=>{let{shrink:r}=t;return`calc(${e.spacing(5)} + ${r?D.pG:0}px)`},padding:t=>{let{optimizeSpace:r}=t;return r?e.spacing(3):e.spacing(6)},transition:"padding 0.25s ease"},dashboardBoxWrapper:{[e.breakpoints.up("xs")]:{padding:e.spacing(5,4,2,4)},[e.breakpoints.up("md")]:{padding:e.spacing(5)},[e.breakpoints.up("lg")]:{padding:e.spacing(6)},gap:16,display:"flex",flexDirection:"column",backgroundColor:e.palette.cobalt[50]}})),$=e=>{let{dataSource:t=E.Ve,state:r,chartConfig:s,configKey:n,className:i,children:l,metadataPanelStore:f,embedParams:b,shouldShrink:w,isPreview:P}=e,{meta:_}=s,Z=(0,d.useRef)(null),{isTable:I,computeContainerHeight:A}=(0,C.IS)(),R=(0,u.oR)(f,e=>e.open),H=(0,d.useMemo)(()=>{let e=Z.current?.getBoundingClientRect().width;return!!e&&(w??(R&&e>2*D.pG))},[w,R]);(0,d.useEffect)(()=>{let e=f.subscribe(()=>{A()});return()=>e()});let W=(0,v.TZ)({removeBorder:b?.removeBorder}),z=L({shrink:H,optimizeSpace:b?.optimizeSpace}),$=(0,K.bU)(),G=(0,E.Id)(t),q={sourceType:t.type,sourceUrl:t.url,locale:$},[{data:V}]=(0,F.bi)({variables:{sourceType:t.type,sourceUrl:t.url,locale:$,cubeFilters:s.cubes.map(e=>({iri:e.iri}))}}),X=V?.dataCubesMetadata,Y=(0,p.Zl)(r.chartConfigs),[{data:J}]=(0,F.k$)({chartConfig:s,variables:U(U({},q),{},{cubeFilters:s.cubes.map(e=>({iri:e.iri,componentIds:Y,joinBy:e.joinBy}))})}),Q=J?.dataCubesComponents,ee=Q?.dimensions,et=Q?.measures,er=(0,d.useMemo)(()=>ee&&et?[...ee,...et]:[],[ee,et]);return(0,N.jsxs)(o.Z,{ref:Z,className:(0,c.Z)(W.root,W.pastEditing,z.root,i),children:[l,(0,N.jsxs)(y.x,{resetKeys:[s],children:[(0,N.jsxs)("div",{children:[X?.some(e=>e.publicationStatus===M.sl.Draft)&&(0,N.jsx)(o.Z,{sx:{mb:4},children:(0,N.jsx)(O.BI,{children:(0,N.jsx)(a.cC,{id:"dataset.publicationStatus.draft.warning",components:{0:(0,N.jsx)("br",{}),1:(0,N.jsx)("strong",{})}})})}),X?.some(e=>e.expires)&&(0,N.jsx)(o.Z,{sx:{mb:4},children:(0,N.jsx)(O.BI,{children:(0,N.jsx)(a.cC,{id:"dataset.publicationStatus.expires.warning",components:{0:(0,N.jsx)("br",{}),1:(0,N.jsx)("strong",{})}})})}),!G&&(0,N.jsx)(o.Z,{sx:{mb:4},children:(0,N.jsx)(O.m0,{children:(0,N.jsx)(a.cC,{id:"data.source.notTrusted"})})}),(0,x.v5)(s)&&(0,N.jsx)(o.Z,{sx:{mb:4},children:(0,N.jsx)(O.pd,{children:(0,N.jsx)(a.cC,{id:"dataset.hasImputedValues"})})})]}),(0,N.jsx)(h.p,{children:(0,N.jsxs)(T.Zg,{chartConfigKey:s.key,children:[(0,N.jsxs)(S.k,{sx:{height:"fit-content",justifyContent:_.title[$]?"space-between":"flex-end",gap:2},children:[_.title[$]?(0,N.jsx)(B.Dx,{text:_.title[$],smaller:!0}):(0,N.jsx)("span",{style:{height:1}}),b?.removeMoreOptionsButton?null:(0,N.jsx)(m.G,{children:(0,N.jsx)(v.iA,{configKey:n,chartKey:s.key,chartWrapperNode:Z.current,components:er,disableDatabaseRelatedActions:P})})]}),_.description[$]?(0,N.jsx)(B.dk,{text:_.description[$],smaller:!0}):(0,N.jsx)("span",{style:{height:1}}),(0,N.jsx)(v.xx,{dataSource:t,chartConfig:s,dashboardFilters:r.dashboardFilters,metadataPanelProps:b?.removeMoreOptionsButton?void 0:{components:er,container:Z.current,allowMultipleOpen:!0}}),(0,N.jsx)(C.S4,{children:I?(0,N.jsx)(j._,{dataSource:t,chartConfig:s,dashboardFilters:r.dashboardFilters,sx:{maxHeight:"100%"}}):(0,N.jsx)(k.I,{dataSource:t,componentIds:Y,chartConfig:s,dashboardFilters:r.dashboardFilters,embedParams:b})}),(0,N.jsx)(g.Tc,{configKey:n,dataSource:t,chartConfig:s,dashboardFilters:r.dashboardFilters,components:er,showVisualizeLink:"dashboard"!==r.layout.type||"dashboard"===r.layout.type&&1===r.chartConfigs.length,hideFilters:b?.removeFilters,hideMetadata:b?.removeFootnotes,metadataPanelProps:b?.removeMoreOptionsButton?{components:er,container:Z.current,allowMultipleOpen:!0}:void 0})]})})]})]})},G=e=>(0,d.createElement)($,U(U({},e),{},{key:e.chartConfig.key}))},35112:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return F}});var s=r(17043),n=r(96338),a=r(60116),i=r(3707),o=r(12548),l=r(87026),c=r(62033),d=r(64986),u=r(46142),p=r(10377),h=r.n(p),x=r(88038),f=r.n(x),m=r(79894),j=r.n(m),y=r(86677),g=r(73868),b=r(27378),v=r(1283),C=r(41053),k=r(17899),w=r(25592),S=r(34712),O=r(25390),P=r(15658),_=r(66056),Z=r(49148),I=r(57906),B=r(24246);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}let E=(0,d.Z)(e=>({actionBar:{display:"flex",justifyContent:"flex-end",alignItems:"center",width:"100%",padding:`${e.spacing(6)} ${e.spacing(12)}`,borderBottom:"1px solid",borderBottomColor:e.palette.divider,backgroundColor:e.palette.background.paper}}));var F=!0;t.default=e=>{let t=(0,Z.bU)(),{query:r,replace:d}=(0,y.useRouter)(),p=E(),x=(0,b.useRef)(null),{0:m}=(0,b.useState)(()=>!!r.publishSuccess),{status:F,config:M}=(0,_.M)(e),{embedParams:K}=(0,C.lR)(),T=(0,g.useSession)(),A="found"===F&&M.user_id&&M.user_id===T.data?.user.id,{key:N,state:R}=(0,b.useMemo)(()=>{if("found"===F){let e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({state:"PUBLISHED"},M.data);return{key:M.key,state:e}}return{key:"",state:void 0}},[M?.data,M?.key,F]),H=R?(0,O.f6)(R):void 0;(0,b.useEffect)(function(){r.publishSuccess&&d({pathname:window.location.pathname},void 0,{shallow:!0})},[r.publishSuccess,d]);let{dataSource:U,setDataSource:W}=(0,I.qo)();return((0,b.useEffect)(function(){"found"===F&&M.data.dataSource.url!==U.url&&W(M.data.dataSource)},[M?.data.dataSource,U.url,W,F]),"notfound"===F||void 0===R||void 0===H)?(0,B.jsx)(h(),{statusCode:404}):(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)(f(),{children:[(0,B.jsx)("meta",{property:"og:title",content:R.layout.meta.title[t]}),(0,B.jsx)("meta",{property:"og:description",content:R.layout.meta.description[t]}),(0,B.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]}),(0,B.jsxs)(w.Dv,{children:[M.published_state===u.PUBLISHED_STATE.PUBLISHED&&(0,B.jsx)(a.Z,{className:p.actionBar,children:(0,B.jsx)(S.Wg,{chartWrapperRef:x,configKey:N,locale:t})}),(0,B.jsx)(a.Z,{px:[2,4],mb:"auto",mx:"auto",width:"100%",overflow:"hidden",children:(0,B.jsxs)(a.Z,{sx:{maxWidth:{xs:"100%",lg:1152},margin:"auto",p:8},children:[m&&(0,B.jsx)(a.Z,{mt:2,mb:5,children:(0,B.jsx)(k.pA,{})}),M.published_state===u.PUBLISHED_STATE.DRAFT&&(0,B.jsx)(a.Z,{mt:2,mb:5,children:(0,B.jsxs)(k.m0,{sx:{flexDirection:"row",alignItems:"center",m:"auto",[`& .${i.Z.message}`]:{display:"flex",justifyContent:"space-between",alignItems:"center"}},children:[(0,B.jsx)(n.cC,{id:"hint.publication.draft"}),A?(0,B.jsx)(o.Z,{component:j(),href:`/create/new?edit=${M.key}`,variant:"outlined",color:"inherit",size:"sm",children:(0,B.jsx)(n.cC,{id:"login.chart.edit"})}):null]})}),(0,B.jsx)(a.Z,{ref:x,children:(0,B.jsx)(P.c7,{chartId:"published",initialState:R,children:(0,B.jsx)(v.F,{configKey:N,embedParams:K})})}),(0,B.jsx)(l.Z,{variant:"body2",component:"div",my:6,color:"monochrome.700",children:m?(0,B.jsx)(n.cC,{id:"hint.how.to.share"}):(0,B.jsx)(n.cC,{id:"hint.create.your.own.chart"})}),(0,B.jsxs)(c.Z,{alignItems:"flex-start",direction:{xs:"column",sm:"row"},spacing:{xs:2,sm:2},sx:{mb:5},children:[(0,B.jsx)(j(),{href:"/create/new",passHref:!0,legacyBehavior:!0,children:(0,B.jsx)(o.Z,{children:(0,B.jsx)(n.cC,{id:"button.new.visualization"})})}),(0,B.jsx)(j(),{href:{pathname:"/create/new",query:{copy:N}},passHref:!0,legacyBehavior:!0,children:(0,B.jsx)(o.Z,{children:(0,B.jsx)(n.cC,{id:"button.copy.visualization"})})})]})]})})]})]})}},67378:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return d}});let s=r(51538),n=r(24246),a=s._(r(27378)),i=s._(r(29454)),o={400:"Bad Request",404:"This page could not be found",405:"Method Not Allowed",500:"Internal Server Error"};function l(e){let{res:t,err:r}=e;return{statusCode:t&&t.statusCode?t.statusCode:r?r.statusCode:404}}let c={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},desc:{lineHeight:"48px"},h1:{display:"inline-block",margin:"0 20px 0 0",paddingRight:23,fontSize:24,fontWeight:500,verticalAlign:"top"},h2:{fontSize:14,fontWeight:400,lineHeight:"28px"},wrap:{display:"inline-block"}};class d extends a.default.Component{render(){let{statusCode:e,withDarkMode:t=!0}=this.props,r=this.props.title||o[e]||"An unexpected error has occurred";return(0,n.jsxs)("div",{style:c.error,children:[(0,n.jsx)(i.default,{children:(0,n.jsx)("title",{children:e?e+": "+r:"Application error: a client-side exception has occurred"})}),(0,n.jsxs)("div",{style:c.desc,children:[(0,n.jsx)("style",{dangerouslySetInnerHTML:{__html:"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}"+(t?"@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}":"")}}),e?(0,n.jsx)("h1",{className:"next-error-h1",style:c.h1,children:e}):null,(0,n.jsx)("div",{style:c.wrap,children:(0,n.jsxs)("h2",{style:c.h2,children:[this.props.title||e?r:(0,n.jsx)(n.Fragment,{children:"Application error: a client-side exception has occurred (see the browser console for more information)"}),"."]})})]})]})}}d.displayName="ErrorPage",d.getInitialProps=l,d.origGetInitialProps=l,("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},65631:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/v/[chartId]",function(){return r(35112)}])},10377:function(e,t,r){e.exports=r(67378)}},function(e){e.O(0,[31434,88033,68143,72159,54568,96761,2386,22686,25592,17671,65362,16,92888,49774,40179],function(){return e(e.s=65631)}),_N_E=e.O()}]);
//# sourceMappingURL=[chartId]-6d50a9bbdd478e1e.js.map