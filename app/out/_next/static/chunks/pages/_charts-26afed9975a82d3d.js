(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16327],{1283:function(e,t,r){"use strict";r.d(t,{F:function(){return H}});var n=r(17043),a=r(90089),s=r(96338),i=r(19914),o=r(60116),c=r(64986),l=r(40624),d=r(27378),u=r(58555),p=r(97091),h=r(48863),x=r(62050),f=r(93477),j=r(78222),y=r(16370),b=r(97971),m=r(47612),g=r(52137),k=r(32597),O=r(78081),v=r(10369),C=r(65619),P=r(53082),w=r(17899),S=r(5680),Z=r(78839),D=r(25390),_=r(71238),F=r(62075),B=r(56436),E=r(87182),K=r(80207),I=r(94460),M=r(49148),N=r(8788),T=r(82395),R=r(24246);let W=["dataSource","state","chartConfig","configKey","children","embedParams","shouldShrink"];function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let z=(0,d.forwardRef)((e,t)=>{let{dataSource:r,state:n,chartConfig:s,configKey:i,children:o,embedParams:c,shouldShrink:l}=e,u=(0,a.Z)(e,W),p=(0,d.useMemo)(()=>(0,S.ag)(),[]);return(0,R.jsx)(S.ax.Provider,{value:p,children:(0,R.jsx)(O.Ig,{children:(0,R.jsx)(g.hC,$($({layout:n.layout,ref:t,chartKey:s.key},u),{},{children:(0,R.jsx)(A,{dataSource:r,state:n,chartConfig:s,configKey:i,metadataPanelStore:p,embedParams:c,shouldShrink:l,children:o},s.key)}),s.key)},s.key)})}),H=e=>{let{configKey:t,embedParams:r,shouldShrink:n,isPreview:a}=e,[s]=(0,_.lY)(_.s9),{dataSource:c}=s,l=(0,M.bU)(),u=(0,d.useMemo)(()=>(0,S.ag)(),[]),p=L({shrink:!0}),h=(0,d.useCallback)(e=>(0,R.jsx)(z,{dataSource:c,state:s,chartConfig:e,configKey:t,embedParams:r},e.key),[t,c,r,s]),x=(0,d.useCallback)(e=>{switch(e.type){case"chart":return h(s.chartConfigs.find(t=>t.key===e.key));case"text":return(0,Z.aW)(e);default:return e}},[s.chartConfigs,h]),j=(0,d.useCallback)(e=>{let{height:t}=e;window.parent.postMessage({type:f.m2,height:t},"*")},[]),[y]=(0,T.y)(j);return(0,R.jsx)(S.ax.Provider,{value:u,children:(0,R.jsx)(N.ch,{chartConfigs:s.chartConfigs,children:(0,R.jsx)(o.Z,{ref:y,children:"dashboard"===s.layout.type?(0,R.jsxs)(o.Z,{className:p.dashboardBoxWrapper,children:[s.layout.meta.title[l]||s.layout.meta.description[l]?(0,R.jsxs)(P.k,{flexDirection:"column",children:[s.layout.meta.title[l]&&(0,R.jsx)(F.Dx,{text:s.layout.meta.title[l]}),s.layout.meta.description[l]&&(0,R.jsx)(F.dk,{text:s.layout.meta.description[l]})]}):null,(0,R.jsx)(g.WK,{layoutType:s.layout.layout,renderBlock:x}),1!==s.chartConfigs.length&&t&&(0,R.jsx)(m.cS,{configKey:t,createdWith:i.ag._({id:"metadata.link.created.with"})})]}):(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(P.k,{sx:{flexDirection:"column",mb:s.layout.meta.title[l]||s.layout.meta.description[l]?4:0},children:[s.layout.meta.title[l]&&(0,R.jsx)(F.Dx,{text:s.layout.meta.title[l]}),s.layout.meta.description[l]&&(0,R.jsx)(F.dk,{text:s.layout.meta.description[l]})]}),(0,R.jsxs)(O.Ig,{children:[(0,R.jsx)(C.u,{}),(0,R.jsx)(g.hC,{layout:s.layout,chartKey:s.activeChartKey,children:(0,R.jsx)(A,{dataSource:c,state:s,chartConfig:(0,D.f6)(s),configKey:t,metadataPanelStore:u,embedParams:r,shouldShrink:n,isPreview:a})})]})]})})})})},L=(0,c.Z)(e=>({root:{position:"relative",paddingLeft:t=>{let{shrink:r}=t;return`calc(${e.spacing(5)} + ${r?B.pG:0}px)`},padding:t=>{let{optimizeSpace:r}=t;return r?e.spacing(3):e.spacing(6)},transition:"padding 0.25s ease"},dashboardBoxWrapper:{[e.breakpoints.up("xs")]:{padding:e.spacing(5,4,2,4)},[e.breakpoints.up("md")]:{padding:e.spacing(5)},[e.breakpoints.up("lg")]:{padding:e.spacing(6)},gap:16,display:"flex",flexDirection:"column",backgroundColor:e.palette.cobalt[50]}})),V=e=>{let{dataSource:t=E.Ve,state:r,chartConfig:n,configKey:a,className:i,children:c,metadataPanelStore:f,embedParams:g,shouldShrink:C,isPreview:S}=e,{meta:Z}=n,D=(0,d.useRef)(null),{isTable:_,computeContainerHeight:T}=(0,O.IS)(),W=(0,u.oR)(f,e=>e.open),U=(0,d.useMemo)(()=>{let e=D.current?.getBoundingClientRect().width;return!!e&&(C??(W&&e>2*B.pG))},[C,W]);(0,d.useEffect)(()=>{let e=f.subscribe(()=>{T()});return()=>e()});let z=(0,k.TZ)({removeBorder:g?.removeBorder}),H=L({shrink:U,optimizeSpace:g?.optimizeSpace}),V=(0,M.bU)(),A=(0,E.Id)(t),G={sourceType:t.type,sourceUrl:t.url,locale:V},[{data:X}]=(0,K.bi)({variables:{sourceType:t.type,sourceUrl:t.url,locale:V,cubeFilters:n.cubes.map(e=>({iri:e.iri}))}}),Y=X?.dataCubesMetadata,q=(0,p.Zl)(r.chartConfigs),[{data:J}]=(0,K.k$)({chartConfig:n,variables:$($({},G),{},{cubeFilters:n.cubes.map(e=>({iri:e.iri,componentIds:q,joinBy:e.joinBy}))})}),Q=J?.dataCubesComponents,ee=Q?.dimensions,et=Q?.measures,er=(0,d.useMemo)(()=>ee&&et?[...ee,...et]:[],[ee,et]);return(0,R.jsxs)(o.Z,{ref:D,className:(0,l.Z)(z.root,z.pastEditing,H.root,i),children:[c,(0,R.jsxs)(b.x,{resetKeys:[n],children:[(0,R.jsxs)("div",{children:[Y?.some(e=>e.publicationStatus===I.sl.Draft)&&(0,R.jsx)(o.Z,{sx:{mb:4},children:(0,R.jsx)(w.BI,{children:(0,R.jsx)(s.cC,{id:"dataset.publicationStatus.draft.warning",components:{0:(0,R.jsx)("br",{}),1:(0,R.jsx)("strong",{})}})})}),Y?.some(e=>e.expires)&&(0,R.jsx)(o.Z,{sx:{mb:4},children:(0,R.jsx)(w.BI,{children:(0,R.jsx)(s.cC,{id:"dataset.publicationStatus.expires.warning",components:{0:(0,R.jsx)("br",{}),1:(0,R.jsx)("strong",{})}})})}),!A&&(0,R.jsx)(o.Z,{sx:{mb:4},children:(0,R.jsx)(w.m0,{children:(0,R.jsx)(s.cC,{id:"data.source.notTrusted"})})}),(0,x.v5)(n)&&(0,R.jsx)(o.Z,{sx:{mb:4},children:(0,R.jsx)(w.pd,{children:(0,R.jsx)(s.cC,{id:"dataset.hasImputedValues"})})})]}),(0,R.jsx)(h.p,{children:(0,R.jsxs)(N.Zg,{chartConfigKey:n.key,children:[(0,R.jsxs)(P.k,{sx:{height:"fit-content",justifyContent:Z.title[V]?"space-between":"flex-end",gap:2},children:[Z.title[V]?(0,R.jsx)(F.Dx,{text:Z.title[V],smaller:!0}):(0,R.jsx)("span",{style:{height:1}}),g?.removeMoreOptionsButton?null:(0,R.jsx)(j.G,{children:(0,R.jsx)(k.iA,{configKey:a,chartKey:n.key,chartWrapperNode:D.current,components:er,disableDatabaseRelatedActions:S})})]}),Z.description[V]?(0,R.jsx)(F.dk,{text:Z.description[V],smaller:!0}):(0,R.jsx)("span",{style:{height:1}}),(0,R.jsx)(k.xx,{dataSource:t,chartConfig:n,dashboardFilters:r.dashboardFilters,metadataPanelProps:g?.removeMoreOptionsButton?void 0:{components:er,container:D.current,allowMultipleOpen:!0}}),(0,R.jsx)(O.S4,{children:_?(0,R.jsx)(y._,{dataSource:t,chartConfig:n,dashboardFilters:r.dashboardFilters,sx:{maxHeight:"100%"}}):(0,R.jsx)(v.I,{dataSource:t,componentIds:q,chartConfig:n,dashboardFilters:r.dashboardFilters,embedParams:g})}),(0,R.jsx)(m.Tc,{configKey:a,dataSource:t,chartConfig:n,dashboardFilters:r.dashboardFilters,components:er,showVisualizeLink:"dashboard"!==r.layout.type||"dashboard"===r.layout.type&&1===r.chartConfigs.length,hideFilters:g?.removeFilters,hideMetadata:g?.removeFootnotes,metadataPanelProps:g?.removeMoreOptionsButton?{components:er,container:D.current,allowMultipleOpen:!0}:void 0})]})})]})]})},A=e=>(0,d.createElement)(V,$($({},e),{},{key:e.chartConfig.key}))},56554:function(e,t,r){"use strict";r.r(t),r.d(t,{HiddenUntilScrolledTo:function(){return g},__N_SSP:function(){return m}});var n=r(17043),a=r(60116),s=r(98505),i=r(79894),o=r.n(i),c=r(27378),l=r(27668),d=r(1283),u=r(53082),p=r(25592),h=r(71238),x=r(24246);function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,r=arguments.length>2?arguments[2]:void 0,n=(0,c.useRef)(null),{0:a,1:s}=(0,c.useState)(e);return(0,c.useEffect)(()=>{let e=n.current,a=new IntersectionObserver(e=>{for(let r of e)r.intersectionRatio>t?s(!0):s(!1)},j({threshold:.25},r));return e&&a.observe(e),()=>{a.disconnect()}},[t,r]),[n,a]},b=function(){let[e,t]=y(...arguments),r=(0,c.useRef)(t);return r.current=r.current||t,[e,r.current]};var m=!0;let g=e=>{let{children:t,initialVisible:r=!1,fallback:n}=e,[a,s]=b(r);return(0,x.jsx)("div",{ref:a,children:s?t:n})};t.default=e=>{let{serializedConfigs:t}=e,r=l.ZP.deserialize(t);return(0,x.jsx)(p.Dv,{children:(0,x.jsx)(a.Z,{px:4,sx:{backgroundColor:"muted.main"},mb:"auto",children:(0,x.jsx)(u.k,{sx:{pt:4,flexWrap:"wrap"},children:r.map((e,t)=>(0,x.jsx)(a.Z,{id:`chart-${e.key}`,sx:{width:["100%","50%","50%","33.33%"],p:1},children:(0,x.jsxs)(h.c7,{chartId:"published",initialState:j(j({},e.data),{},{state:"PUBLISHED"}),children:[(0,x.jsx)(g,{initialVisible:t<5,fallback:(0,x.jsx)("div",{children:"Loading..."}),children:(0,x.jsx)(d.F,{})}),(0,x.jsxs)(a.Z,{mb:2,mx:4,mr:6,textAlign:"right",typography:"caption",children:["Id: ",e.key," -"," ",(0,x.jsx)(o(),{href:`/v/${e.key}`,passHref:!0,legacyBehavior:!0,children:(0,x.jsx)(s.Z,{children:"Open"})})," "]})]})},e.key))})})})}},49801:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_charts",function(){return r(56554)}])}},function(e){e.O(0,[31434,88033,68143,72159,54568,96761,2386,22686,25592,17671,65362,92888,49774,40179],function(){return e(e.s=49801)}),_N_E=e.O()}]);
//# sourceMappingURL=_charts-26afed9975a82d3d.js.map