{"version":3,"file":"static/chunks/14502.1954b3c2e2c73352.js","mappings":"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","sources":["webpack://_N_E/./charts/column/show-values-utils.ts","webpack://_N_E/./charts/column/columns.tsx","webpack://_N_E/./charts/column/columns-grouped.tsx","webpack://_N_E/./charts/column/columns-grouped-state-props.ts","webpack://_N_E/./charts/column/columns-grouped-state.tsx","webpack://_N_E/./charts/column/columns-stacked.tsx","webpack://_N_E/./charts/column/columns-stacked-state-props.ts","webpack://_N_E/./charts/column/columns-stacked-state.tsx","webpack://_N_E/./charts/column/columns-state-props.ts","webpack://_N_E/./charts/column/columns-state.tsx","webpack://_N_E/./charts/column/overlay-columns.tsx","webpack://_N_E/./charts/column/chart-column.tsx","webpack://_N_E/./charts/column/constants.ts","webpack://_N_E/./charts/column/rendering-utils.ts","webpack://_N_E/./charts/shared/axis-width-band.tsx","webpack://_N_E/./charts/shared/limits/vertical.tsx","webpack://_N_E/./charts/shared/overlay-rects.tsx","webpack://_N_E/./configurator/interactive-filters/time-slider.tsx","webpack://_N_E/../node_modules/d3-shape/src/offset/diverging.js","webpack://_N_E/../node_modules/d3-shape/src/order/ascending.js","webpack://_N_E/../node_modules/d3-shape/src/order/descending.js","webpack://_N_E/../node_modules/d3-shape/src/order/none.js","webpack://_N_E/../node_modules/d3-shape/src/order/reverse.js","webpack://_N_E/../node_modules/d3-shape/src/offset/none.js","webpack://_N_E/../node_modules/d3-shape/src/stack.js"],"sourcesContent":["import { useMemo } from \"react\";\n\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { RenderTotalValueLabelDatum } from \"@/charts/shared/render-value-labels\";\nimport { truthy } from \"@/domain/types\";\n\nexport const useColumnValueLabelsData = () => {\n  const {\n    bounds: { width, height },\n    showValues,\n    getValueOffset,\n    renderEveryNthValue,\n    chartData,\n    getRenderingKey,\n    xScale,\n    getX,\n    yScale,\n    getY,\n    valueLabelFormatter,\n  } = useChartState() as ColumnsState;\n  const bandwidth = xScale.bandwidth();\n  const valueLabelsData = useMemo(() => {\n    if (!showValues || !width || !height) {\n      return [];\n    }\n\n    return chartData\n      .map((d, i) => {\n        if (i % renderEveryNthValue !== 0) {\n          return null;\n        }\n\n        const key = getRenderingKey(d);\n        const valueRaw = getY(d);\n        const xScaled = xScale(getX(d)) as number;\n        const value = valueRaw === null || isNaN(valueRaw) ? 0 : valueRaw;\n        const yRender = yScale(Math.max(value, 0));\n        const valueOffset = getValueOffset(d);\n\n        return {\n          key,\n          x: xScaled + bandwidth / 2,\n          y: yRender + valueOffset,\n          valueLabel: valueLabelFormatter(value),\n        } satisfies RenderTotalValueLabelDatum;\n      })\n      .filter(truthy);\n  }, [\n    showValues,\n    width,\n    height,\n    chartData,\n    renderEveryNthValue,\n    getRenderingKey,\n    getY,\n    xScale,\n    getX,\n    yScale,\n    bandwidth,\n    valueLabelFormatter,\n    getValueOffset,\n  ]);\n\n  return valueLabelsData;\n};\n","import { useEffect, useMemo, useRef } from \"react\";\n\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport {\n  RenderColumnDatum,\n  renderColumns,\n} from \"@/charts/column/rendering-utils\";\nimport { useColumnValueLabelsData } from \"@/charts/column/show-values-utils\";\nimport { useGetAnnotationRenderState } from \"@/charts/shared/annotation-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { renderTotalValueLabels } from \"@/charts/shared/render-value-labels\";\nimport {\n  renderContainer,\n  RenderContainerOptions,\n  RenderVerticalWhiskerDatum,\n  renderVerticalWhiskers,\n} from \"@/charts/shared/rendering-utils\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport const ErrorWhiskers = () => {\n  const {\n    getX,\n    getY,\n    getYErrorPresent,\n    getYErrorRange,\n    chartData,\n    yScale,\n    xScale,\n    showYUncertainty,\n    bounds,\n  } = useChartState() as ColumnsState;\n  const { margins, width, height } = bounds;\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const bandwidth = xScale.bandwidth();\n  const renderData = useMemo(() => {\n    if (!getYErrorRange || !showYUncertainty) {\n      return [];\n    }\n\n    return chartData.filter(getYErrorPresent).map((d, i) => {\n      const x0 = xScale(getX(d)) as number;\n      const barWidth = Math.min(bandwidth, 15);\n      const y = getY(d) as number;\n      const [y1, y2] = getYErrorRange(d);\n\n      return {\n        key: `${i}`,\n        x: x0 + bandwidth / 2 - barWidth / 2,\n        y: yScale(y),\n        y1: yScale(y1),\n        y2: yScale(y2),\n        width: barWidth,\n      } satisfies RenderVerticalWhiskerDatum;\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    getYErrorRange,\n    showYUncertainty,\n    chartData,\n    getYErrorPresent,\n    xScale,\n    getX,\n    bandwidth,\n    yScale,\n    width,\n    height,\n  ]);\n\n  useEffect(() => {\n    if (ref.current) {\n      renderContainer(ref.current, {\n        id: \"columns-error-whiskers\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g, opts) => renderVerticalWhiskers(g, renderData, opts),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    renderData,\n    transitionDuration,\n  ]);\n\n  return <g ref={ref} />;\n};\n\nexport const Columns = () => {\n  const {\n    chartData,\n    bounds: { margins },\n    xDimension,\n    getX,\n    xScale,\n    getY,\n    yScale,\n    getRenderingKey,\n    colors,\n    rotateValues,\n  } = useChartState() as ColumnsState;\n  const { labelFontSize, fontFamily } = useChartTheme();\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const bandwidth = xScale.bandwidth();\n  const y0 = yScale(0);\n  const getAnnotationRenderState = useGetAnnotationRenderState();\n  const columnsData = useMemo(() => {\n    return chartData.map((d) => {\n      const key = getRenderingKey(d);\n      const valueRaw = getY(d);\n      const x = getX(d);\n      const xScaled = xScale(x) as number;\n      const value = valueRaw === null || isNaN(valueRaw) ? 0 : valueRaw;\n      const y = yScale(value);\n      const yRender = yScale(Math.max(value, 0));\n      const height = Math.max(0, Math.abs(y - y0));\n      const { color, focused } = getAnnotationRenderState(d, {\n        axisComponentId: xDimension.id,\n        axisValue: x,\n      });\n\n      return {\n        key,\n        x: xScaled,\n        y: yRender,\n        width: bandwidth,\n        height,\n        // Calling colors(key) directly results in every key being added to the domain,\n        // which is not what we want.\n        color: color ?? colors.copy()(key),\n        focused,\n        observation: d,\n      } satisfies RenderColumnDatum;\n    });\n  }, [\n    chartData,\n    getRenderingKey,\n    getY,\n    getX,\n    xScale,\n    yScale,\n    y0,\n    getAnnotationRenderState,\n    xDimension.id,\n    bandwidth,\n    colors,\n  ]);\n\n  const valueLabelsData = useColumnValueLabelsData();\n\n  useEffect(() => {\n    const g = ref.current;\n\n    if (g) {\n      const common: Pick<\n        RenderContainerOptions,\n        \"id\" | \"transform\" | \"transition\"\n      > = {\n        id: \"columns\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: {\n          enable: enableTransition,\n          duration: transitionDuration,\n        },\n      };\n      renderContainer(g, {\n        ...common,\n        render: (g, opts) => renderColumns(g, columnsData, { ...opts, y0 }),\n      });\n      renderContainer(g, {\n        ...common,\n        render: (g, opts) =>\n          renderTotalValueLabels(g, valueLabelsData, {\n            ...opts,\n            rotate: rotateValues,\n            fontFamily,\n            fontSize: labelFontSize,\n          }),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    columnsData,\n    transitionDuration,\n    y0,\n    valueLabelsData,\n    labelFontSize,\n    rotateValues,\n    fontFamily,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { useEffect, useMemo, useRef } from \"react\";\n\nimport { GroupedColumnsState } from \"@/charts/column/columns-grouped-state\";\nimport {\n  RenderColumnDatum,\n  renderColumns,\n} from \"@/charts/column/rendering-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  renderContainer,\n  RenderVerticalWhiskerDatum,\n  renderVerticalWhiskers,\n} from \"@/charts/shared/rendering-utils\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport const ErrorWhiskers = () => {\n  const {\n    bounds,\n    xScale,\n    xScaleIn,\n    getY,\n    getYErrorRange,\n    getYErrorPresent,\n    yScale,\n    getSegment,\n    grouped,\n    showYUncertainty,\n  } = useChartState() as GroupedColumnsState;\n  const { margins, width, height } = bounds;\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const renderData = useMemo(() => {\n    if (!getYErrorRange || !showYUncertainty) {\n      return [];\n    }\n\n    const bandwidth = xScaleIn.bandwidth();\n\n    return grouped\n      .filter((d) => d[1].some(getYErrorPresent))\n      .flatMap(([segment, observations]) =>\n        observations.map((d) => {\n          const x0 = xScaleIn(getSegment(d)) as number;\n          const barWidth = Math.min(bandwidth, 15);\n          const y = getY(d) as number;\n          const [y1, y2] = getYErrorRange(d);\n\n          return {\n            key: `${segment}-${getSegment(d)}`,\n            x: (xScale(segment) as number) + x0 + bandwidth / 2 - barWidth / 2,\n            y: yScale(y),\n            y1: yScale(y1),\n            y2: yScale(y2),\n            width: barWidth,\n          } satisfies RenderVerticalWhiskerDatum;\n        })\n      );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    getSegment,\n    getY,\n    getYErrorRange,\n    getYErrorPresent,\n    grouped,\n    showYUncertainty,\n    xScale,\n    xScaleIn,\n    yScale,\n    width,\n    height,\n  ]);\n\n  useEffect(() => {\n    if (ref.current) {\n      renderContainer(ref.current, {\n        id: \"columns-grouped-error-whiskers\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g, opts) => renderVerticalWhiskers(g, renderData, opts),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    renderData,\n    transitionDuration,\n  ]);\n\n  return <g ref={ref} />;\n};\n\nexport const ColumnsGrouped = () => {\n  const {\n    bounds,\n    xScale,\n    xScaleIn,\n    getY,\n    yScale,\n    getSegment,\n    colors,\n    grouped,\n    getRenderingKey,\n  } = useChartState() as GroupedColumnsState;\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const { margins, height } = bounds;\n  const bandwidth = xScaleIn.bandwidth();\n  const y0 = yScale(0);\n  const renderData = useMemo(() => {\n    return grouped.flatMap(([x, observations]) => {\n      return observations.map((d) => {\n        const segment = getSegment(d);\n        const y = getY(d) as number;\n        const key = getRenderingKey(d, segment);\n\n        return {\n          key,\n          x: (xScale(x) as number) + (xScaleIn(segment) as number),\n          y: yScale(Math.max(y, 0)),\n          width: bandwidth,\n          height: Math.max(0, Math.abs(yScale(y) - y0)),\n          color: colors(segment),\n          observation: d,\n        } satisfies RenderColumnDatum;\n      });\n    });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    colors,\n    getSegment,\n    bandwidth,\n    getY,\n    grouped,\n    xScaleIn,\n    xScale,\n    yScale,\n    y0,\n    getRenderingKey,\n    height,\n  ]);\n\n  useEffect(() => {\n    if (ref.current) {\n      renderContainer(ref.current, {\n        id: \"columns-grouped\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g, opts) => renderColumns(g, renderData, { ...opts, y0 }),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    renderData,\n    transitionDuration,\n    y0,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { ascending, rollup, sum } from \"d3-array\";\nimport orderBy from \"lodash/orderBy\";\nimport { useCallback } from \"react\";\n\nimport { usePlottableData } from \"@/charts/shared/chart-helpers\";\nimport {\n  BandXVariables,\n  BaseVariables,\n  ChartStateData,\n  InteractiveFiltersVariables,\n  NumericalYErrorVariables,\n  NumericalYVariables,\n  RenderingVariables,\n  SegmentVariables,\n  SortingVariables,\n  useBandXVariables,\n  useBaseVariables,\n  useChartData,\n  useInteractiveFiltersVariables,\n  useNumericalYErrorVariables,\n  useNumericalYVariables,\n  useSegmentVariables,\n} from \"@/charts/shared/chart-state\";\nimport { useRenderingKeyVariable } from \"@/charts/shared/rendering-utils\";\nimport { useChartConfigFilters } from \"@/config-utils\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalEntityDimension, Observation } from \"@/domain/data\";\nimport { sortByIndex } from \"@/utils/array\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type ColumnsGroupedStateVariables = BaseVariables &\n  SortingVariables &\n  BandXVariables &\n  NumericalYVariables &\n  NumericalYErrorVariables &\n  SegmentVariables &\n  RenderingVariables &\n  InteractiveFiltersVariables;\n\nexport const useColumnsGroupedStateVariables = (\n  props: ChartProps<ColumnConfig>\n): ColumnsGroupedStateVariables => {\n  const {\n    chartConfig,\n    observations,\n    dimensions,\n    dimensionsById,\n    measures,\n    measuresById,\n  } = props;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { x, y, segment, animation } = fields;\n  const xDimension = dimensionsById[x.componentId];\n  const filters = useChartConfigFilters(chartConfig);\n\n  const baseVariables = useBaseVariables(chartConfig);\n  const bandXVariables = useBandXVariables(x, {\n    dimensionsById,\n    observations,\n  });\n  const numericalYVariables = useNumericalYVariables(\"column\", y, {\n    measuresById,\n  });\n  const numericalYErrorVariables = useNumericalYErrorVariables(y, {\n    getValue: numericalYVariables.getY,\n    dimensions,\n    measures,\n  });\n  const segmentVariables = useSegmentVariables(segment, {\n    dimensionsById,\n    observations,\n  });\n  const interactiveFiltersVariables = useInteractiveFiltersVariables(\n    interactiveFiltersConfig,\n    { dimensionsById }\n  );\n\n  const { getX, getXAsDate } = bandXVariables;\n  const { getY } = numericalYVariables;\n  const sortData: ColumnsGroupedStateVariables[\"sortData\"] = useCallback(\n    (data) => {\n      const { sortingOrder, sortingType } = x.sorting ?? {};\n      const xGetter = isTemporalEntityDimension(xDimension)\n        ? (d: Observation) => getXAsDate(d).getTime().toString()\n        : getX;\n      const order = [\n        ...rollup(\n          data,\n          (v) => sum(v, (d) => getY(d)),\n          (d) => xGetter(d)\n        ),\n      ]\n        .sort((a, b) => ascending(a[1], b[1]))\n        .map((d) => d[0]);\n\n      if (sortingType === \"byDimensionLabel\") {\n        return orderBy(data, xGetter, sortingOrder);\n      } else if (sortingType === \"byMeasure\") {\n        return sortByIndex({ data, order, getCategory: xGetter, sortingOrder });\n      } else {\n        return orderBy(data, xGetter, \"asc\");\n      }\n    },\n    [getX, getXAsDate, getY, x.sorting, xDimension]\n  );\n\n  const getRenderingKey = useRenderingKeyVariable(\n    dimensions,\n    filters,\n    animation\n  );\n\n  return {\n    ...baseVariables,\n    sortData,\n    ...bandXVariables,\n    ...numericalYVariables,\n    ...numericalYErrorVariables,\n    ...segmentVariables,\n    ...interactiveFiltersVariables,\n    getRenderingKey,\n  };\n};\n\nexport const useColumnsGroupedStateData = (\n  chartProps: ChartProps<ColumnConfig>,\n  variables: ColumnsGroupedStateVariables\n): ChartStateData => {\n  const { chartConfig, observations } = chartProps;\n  const {\n    sortData,\n    xDimension,\n    getXAsDate,\n    getY,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  } = variables;\n  const plottableData = usePlottableData(observations, {\n    getY,\n  });\n\n  return useChartData(plottableData, {\n    sortData,\n    chartConfig,\n    timeRangeDimensionId: xDimension.id,\n    getAxisValueAsDate: getXAsDate,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  });\n};\n","import { extent, group, max, rollup, sum } from \"d3-array\";\nimport {\n  ScaleBand,\n  scaleBand,\n  ScaleLinear,\n  scaleLinear,\n  ScaleOrdinal,\n  scaleOrdinal,\n  scaleTime,\n} from \"d3-scale\";\nimport { schemeCategory10 } from \"d3-scale-chromatic\";\nimport orderBy from \"lodash/orderBy\";\nimport { PropsWithChildren, useCallback, useMemo } from \"react\";\n\nimport {\n  ColumnsGroupedStateVariables,\n  useColumnsGroupedStateData,\n  useColumnsGroupedStateVariables,\n} from \"@/charts/column/columns-grouped-state-props\";\nimport {\n  PADDING_INNER,\n  PADDING_OUTER,\n  PADDING_WITHIN,\n} from \"@/charts/column/constants\";\nimport {\n  AxisLabelSizeVariables,\n  getChartWidth,\n  useAxisLabelSizeVariables,\n  useChartBounds,\n  useChartPadding,\n} from \"@/charts/shared/chart-dimensions\";\nimport {\n  ChartContext,\n  ChartStateData,\n  CommonChartState,\n  InteractiveXTimeRangeState,\n} from \"@/charts/shared/chart-state\";\nimport { TooltipInfo, TooltipValue } from \"@/charts/shared/interaction/tooltip\";\nimport {\n  getCenteredTooltipPlacement,\n  MOBILE_TOOLTIP_PLACEMENT,\n} from \"@/charts/shared/interaction/tooltip-box\";\nimport { DEFAULT_MARGIN_TOP } from \"@/charts/shared/margins\";\nimport { useChartFormatters } from \"@/charts/shared/use-chart-formatters\";\nimport { InteractionProvider } from \"@/charts/shared/use-interaction\";\nimport { useSize } from \"@/charts/shared/use-size\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalDimension, Observation } from \"@/domain/data\";\nimport { formatNumberWithUnit, useFormatNumber } from \"@/formatters\";\nimport { getPalette } from \"@/palettes\";\nimport { sortByIndex } from \"@/utils/array\";\nimport {\n  getSortingOrders,\n  makeDimensionValueSorters,\n} from \"@/utils/sorting-values\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type GroupedColumnsState = CommonChartState &\n  ColumnsGroupedStateVariables &\n  InteractiveXTimeRangeState & {\n    chartType: \"column\";\n    xScale: ScaleBand<string>;\n    xScaleInteraction: ScaleBand<string>;\n    xScaleIn: ScaleBand<string>;\n    yScale: ScaleLinear<number, number>;\n    segments: string[];\n    colors: ScaleOrdinal<string, string>;\n    getColorLabel: (segment: string) => string;\n    grouped: [string, Observation[]][];\n    getTooltipInfo: (d: Observation) => TooltipInfo;\n    leftAxisLabelSize: AxisLabelSizeVariables;\n    leftAxisLabelOffsetTop: number;\n    bottomAxisLabelSize: AxisLabelSizeVariables;\n    formatXAxisTick?: (d: string) => string;\n  };\n\nconst useColumnsGroupedState = (\n  chartProps: ChartProps<ColumnConfig>,\n  variables: ColumnsGroupedStateVariables,\n  data: ChartStateData\n): GroupedColumnsState => {\n  const { chartConfig } = chartProps;\n  const {\n    xDimension,\n    getX,\n    getXAsDate,\n    getXAbbreviationOrLabel,\n    getXLabel,\n    formatXDate,\n    yMeasure,\n    getY,\n    getMinY,\n    getYErrorRange,\n    getFormattedYUncertainty,\n    segmentDimension,\n    segmentsByAbbreviationOrLabel,\n    getSegment,\n    getSegmentAbbreviationOrLabel,\n    getSegmentLabel,\n    xAxisLabel,\n    yAxisLabel,\n  } = variables;\n  const {\n    chartData,\n    scalesData,\n    segmentData,\n    timeRangeData,\n    paddingData,\n    allData,\n  } = data;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { y } = fields;\n\n  const { width, height } = useSize();\n  const formatNumber = useFormatNumber({ decimals: \"auto\" });\n  const formatters = useChartFormatters(chartProps);\n\n  const segmentsByValue = useMemo(() => {\n    const values = segmentDimension?.values || [];\n\n    return new Map(values.map((d) => [d.value, d]));\n  }, [segmentDimension?.values]);\n\n  // segments\n  const segmentSortingOrder = fields.segment?.sorting?.sortingOrder;\n\n  const sumsBySegment = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        segmentData,\n        (v) => sum(v, (x) => getY(x)),\n        (x) => getSegment(x)\n      )\n    );\n  }, [segmentData, getY, getSegment]);\n\n  const segmentFilter = segmentDimension?.id\n    ? chartConfig.cubes.find((d) => d.iri === segmentDimension.cubeIri)\n        ?.filters[segmentDimension.id]\n    : undefined;\n  const { allSegments, segments } = useMemo(() => {\n    const allUniqueSegments = Array.from(\n      new Set(segmentData.map((d) => getSegment(d)))\n    );\n    const uniqueSegments = Array.from(\n      new Set(scalesData.map((d) => getSegment(d)))\n    );\n    const sorting = fields?.segment?.sorting;\n    const sorters = makeDimensionValueSorters(segmentDimension, {\n      sorting,\n      sumsBySegment,\n      useAbbreviations: fields.segment?.useAbbreviations,\n      dimensionFilter: segmentFilter,\n    });\n    const allSegments = orderBy(\n      allUniqueSegments,\n      sorters,\n      getSortingOrders(sorters, sorting)\n    );\n\n    return {\n      allSegments,\n      segments: allSegments.filter((d) => uniqueSegments.includes(d)),\n    };\n  }, [\n    scalesData,\n    segmentData,\n    segmentDimension,\n    fields.segment?.sorting,\n    fields.segment?.useAbbreviations,\n    sumsBySegment,\n    segmentFilter,\n    getSegment,\n  ]);\n\n  /* Scales */\n  const xFilter = chartConfig.cubes.find((d) => d.iri === xDimension.cubeIri)\n    ?.filters[xDimension.id];\n  const sumsByX = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        chartData,\n        (v) => sum(v, (d) => getY(d)),\n        (x) => getX(x)\n      )\n    );\n  }, [chartData, getX, getY]);\n\n  const {\n    xTimeRangeDomainLabels,\n    colors,\n    yScale,\n    paddingYScale,\n    xScaleTimeRange,\n    xScale,\n    xScaleIn,\n    xScaleInteraction,\n  } = useMemo(() => {\n    const colors = scaleOrdinal<string, string>();\n\n    if (\n      fields.segment &&\n      segmentDimension &&\n      fields.color?.type === \"segment\"\n    ) {\n      const segmentColor = fields.color;\n      const orderedSegmentLabelsAndColors = allSegments.map((segment) => {\n        const dvIri =\n          segmentsByAbbreviationOrLabel.get(segment)?.value ||\n          segmentsByValue.get(segment)?.value ||\n          \"\";\n\n        return {\n          label: segment,\n          color: segmentColor.colorMapping![dvIri] ?? schemeCategory10[0],\n        };\n      });\n\n      colors.domain(orderedSegmentLabelsAndColors.map((s) => s.label));\n      colors.range(orderedSegmentLabelsAndColors.map((s) => s.color));\n    } else {\n      colors.domain(allSegments);\n      colors.range(\n        getPalette({\n          paletteId: fields.color?.paletteId,\n          colorField: fields.color,\n        })\n      );\n    }\n\n    colors.unknown(() => undefined);\n\n    const xValues = [...new Set(scalesData.map(getX))];\n    const xTimeRangeValues = [...new Set(timeRangeData.map(getX))];\n    const xSorting = fields.x?.sorting;\n    const xSorters = makeDimensionValueSorters(xDimension, {\n      sorting: xSorting,\n      useAbbreviations: fields.x?.useAbbreviations,\n      measureBySegment: sumsByX,\n      dimensionFilter: xFilter,\n    });\n    const xDomain = orderBy(\n      xValues,\n      xSorters,\n      getSortingOrders(xSorters, xSorting)\n    );\n    const xTimeRangeDomainLabels = xTimeRangeValues.map(getXLabel);\n    const xScale = scaleBand()\n      .domain(xDomain)\n      .paddingInner(PADDING_INNER)\n      .paddingOuter(PADDING_OUTER);\n    const xScaleInteraction = scaleBand()\n      .domain(xDomain)\n      .paddingInner(0)\n      .paddingOuter(0);\n    const xScaleIn = scaleBand().domain(segments).padding(PADDING_WITHIN);\n\n    const xScaleTimeRangeDomain = extent(timeRangeData, (d) =>\n      getXAsDate(d)\n    ) as [Date, Date];\n    const xScaleTimeRange = scaleTime().domain(xScaleTimeRangeDomain);\n\n    // y\n    const yScale = scaleLinear();\n    const paddingYScale = scaleLinear();\n\n    if (y.customDomain) {\n      yScale.domain(y.customDomain);\n      paddingYScale.domain(y.customDomain);\n    } else {\n      const minValue = getMinY(scalesData, (d) => {\n        return getYErrorRange?.(d)[0] ?? getY(d);\n      });\n      const maxValue = Math.max(\n        max(scalesData, (d) => {\n          return getYErrorRange?.(d)[1] ?? getY(d);\n        }) ?? 0,\n        0\n      );\n      yScale.domain([minValue, maxValue]).nice();\n\n      const minPaddingValue = getMinY(paddingData, (d) => {\n        return getYErrorRange?.(d)[0] ?? getY(d);\n      });\n      const maxPaddingValue = Math.max(\n        max(paddingData, (d) => {\n          return getYErrorRange?.(d)[1] ?? getY(d);\n        }) ?? 0,\n        0\n      );\n      paddingYScale.domain([minPaddingValue, maxPaddingValue]).nice();\n    }\n\n    return {\n      colors,\n      yScale,\n      paddingYScale,\n      xScaleTimeRange,\n      xScale,\n      xScaleIn,\n      xScaleInteraction,\n      xTimeRangeDomainLabels,\n    };\n  }, [\n    fields.segment,\n    fields.color,\n    fields.x?.sorting,\n    fields.x?.useAbbreviations,\n    segmentDimension,\n    scalesData,\n    getX,\n    xDimension,\n    sumsByX,\n    xFilter,\n    getXLabel,\n    segments,\n    timeRangeData,\n    paddingData,\n    allSegments,\n    segmentsByAbbreviationOrLabel,\n    segmentsByValue,\n    getXAsDate,\n    getYErrorRange,\n    getY,\n    getMinY,\n    y.customDomain,\n  ]);\n\n  // Group\n  const grouped: [string, Observation[]][] = useMemo(() => {\n    const xKeys = xScale.domain();\n    const groupedMap = group(chartData, getX);\n    const grouped: [string, Observation[]][] =\n      groupedMap.size < xKeys.length\n        ? xKeys.map((d) => {\n            if (groupedMap.has(d)) {\n              return [d, groupedMap.get(d) as Observation[]];\n            } else {\n              return [d, []];\n            }\n          })\n        : [...groupedMap];\n\n    return grouped.map(([key, data]) => {\n      return [\n        key,\n        sortByIndex({\n          data,\n          order: segments,\n          getCategory: getSegment,\n          sortingOrder: segmentSortingOrder,\n        }),\n      ];\n    });\n  }, [getSegment, getX, chartData, segmentSortingOrder, segments, xScale]);\n\n  const { top, left, bottom } = useChartPadding({\n    xLabelPresent: !!xAxisLabel,\n    yScale: paddingYScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    bandDomain: xTimeRangeDomainLabels.every((d) => d === undefined)\n      ? xScale.domain()\n      : xTimeRangeDomainLabels,\n  });\n  const right = 40;\n  const leftAxisLabelSize = useAxisLabelSizeVariables({\n    label: yAxisLabel,\n    width,\n  });\n  const bottomAxisLabelSize = useAxisLabelSizeVariables({\n    label: xAxisLabel,\n    width,\n  });\n  const margins = {\n    top: DEFAULT_MARGIN_TOP + top + leftAxisLabelSize.offset,\n    right,\n    bottom,\n    left,\n  };\n  const chartWidth = getChartWidth({ width, left, right });\n  const bounds = useChartBounds({ width, chartWidth, height, margins });\n  const { chartHeight } = bounds;\n\n  // Adjust scales based on chart dimensions\n  xScale.range([0, chartWidth]);\n  xScaleInteraction.range([0, chartWidth]);\n  xScaleIn.range([0, xScale.bandwidth()]);\n  xScaleTimeRange.range([0, chartWidth]);\n  yScale.range([chartHeight, 0]);\n\n  const isMobile = useIsMobile();\n\n  const formatXAxisTick = useCallback(\n    (tick: string) => {\n      return isTemporalDimension(xDimension)\n        ? formatXDate(tick)\n        : getXLabel(tick);\n    },\n    [xDimension, formatXDate, getXLabel]\n  );\n\n  const getTooltipInfo = (datum: Observation): TooltipInfo => {\n    const bw = xScale.bandwidth();\n    const x = getX(datum);\n\n    const tooltipValues = chartData.filter((d) => getX(d) === x);\n    const yValues = tooltipValues.map(getY);\n    const sortedTooltipValues = sortByIndex({\n      data: tooltipValues,\n      order: segments,\n      getCategory: getSegment,\n      // Always ascending to match visual order of colors of the stack\n      sortingOrder: \"asc\",\n    });\n    const yValueFormatter = (value: number | null) => {\n      return formatNumberWithUnit(\n        value,\n        formatters[yMeasure.id] ?? formatNumber,\n        yMeasure.unit\n      );\n    };\n\n    const xAnchorRaw = (xScale(x) as number) + bw * 0.5;\n    const [yMin, yMax] = extent(yValues, (d) => d ?? 0) as [number, number];\n    const yAnchor = isMobile ? chartHeight : yScale((yMin + yMax) * 0.5);\n    const placement = isMobile\n      ? MOBILE_TOOLTIP_PLACEMENT\n      : getCenteredTooltipPlacement({\n          chartWidth,\n          xAnchor: xAnchorRaw,\n          topAnchor: !fields.segment,\n        });\n    const xLabel = getXAbbreviationOrLabel(datum);\n\n    return {\n      xAnchor: xAnchorRaw + (placement.x === \"right\" ? 0.5 : -0.5) * bw,\n      yAnchor,\n      placement,\n      value: formatXAxisTick(xLabel),\n      datum: {\n        label: fields.segment && getSegmentAbbreviationOrLabel(datum),\n        value: yValueFormatter(getY(datum)),\n        error: getFormattedYUncertainty(datum),\n        color: colors(getSegment(datum)),\n      },\n      values: sortedTooltipValues.map((d) => {\n        const segment = getSegment(d);\n\n        return {\n          label: getSegmentAbbreviationOrLabel(d),\n          value: yMeasure.unit\n            ? `${formatNumber(getY(d))}${yMeasure.unit}`\n            : formatNumber(getY(d)),\n          axis: \"y\",\n          axisOffset: yScale(getY(d) ?? 0),\n          error: getFormattedYUncertainty(d),\n          color: colors(segment),\n        } satisfies TooltipValue;\n      }),\n    };\n  };\n\n  return {\n    chartType: \"column\",\n    bounds,\n    chartData,\n    allData,\n    xScale,\n    xScaleInteraction,\n    xScaleIn,\n    xScaleTimeRange,\n    yScale,\n    segments,\n    colors,\n    getColorLabel: getSegmentLabel,\n    grouped,\n    getTooltipInfo,\n    leftAxisLabelSize,\n    leftAxisLabelOffsetTop: top,\n    bottomAxisLabelSize,\n    formatXAxisTick,\n    ...variables,\n  };\n};\n\nconst GroupedColumnChartProvider = (\n  props: PropsWithChildren<ChartProps<ColumnConfig>>\n) => {\n  const { children, ...chartProps } = props;\n  const variables = useColumnsGroupedStateVariables(chartProps);\n  const data = useColumnsGroupedStateData(chartProps, variables);\n  const state = useColumnsGroupedState(chartProps, variables, data);\n\n  return (\n    <ChartContext.Provider value={state}>{children}</ChartContext.Provider>\n  );\n};\n\nexport const GroupedColumnChart = (\n  props: PropsWithChildren<ChartProps<ColumnConfig>>\n) => {\n  return (\n    <InteractionProvider>\n      <GroupedColumnChartProvider {...props} />\n    </InteractionProvider>\n  );\n};\n","import { useEffect, useMemo, useRef } from \"react\";\n\nimport { StackedColumnsState } from \"@/charts/column/columns-stacked-state\";\nimport {\n  renderColumns,\n  useGetRenderStackedColumnDatum,\n} from \"@/charts/column/rendering-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { renderContainer } from \"@/charts/shared/rendering-utils\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport const ColumnsStacked = () => {\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const {\n    bounds: { height, margins },\n    yScale,\n    series,\n  } = useChartState() as StackedColumnsState;\n  const getRenderDatum = useGetRenderStackedColumnDatum();\n  const renderData = useMemo(() => {\n    return series.flatMap(getRenderDatum);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    getRenderDatum,\n    series,\n    // We need to reset the yRange on height change.\n    height,\n  ]);\n  const y0 = yScale(0);\n\n  useEffect(() => {\n    if (ref.current) {\n      renderContainer(ref.current, {\n        id: \"columns-stacked\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g, opts) => renderColumns(g, renderData, { ...opts, y0 }),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    renderData,\n    transitionDuration,\n    y0,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { ascending, descending, group } from \"d3-array\";\nimport { useCallback, useMemo } from \"react\";\n\nimport { getWideData, usePlottableData } from \"@/charts/shared/chart-helpers\";\nimport {\n  BandXVariables,\n  BaseVariables,\n  ChartStateData,\n  InteractiveFiltersVariables,\n  NumericalYVariables,\n  RenderingVariables,\n  SegmentVariables,\n  SortingVariables,\n  useBandXVariables,\n  useBaseVariables,\n  useChartData,\n  useInteractiveFiltersVariables,\n  useNumericalYVariables,\n  useSegmentVariables,\n} from \"@/charts/shared/chart-state\";\nimport { useRenderingKeyVariable } from \"@/charts/shared/rendering-utils\";\nimport { useChartConfigFilters } from \"@/config-utils\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalEntityDimension, Observation } from \"@/domain/data\";\nimport { sortByIndex } from \"@/utils/array\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type ColumnsStackedStateVariables = BaseVariables &\n  SortingVariables<{ plottableDataWide: Observation[] }> &\n  BandXVariables &\n  NumericalYVariables &\n  SegmentVariables &\n  RenderingVariables &\n  InteractiveFiltersVariables;\n\nexport const useColumnsStackedStateVariables = (\n  props: ChartProps<ColumnConfig>\n): ColumnsStackedStateVariables => {\n  const {\n    chartConfig,\n    observations,\n    dimensions,\n    dimensionsById,\n    measuresById,\n  } = props;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { x, y, segment, animation } = fields;\n  const xDimension = dimensionsById[x.componentId];\n  const filters = useChartConfigFilters(chartConfig);\n\n  const baseVariables = useBaseVariables(chartConfig);\n  const bandXVariables = useBandXVariables(x, {\n    dimensionsById,\n    observations,\n  });\n  const numericalYVariables = useNumericalYVariables(\"column\", y, {\n    measuresById,\n  });\n  const segmentVariables = useSegmentVariables(segment, {\n    dimensionsById,\n    observations,\n  });\n  const interactiveFiltersVariables = useInteractiveFiltersVariables(\n    interactiveFiltersConfig,\n    { dimensionsById }\n  );\n\n  const { getX, getXAsDate } = bandXVariables;\n  const sortData: ColumnsStackedStateVariables[\"sortData\"] = useCallback(\n    (data, { plottableDataWide }) => {\n      const { sortingOrder, sortingType } = x.sorting ?? {};\n      const xGetter = isTemporalEntityDimension(xDimension)\n        ? (d: Observation) => getXAsDate(d).getTime().toString()\n        : getX;\n      const xOrder = plottableDataWide\n        .sort((a, b) => ascending(a.total ?? undefined, b.total ?? undefined))\n        .map(xGetter);\n\n      if (sortingOrder === \"desc\" && sortingType === \"byDimensionLabel\") {\n        return [...data].sort((a, b) => descending(xGetter(a), xGetter(b)));\n      } else if (sortingOrder === \"asc\" && sortingType === \"byDimensionLabel\") {\n        return [...data].sort((a, b) => ascending(xGetter(a), xGetter(b)));\n      } else if (sortingType === \"byMeasure\") {\n        return sortByIndex({\n          data,\n          order: xOrder,\n          getCategory: xGetter,\n          sortingOrder,\n        });\n      } else {\n        return [...data].sort((a, b) => ascending(xGetter(a), xGetter(b)));\n      }\n    },\n    [getX, getXAsDate, x.sorting, xDimension]\n  );\n\n  const getRenderingKey = useRenderingKeyVariable(\n    dimensions,\n    filters,\n    animation\n  );\n\n  return {\n    ...baseVariables,\n    sortData,\n    ...bandXVariables,\n    ...numericalYVariables,\n    ...segmentVariables,\n    ...interactiveFiltersVariables,\n    getRenderingKey,\n  };\n};\n\nexport type ColumnsStackedStateData = ChartStateData & {\n  plottableDataWide: Observation[];\n};\n\nexport const useColumnsStackedStateData = (\n  chartProps: ChartProps<ColumnConfig>,\n  variables: ColumnsStackedStateVariables\n): ColumnsStackedStateData => {\n  const { chartConfig, observations } = chartProps;\n  const { fields } = chartConfig;\n  const { x } = fields;\n  const {\n    sortData,\n    xDimension,\n    getX,\n    getXAsDate,\n    getY,\n    getSegment,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  } = variables;\n  const plottableData = usePlottableData(observations, {\n    getY,\n  });\n  const plottableDataWide = useMemo(() => {\n    const plottableDataByX = group(plottableData, getX);\n\n    return getWideData({\n      dataGrouped: plottableDataByX,\n      key: x.componentId,\n      getAxisValue: getY,\n      getSegment,\n    });\n  }, [plottableData, getX, x.componentId, getY, getSegment]);\n  const sortPlottableData = useCallback(\n    (data: Observation[]) => {\n      return sortData(data, { plottableDataWide });\n    },\n    [plottableDataWide, sortData]\n  );\n  const data = useChartData(plottableData, {\n    sortData: sortPlottableData,\n    chartConfig,\n    timeRangeDimensionId: xDimension.id,\n    getAxisValueAsDate: getXAsDate,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  });\n\n  return {\n    ...data,\n    plottableDataWide,\n  };\n};\n","import { extent, group, rollup, sum } from \"d3-array\";\nimport {\n  ScaleBand,\n  scaleBand,\n  ScaleLinear,\n  scaleLinear,\n  ScaleOrdinal,\n  scaleOrdinal,\n  scaleTime,\n} from \"d3-scale\";\nimport { schemeCategory10 } from \"d3-scale-chromatic\";\nimport {\n  Series,\n  stack,\n  stackOffsetDiverging,\n  stackOrderAscending,\n  stackOrderDescending,\n  stackOrderReverse,\n} from \"d3-shape\";\nimport orderBy from \"lodash/orderBy\";\nimport { PropsWithChildren, useCallback, useMemo } from \"react\";\n\nimport {\n  ColumnsStackedStateData,\n  ColumnsStackedStateVariables,\n  useColumnsStackedStateData,\n  useColumnsStackedStateVariables,\n} from \"@/charts/column/columns-stacked-state-props\";\nimport { PADDING_INNER, PADDING_OUTER } from \"@/charts/column/constants\";\nimport {\n  ANNOTATION_SINGLE_SEGMENT_OFFSET,\n  GetAnnotationInfo,\n} from \"@/charts/shared/annotations\";\nimport {\n  AxisLabelSizeVariables,\n  getChartWidth,\n  useAxisLabelSizeVariables,\n  useChartBounds,\n  useChartPadding,\n} from \"@/charts/shared/chart-dimensions\";\nimport {\n  getWideData,\n  normalizeData,\n  useGetIdentityY,\n} from \"@/charts/shared/chart-helpers\";\nimport {\n  ChartContext,\n  CommonChartState,\n  InteractiveXTimeRangeState,\n} from \"@/charts/shared/chart-state\";\nimport { TooltipInfo, TooltipValue } from \"@/charts/shared/interaction/tooltip\";\nimport {\n  getCenteredTooltipPlacement,\n  MOBILE_TOOLTIP_PLACEMENT,\n} from \"@/charts/shared/interaction/tooltip-box\";\nimport { DEFAULT_MARGIN_TOP } from \"@/charts/shared/margins\";\nimport {\n  useValueLabelFormatter,\n  ValueLabelFormatter,\n} from \"@/charts/shared/show-values-utils\";\nimport {\n  getStackedPosition,\n  getStackedTooltipValueFormatter,\n  getStackedYScale,\n} from \"@/charts/shared/stacked-helpers\";\nimport { useChartFormatters } from \"@/charts/shared/use-chart-formatters\";\nimport { InteractionProvider } from \"@/charts/shared/use-interaction\";\nimport { useSize } from \"@/charts/shared/use-size\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalDimension, Observation } from \"@/domain/data\";\nimport { useFormatNumber } from \"@/formatters\";\nimport { getPalette } from \"@/palettes\";\nimport { useChartInteractiveFilters } from \"@/stores/interactive-filters\";\nimport { sortByIndex } from \"@/utils/array\";\nimport {\n  getSortingOrders,\n  makeDimensionValueSorters,\n} from \"@/utils/sorting-values\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type StackedColumnsState = CommonChartState &\n  ColumnsStackedStateVariables &\n  InteractiveXTimeRangeState & {\n    chartType: \"column\";\n    chartDataGroupedByX: Map<string, Observation[]>;\n    xScale: ScaleBand<string>;\n    xScaleInteraction: ScaleBand<string>;\n    yScale: ScaleLinear<number, number>;\n    segments: string[];\n    colors: ScaleOrdinal<string, string>;\n    getColorLabel: (segment: string) => string;\n    chartWideData: ArrayLike<Observation>;\n    series: Series<{ [key: string]: number }, string>[];\n    getAnnotationInfo: GetAnnotationInfo;\n    getTooltipInfo: (d: Observation) => TooltipInfo;\n    leftAxisLabelSize: AxisLabelSizeVariables;\n    leftAxisLabelOffsetTop: number;\n    bottomAxisLabelSize: AxisLabelSizeVariables;\n    valueLabelFormatter: ValueLabelFormatter;\n    formatXAxisTick?: (d: string) => string;\n  };\n\nconst useColumnsStackedState = (\n  chartProps: ChartProps<ColumnConfig>,\n  variables: ColumnsStackedStateVariables,\n  data: ColumnsStackedStateData\n): StackedColumnsState => {\n  const { chartConfig, dimensions, measures } = chartProps;\n  const {\n    xDimension,\n    getX,\n    getXAsDate,\n    getXAbbreviationOrLabel,\n    getXLabel,\n    formatXDate,\n    yMeasure,\n    getY,\n    segmentDimension,\n    segmentsByAbbreviationOrLabel,\n    getSegment,\n    getSegmentAbbreviationOrLabel,\n    getSegmentLabel,\n    xAxisLabel,\n    yAxisLabel,\n  } = variables;\n  const getIdentityY = useGetIdentityY(yMeasure.id);\n  const {\n    chartData,\n    scalesData,\n    segmentData,\n    timeRangeData,\n    paddingData,\n    allData,\n  } = data;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { y } = fields;\n\n  const { width, height } = useSize();\n  const formatNumber = useFormatNumber({ decimals: \"auto\" });\n  const formatters = useChartFormatters(chartProps);\n  const calculationType = useChartInteractiveFilters((d) => d.calculation.type);\n\n  const xKey = fields.x.componentId;\n\n  const segmentsByValue = useMemo(() => {\n    const values = segmentDimension?.values || [];\n\n    return new Map(values.map((d) => [d.value, d]));\n  }, [segmentDimension?.values]);\n\n  const sumsBySegment = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        scalesData,\n        (v) => sum(v, (x) => getY(x)),\n        (x) => getSegment(x)\n      )\n    );\n  }, [getSegment, getY, scalesData]);\n\n  const segmentFilter = segmentDimension?.id\n    ? chartConfig.cubes.find((d) => d.iri === segmentDimension.cubeIri)\n        ?.filters[segmentDimension.id]\n    : undefined;\n  const { allSegments, segments } = useMemo(() => {\n    const allUniqueSegments = Array.from(new Set(segmentData.map(getSegment)));\n    const uniqueSegments = Array.from(new Set(scalesData.map(getSegment)));\n    const sorting = fields?.segment?.sorting;\n    const sorters = makeDimensionValueSorters(segmentDimension, {\n      sorting,\n      sumsBySegment,\n      useAbbreviations: fields.segment?.useAbbreviations,\n      dimensionFilter: segmentFilter,\n    });\n    const allSegments = orderBy(\n      allUniqueSegments,\n      sorters,\n      getSortingOrders(sorters, sorting)\n    );\n\n    return {\n      allSegments,\n      segments: allSegments.filter((d) => uniqueSegments.includes(d)),\n    };\n  }, [\n    scalesData,\n    segmentData,\n    segmentDimension,\n    fields.segment?.sorting,\n    fields.segment?.useAbbreviations,\n    sumsBySegment,\n    segmentFilter,\n    getSegment,\n  ]);\n\n  const sumsByX = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        chartData,\n        (v) => sum(v, (d) => getY(d)),\n        (x) => getX(x)\n      )\n    );\n  }, [chartData, getX, getY]);\n\n  const normalize = calculationType === \"percent\";\n  const chartDataGroupedByX = useMemo(() => {\n    if (normalize) {\n      return group(\n        normalizeData(chartData, {\n          key: yMeasure.id,\n          getAxisValue: getY,\n          getTotalGroupValue: (d) => sumsByX[getX(d)],\n        }),\n        getX\n      );\n    }\n\n    return group(chartData, getX);\n  }, [normalize, chartData, getX, yMeasure.id, getY, sumsByX]);\n\n  const chartWideData = useMemo(() => {\n    return getWideData({\n      dataGrouped: chartDataGroupedByX,\n      key: xKey,\n      getAxisValue: getY,\n      getSegment,\n      allSegments: segments,\n      imputationType: \"zeros\",\n    });\n  }, [chartDataGroupedByX, xKey, getY, getSegment, segments]);\n\n  const xFilter = chartConfig.cubes.find((d) => d.iri === xDimension.cubeIri)\n    ?.filters[xDimension.id];\n\n  // Map ordered segments labels to colors\n  const {\n    colors,\n    xScale,\n    xTimeRangeDomainLabels,\n    xScaleInteraction,\n    xScaleTimeRange,\n  } = useMemo(() => {\n    const colors = scaleOrdinal<string, string>();\n\n    if (\n      fields.segment &&\n      segmentsByAbbreviationOrLabel &&\n      fields.color.type === \"segment\"\n    ) {\n      const segmentColor = fields.color;\n      const orderedSegmentLabelsAndColors = allSegments.map((segment) => {\n        // FIXME: Labels in observations can differ from dimension values because the latter can be concatenated to only appear once per value\n        // See https://github.com/visualize-admin/visualization-tool/issues/97\n        const dvIri =\n          segmentsByAbbreviationOrLabel.get(segment)?.value ||\n          segmentsByValue.get(segment)?.value ||\n          \"\";\n\n        // There is no way to gracefully recover here :(\n        if (!dvIri) {\n          console.warn(`Can't find color for '${segment}'.`);\n        }\n\n        return {\n          label: segment,\n          color: segmentColor.colorMapping![dvIri] ?? schemeCategory10[0],\n        };\n      });\n\n      colors.domain(orderedSegmentLabelsAndColors.map((s) => s.label));\n      colors.range(orderedSegmentLabelsAndColors.map((s) => s.color));\n    } else {\n      colors.domain(allSegments);\n      colors.range(\n        getPalette({\n          paletteId: fields.color.paletteId,\n          colorField: fields.color,\n        })\n      );\n    }\n\n    colors.unknown(() => undefined);\n\n    const xValues = [...new Set(scalesData.map(getX))];\n    const xTimeRangeValues = [...new Set(timeRangeData.map(getX))];\n    const xSorting = fields.x?.sorting;\n    const xSorters = makeDimensionValueSorters(xDimension, {\n      sorting: xSorting,\n      useAbbreviations: fields.x?.useAbbreviations,\n      measureBySegment: sumsByX,\n      dimensionFilter: xFilter,\n    });\n    const xDomain = orderBy(\n      xValues,\n      xSorters,\n      getSortingOrders(xSorters, xSorting)\n    );\n    const xTimeRangeDomainLabels = xTimeRangeValues.map(getXLabel);\n    const xScale = scaleBand()\n      .domain(xDomain)\n      .paddingInner(PADDING_INNER)\n      .paddingOuter(PADDING_OUTER);\n    const xScaleInteraction = scaleBand()\n      .domain(xDomain)\n      .paddingInner(0)\n      .paddingOuter(0);\n\n    const xScaleTimeRangeDomain = extent(timeRangeData, (d) =>\n      getXAsDate(d)\n    ) as [Date, Date];\n    const xScaleTimeRange = scaleTime().domain(xScaleTimeRangeDomain);\n\n    return {\n      colors,\n      xScale,\n      xTimeRangeDomainLabels,\n      xScaleTimeRange,\n      xScaleInteraction,\n    };\n  }, [\n    fields.segment,\n    fields.color,\n    fields.x.sorting,\n    fields.x.useAbbreviations,\n    xDimension,\n    xFilter,\n    sumsByX,\n    getX,\n    getXLabel,\n    getXAsDate,\n    scalesData,\n    timeRangeData,\n    segmentsByAbbreviationOrLabel,\n    segmentsByValue,\n    allSegments,\n  ]);\n\n  const animationIri = fields.animation?.componentId;\n  const getAnimation = useCallback(\n    (d: Observation) => {\n      return animationIri ? (d[animationIri] as string) : \"\";\n    },\n    [animationIri]\n  );\n\n  const yScale = useMemo(() => {\n    return getStackedYScale(scalesData, {\n      normalize,\n      getX,\n      getY,\n      getTime: getAnimation,\n      customDomain: y.customDomain,\n    });\n  }, [scalesData, normalize, getX, getY, getAnimation, y.customDomain]);\n\n  const paddingYScale = useMemo(() => {\n    //  When the user can toggle between absolute and relative values, we use the\n    // absolute values to calculate the yScale domain, so that the yScale doesn't\n    // change when the user toggles between absolute and relative values.\n    if (interactiveFiltersConfig.calculation.active) {\n      const scale = getStackedYScale(paddingData, {\n        normalize: false,\n        getX,\n        getY,\n        getTime: getAnimation,\n        customDomain: y.customDomain,\n      });\n\n      if (scale.domain()[1] < 100 && scale.domain()[0] > -100) {\n        return scaleLinear().domain([0, 100]);\n      }\n\n      return scale;\n    }\n\n    return getStackedYScale(paddingData, {\n      normalize,\n      getX,\n      getY,\n      getTime: getAnimation,\n      customDomain: y.customDomain,\n    });\n  }, [\n    interactiveFiltersConfig.calculation.active,\n    paddingData,\n    normalize,\n    getX,\n    getY,\n    getAnimation,\n    y.customDomain,\n  ]);\n\n  // stack order\n  const series = useMemo(() => {\n    const sorting = fields.segment?.sorting;\n    const sortingType = sorting?.sortingType;\n    const sortingOrder = sorting?.sortingOrder;\n    const stackOrder =\n      sortingType === \"byTotalSize\"\n        ? sortingOrder === \"asc\"\n          ? stackOrderAscending\n          : stackOrderDescending\n        : // Reverse segments here, so they're sorted from top to bottom\n          stackOrderReverse;\n\n    const stacked = stack()\n      .order(stackOrder)\n      .offset(stackOffsetDiverging)\n      .keys(segments);\n\n    return stacked(chartWideData as { [key: string]: number }[]);\n  }, [chartWideData, fields.segment?.sorting, segments]);\n\n  /** Chart dimensions */\n  const { top, left, bottom } = useChartPadding({\n    xLabelPresent: !!xAxisLabel,\n    yScale: paddingYScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    bandDomain: xTimeRangeDomainLabels.every((d) => d === undefined)\n      ? xScale.domain()\n      : xTimeRangeDomainLabels,\n    normalize,\n  });\n  const right = 40;\n  const leftAxisLabelSize = useAxisLabelSizeVariables({\n    label: yAxisLabel,\n    width,\n  });\n  const bottomAxisLabelSize = useAxisLabelSizeVariables({\n    label: xAxisLabel,\n    width,\n  });\n  const margins = {\n    top: DEFAULT_MARGIN_TOP + top + leftAxisLabelSize.offset,\n    right,\n    bottom,\n    left,\n  };\n  const chartWidth = getChartWidth({ width, left, right });\n  const bounds = useChartBounds({ width, chartWidth, height, margins });\n  const { chartHeight } = bounds;\n\n  xScale.range([0, chartWidth]);\n  xScaleInteraction.range([0, chartWidth]);\n  xScaleTimeRange.range([0, chartWidth]);\n  yScale.range([chartHeight, 0]);\n\n  const isMobile = useIsMobile();\n\n  const formatXAxisTick = useCallback(\n    (tick: string) => {\n      return isTemporalDimension(xDimension)\n        ? formatXDate(tick)\n        : getXLabel(tick);\n    },\n    [xDimension, formatXDate, getXLabel]\n  );\n\n  const getAnnotationInfo: GetAnnotationInfo = useCallback(\n    (observation, { segment, focusingSegment }) => {\n      const x = getX(observation);\n      let y: number;\n      let color: string | undefined;\n\n      if (focusingSegment) {\n        y = getStackedPosition({\n          observation,\n          series,\n          key: xKey,\n          getAxisValue: getX,\n          measureScale: yScale,\n          fallbackMeasureValue: yScale(getY(observation) ?? 0),\n          segment,\n        });\n        color = colors(segment);\n      } else {\n        const values = chartDataGroupedByX.get(x) ?? [];\n        const yValues = values.map(getY);\n        y =\n          yScale(sum(yValues.map((d) => d ?? 0))) -\n          ANNOTATION_SINGLE_SEGMENT_OFFSET;\n      }\n\n      return {\n        x: (xScale(x) as number) + xScale.bandwidth() * 0.5,\n        y,\n        color,\n      };\n    },\n    [chartDataGroupedByX, colors, getX, getY, series, xKey, xScale, yScale]\n  );\n\n  const getTooltipInfo = useCallback(\n    (datum: Observation): TooltipInfo => {\n      const bw = xScale.bandwidth();\n      const x = getX(datum);\n\n      const tooltipValues = chartDataGroupedByX.get(x) ?? [];\n      const yValues = tooltipValues.map(getY);\n      const sortedTooltipValues = sortByIndex({\n        data: tooltipValues,\n        order: segments,\n        getCategory: getSegment,\n        sortingOrder: \"asc\",\n      });\n      const yValueFormatter = getStackedTooltipValueFormatter({\n        normalize,\n        measureId: yMeasure.id,\n        measureUnit: yMeasure.unit,\n        formatters,\n        formatNumber,\n      });\n\n      const xAnchorRaw = (xScale(x) as number) + bw * 0.5;\n      const yAnchor = isMobile\n        ? chartHeight\n        : yScale(sum(yValues.map((d) => d ?? 0)) * 0.5);\n      const placement = isMobile\n        ? MOBILE_TOOLTIP_PLACEMENT\n        : getCenteredTooltipPlacement({\n            chartWidth,\n            xAnchor: xAnchorRaw,\n            topAnchor: !fields.segment,\n          });\n      const xLabel = getXAbbreviationOrLabel(datum);\n\n      return {\n        xAnchor: xAnchorRaw + (placement.x === \"right\" ? 0.5 : -0.5) * bw,\n        yAnchor,\n        placement,\n        value: formatXAxisTick(xLabel),\n        datum: {\n          label: fields.segment && getSegmentAbbreviationOrLabel(datum),\n          value: yValueFormatter(getY(datum), getIdentityY(datum)),\n          color: colors(getSegment(datum)),\n        },\n        values: sortedTooltipValues.map((d) => {\n          const segment = getSegment(d);\n          const y = getStackedPosition({\n            observation: d,\n            series,\n            key: xKey,\n            getAxisValue: getX,\n            measureScale: yScale,\n            fallbackMeasureValue: yScale(getY(d) ?? 0),\n            segment,\n          });\n\n          return {\n            label: getSegmentAbbreviationOrLabel(d),\n            value: yValueFormatter(getY(d), getIdentityY(d)),\n            axis: \"y\",\n            axisOffset: y,\n            color: colors(segment),\n          } satisfies TooltipValue;\n        }),\n      };\n    },\n    [\n      xScale,\n      getX,\n      chartDataGroupedByX,\n      getY,\n      segments,\n      getSegment,\n      normalize,\n      yMeasure.id,\n      yMeasure.unit,\n      formatters,\n      formatNumber,\n      isMobile,\n      chartHeight,\n      yScale,\n      chartWidth,\n      fields.segment,\n      getXAbbreviationOrLabel,\n      formatXAxisTick,\n      getSegmentAbbreviationOrLabel,\n      getIdentityY,\n      colors,\n      series,\n      xKey,\n    ]\n  );\n\n  const valueLabelFormatter = useValueLabelFormatter({\n    measureId: yMeasure.id,\n    dimensions,\n    measures,\n    normalize,\n  });\n\n  return {\n    chartType: \"column\",\n    chartDataGroupedByX,\n    bounds,\n    chartData,\n    allData,\n    xScale,\n    xScaleInteraction,\n    xScaleTimeRange,\n    yScale,\n    segments,\n    colors,\n    getColorLabel: getSegmentLabel,\n    chartWideData,\n    series,\n    getAnnotationInfo,\n    getTooltipInfo,\n    leftAxisLabelSize,\n    leftAxisLabelOffsetTop: top,\n    bottomAxisLabelSize,\n    valueLabelFormatter,\n    formatXAxisTick: formatXAxisTick,\n    ...variables,\n  };\n};\n\nconst StackedColumnsChartProvider = (\n  props: PropsWithChildren<ChartProps<ColumnConfig>>\n) => {\n  const { children, ...chartProps } = props;\n  const variables = useColumnsStackedStateVariables(chartProps);\n  const data = useColumnsStackedStateData(chartProps, variables);\n  const state = useColumnsStackedState(chartProps, variables, data);\n\n  return (\n    <ChartContext.Provider value={state}>{children}</ChartContext.Provider>\n  );\n};\n\nexport const StackedColumnsChart = (\n  props: PropsWithChildren<ChartProps<ColumnConfig>>\n) => {\n  return (\n    <InteractionProvider>\n      <StackedColumnsChartProvider {...props} />\n    </InteractionProvider>\n  );\n};\n","import { ascending, descending } from \"d3-array\";\nimport { useCallback } from \"react\";\n\nimport { usePlottableData } from \"@/charts/shared/chart-helpers\";\nimport {\n  BandXVariables,\n  BaseVariables,\n  ChartStateData,\n  InteractiveFiltersVariables,\n  LimitsVariables,\n  NumericalYErrorVariables,\n  NumericalYVariables,\n  RenderingVariables,\n  SegmentVariables,\n  SortingVariables,\n  useBandXVariables,\n  useBaseVariables,\n  useChartData,\n  useInteractiveFiltersVariables,\n  useLimitsVariables,\n  useNumericalYErrorVariables,\n  useNumericalYVariables,\n  useSegmentVariables,\n} from \"@/charts/shared/chart-state\";\nimport { useRenderingKeyVariable } from \"@/charts/shared/rendering-utils\";\nimport { useChartConfigFilters, useLimits } from \"@/config-utils\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalEntityDimension } from \"@/domain/data\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type ColumnsStateVariables = BaseVariables &\n  SortingVariables &\n  BandXVariables &\n  NumericalYVariables &\n  NumericalYErrorVariables &\n  SegmentVariables &\n  RenderingVariables &\n  InteractiveFiltersVariables &\n  LimitsVariables;\n\nexport const useColumnsStateVariables = (\n  props: ChartProps<ColumnConfig> & { limits: ReturnType<typeof useLimits> }\n): ColumnsStateVariables => {\n  const {\n    chartConfig,\n    observations,\n    dimensions,\n    dimensionsById,\n    measures,\n    measuresById,\n    limits,\n  } = props;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { x, y, animation } = fields;\n  const xDimension = dimensionsById[x.componentId];\n  const filters = useChartConfigFilters(chartConfig);\n\n  const baseVariables = useBaseVariables(chartConfig);\n  const bandXVariables = useBandXVariables(x, {\n    dimensionsById,\n    observations,\n  });\n  const numericalYVariables = useNumericalYVariables(\"column\", y, {\n    measuresById,\n  });\n  const numericalYErrorVariables = useNumericalYErrorVariables(y, {\n    getValue: numericalYVariables.getY,\n    dimensions,\n    measures,\n  });\n  const segmentVariables = useSegmentVariables(undefined, {\n    dimensionsById,\n    observations,\n  });\n  const interactiveFiltersVariables = useInteractiveFiltersVariables(\n    interactiveFiltersConfig,\n    { dimensionsById }\n  );\n  const limitsVariables = useLimitsVariables(limits);\n\n  const { getX, getXAsDate } = bandXVariables;\n  const { getY } = numericalYVariables;\n  const sortData: ColumnsStateVariables[\"sortData\"] = useCallback(\n    (data) => {\n      const { sortingOrder, sortingType } = x.sorting ?? {};\n      const xGetter = isTemporalEntityDimension(xDimension) ? getXAsDate : getX;\n      if (sortingOrder === \"desc\" && sortingType === \"byDimensionLabel\") {\n        return [...data].sort((a, b) => descending(xGetter(a), xGetter(b)));\n      } else if (sortingOrder === \"asc\" && sortingType === \"byDimensionLabel\") {\n        return [...data].sort((a, b) => ascending(xGetter(a), xGetter(b)));\n      } else if (sortingOrder === \"desc\" && sortingType === \"byMeasure\") {\n        return [...data].sort((a, b) =>\n          descending(getY(a) ?? -1, getY(b) ?? -1)\n        );\n      } else if (sortingOrder === \"asc\" && sortingType === \"byMeasure\") {\n        return [...data].sort((a, b) =>\n          ascending(getY(a) ?? -1, getY(b) ?? -1)\n        );\n      } else {\n        return [...data].sort((a, b) => ascending(xGetter(a), xGetter(b)));\n      }\n    },\n    [getX, getXAsDate, getY, x.sorting, xDimension]\n  );\n\n  const getRenderingKey = useRenderingKeyVariable(\n    dimensions,\n    filters,\n    animation\n  );\n\n  return {\n    ...baseVariables,\n    sortData,\n    ...bandXVariables,\n    ...numericalYVariables,\n    ...numericalYErrorVariables,\n    ...segmentVariables,\n    ...interactiveFiltersVariables,\n    ...limitsVariables,\n    getRenderingKey,\n  };\n};\n\nexport const useColumnsStateData = (\n  chartProps: ChartProps<ColumnConfig> & {\n    limits: ReturnType<typeof useLimits>;\n  },\n  variables: ColumnsStateVariables\n): ChartStateData => {\n  const { chartConfig, observations } = chartProps;\n  const { sortData, xDimension, getXAsDate, getY, getTimeRangeDate } =\n    variables;\n  const plottableData = usePlottableData(observations, {\n    getY,\n  });\n\n  return useChartData(plottableData, {\n    sortData,\n    chartConfig,\n    timeRangeDimensionId: xDimension.id,\n    getAxisValueAsDate: getXAsDate,\n    getTimeRangeDate,\n  });\n};\n","import { extent, max, rollup, sum } from \"d3-array\";\nimport {\n  ScaleBand,\n  scaleBand,\n  ScaleLinear,\n  scaleLinear,\n  ScaleOrdinal,\n  scaleOrdinal,\n  scaleTime,\n} from \"d3-scale\";\nimport orderBy from \"lodash/orderBy\";\nimport { PropsWithChildren, useCallback, useMemo } from \"react\";\n\nimport {\n  ColumnsStateVariables,\n  useColumnsStateData,\n  useColumnsStateVariables,\n} from \"@/charts/column/columns-state-props\";\nimport { PADDING_INNER, PADDING_OUTER } from \"@/charts/column/constants\";\nimport { DEFAULT_ANNOTATION_CIRCLE_COLOR } from \"@/charts/shared/annotation-circle\";\nimport {\n  ANNOTATION_SINGLE_SEGMENT_OFFSET,\n  GetAnnotationInfo,\n} from \"@/charts/shared/annotations\";\nimport {\n  AxisLabelSizeVariables,\n  getChartWidth,\n  useAxisLabelSizeVariables,\n  useChartBounds,\n  useChartPadding,\n} from \"@/charts/shared/chart-dimensions\";\nimport {\n  ChartContext,\n  ChartStateData,\n  CommonChartState,\n  InteractiveXTimeRangeState,\n} from \"@/charts/shared/chart-state\";\nimport { TooltipInfo } from \"@/charts/shared/interaction/tooltip\";\nimport {\n  getCenteredTooltipPlacement,\n  MOBILE_TOOLTIP_PLACEMENT,\n} from \"@/charts/shared/interaction/tooltip-box\";\nimport { DEFAULT_MARGIN_TOP } from \"@/charts/shared/margins\";\nimport {\n  ShowBandValueLabelsVariables,\n  useShowBandValueLabelsVariables,\n} from \"@/charts/shared/show-values-utils\";\nimport { useChartFormatters } from \"@/charts/shared/use-chart-formatters\";\nimport { InteractionProvider } from \"@/charts/shared/use-interaction\";\nimport { useSize } from \"@/charts/shared/use-size\";\nimport { useLimits } from \"@/config-utils\";\nimport { ColumnConfig } from \"@/configurator\";\nimport { isTemporalDimension, Observation } from \"@/domain/data\";\nimport { formatNumberWithUnit, useFormatNumber } from \"@/formatters\";\nimport { getPalette } from \"@/palettes\";\nimport {\n  getSortingOrders,\n  makeDimensionValueSorters,\n} from \"@/utils/sorting-values\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type ColumnsState = CommonChartState &\n  ColumnsStateVariables &\n  InteractiveXTimeRangeState &\n  Omit<ShowBandValueLabelsVariables, \"offset\"> & {\n    chartType: \"column\";\n    xScale: ScaleBand<string>;\n    xScaleInteraction: ScaleBand<string>;\n    yScale: ScaleLinear<number, number>;\n    segments: string[];\n    colors: ScaleOrdinal<string, string>;\n    getColorLabel: (segment: string) => string;\n    getAnnotationInfo: GetAnnotationInfo;\n    getTooltipInfo: (d: Observation) => TooltipInfo;\n    leftAxisLabelSize: AxisLabelSizeVariables;\n    leftAxisLabelOffsetTop: number;\n    bottomAxisLabelSize: AxisLabelSizeVariables;\n    formatXAxisTick?: (d: string) => string;\n  };\n\nconst useColumnsState = (\n  chartProps: ChartProps<ColumnConfig>,\n  variables: ColumnsStateVariables,\n  data: ChartStateData\n): ColumnsState => {\n  const { chartConfig, dimensions, measures } = chartProps;\n  const {\n    xDimension,\n    getX,\n    getXAsDate,\n    getXAbbreviationOrLabel,\n    getXLabel,\n    formatXDate,\n    yMeasure,\n    getY,\n    getMinY,\n    getYErrorRange,\n    getFormattedYUncertainty,\n    getSegmentLabel,\n    xAxisLabel,\n    yAxisLabel,\n    minLimitValue,\n    maxLimitValue,\n  } = variables;\n  const { chartData, scalesData, timeRangeData, paddingData, allData } = data;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { y } = fields;\n\n  const { width, height } = useSize();\n  const formatNumber = useFormatNumber({ decimals: \"auto\" });\n  const formatters = useChartFormatters(chartProps);\n\n  const sumsByX = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        chartData,\n        (v) => sum(v, (x) => getY(x)),\n        (x) => getX(x)\n      )\n    );\n  }, [chartData, getX, getY]);\n\n  const {\n    segments,\n    xScale,\n    colors,\n    yScale,\n    paddingYScale,\n    xScaleTimeRange,\n    xScaleInteraction,\n    xTimeRangeDomainLabels,\n  } = useMemo(() => {\n    const segments: string[] = [];\n    const colors = scaleOrdinal<string, string>();\n\n    if (fields.color.type === \"single\") {\n      colors.range(\n        getPalette({\n          paletteId: fields.color.paletteId,\n          colorField: fields.color,\n        })\n      );\n    }\n\n    const sorters = makeDimensionValueSorters(xDimension, {\n      sorting: fields.x.sorting,\n      measureBySegment: sumsByX,\n      useAbbreviations: fields.x.useAbbreviations,\n      dimensionFilter: xDimension?.id\n        ? chartConfig.cubes.find((d) => d.iri === xDimension.cubeIri)?.filters[\n            xDimension.id\n          ]\n        : undefined,\n    });\n    const sortingOrders = getSortingOrders(sorters, fields.x.sorting);\n    const bandDomain = orderBy(\n      [...new Set(scalesData.map(getX))],\n      sorters,\n      sortingOrders\n    );\n    const xTimeRangeValues = [...new Set(timeRangeData.map(getX))];\n    const xTimeRangeDomainLabels = xTimeRangeValues.map(getXLabel);\n    const xScale = scaleBand()\n      .domain(bandDomain)\n      .paddingInner(PADDING_INNER)\n      .paddingOuter(PADDING_OUTER);\n    const xScaleInteraction = scaleBand()\n      .domain(bandDomain)\n      .paddingInner(0)\n      .paddingOuter(0);\n\n    const xScaleTimeRangeDomain = extent(timeRangeData, (d) =>\n      getXAsDate(d)\n    ) as [Date, Date];\n\n    const xScaleTimeRange = scaleTime().domain(xScaleTimeRangeDomain);\n\n    const yScale = scaleLinear();\n    const paddingYScale = scaleLinear();\n\n    if (y.customDomain) {\n      yScale.domain(y.customDomain);\n      paddingYScale.domain(y.customDomain);\n    } else {\n      const minValue = getMinY(scalesData, (d) => {\n        return getYErrorRange?.(d)[0] ?? getY(d);\n      });\n      const maxValue = Math.max(\n        max(scalesData, (d) => {\n          return getYErrorRange?.(d)[1] ?? getY(d);\n        }) ?? 0,\n        0\n      );\n      yScale\n        .domain([\n          minLimitValue !== undefined\n            ? Math.min(minValue, minLimitValue)\n            : minValue,\n          maxLimitValue !== undefined\n            ? Math.max(maxValue, maxLimitValue)\n            : maxValue,\n        ])\n        .nice();\n\n      const paddingMinValue = getMinY(paddingData, (d) => {\n        return getYErrorRange?.(d)[0] ?? getY(d);\n      });\n      const paddingMaxValue = Math.max(\n        max(paddingData, (d) => {\n          return getYErrorRange?.(d)[1] ?? getY(d);\n        }) ?? 0,\n        0\n      );\n      paddingYScale\n        .domain([\n          minLimitValue !== undefined\n            ? Math.min(paddingMinValue, minLimitValue)\n            : paddingMinValue,\n          maxLimitValue !== undefined\n            ? Math.max(paddingMaxValue, maxLimitValue)\n            : paddingMaxValue,\n        ])\n        .nice();\n    }\n\n    return {\n      segments,\n      colors,\n      xScale,\n      yScale,\n      paddingYScale,\n      xScaleTimeRange,\n      xScaleInteraction,\n      xTimeRangeDomainLabels,\n    };\n  }, [\n    fields.color,\n    fields.x.sorting,\n    fields.x.useAbbreviations,\n    xDimension,\n    sumsByX,\n    chartConfig.cubes,\n    scalesData,\n    getX,\n    timeRangeData,\n    getXLabel,\n    getMinY,\n    minLimitValue,\n    maxLimitValue,\n    paddingData,\n    getXAsDate,\n    getYErrorRange,\n    getY,\n    y.customDomain,\n  ]);\n\n  const { top, left, bottom } = useChartPadding({\n    xLabelPresent: !!xAxisLabel,\n    yScale: paddingYScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    bandDomain: xTimeRangeDomainLabels.every((d) => d === undefined)\n      ? xScale.domain()\n      : xTimeRangeDomainLabels,\n  });\n  const right = 40;\n\n  const chartWidth = getChartWidth({ width, left, right });\n  xScale.range([0, chartWidth]);\n  xScaleInteraction.range([0, chartWidth]);\n  xScaleTimeRange.range([0, chartWidth]);\n\n  const leftAxisLabelSize = useAxisLabelSizeVariables({\n    label: yAxisLabel,\n    width,\n  });\n  const bottomAxisLabelSize = useAxisLabelSizeVariables({\n    label: xAxisLabel,\n    width,\n  });\n  const { offset: yValueLabelsOffset, ...showValuesVariables } =\n    useShowBandValueLabelsVariables(y, {\n      chartData,\n      dimensions,\n      measures,\n      getValue: getY,\n      getErrorRange: getYErrorRange,\n      scale: yScale,\n      bandwidth: xScale.bandwidth(),\n    });\n  const margins = {\n    top:\n      DEFAULT_MARGIN_TOP + top + leftAxisLabelSize.offset + yValueLabelsOffset,\n    right,\n    bottom,\n    left,\n  };\n  const bounds = useChartBounds({ width, height, chartWidth, margins });\n  const { chartHeight } = bounds;\n  yScale.range([chartHeight, 0]);\n  const isMobile = useIsMobile();\n\n  const formatXAxisTick = useCallback(\n    (tick: string) => {\n      return isTemporalDimension(xDimension)\n        ? formatXDate(tick)\n        : getXLabel(tick);\n    },\n    [xDimension, formatXDate, getXLabel]\n  );\n\n  const getAnnotationInfo: GetAnnotationInfo = useCallback(\n    (observation) => {\n      const x =\n        (xScale(getX(observation)) as number) + xScale.bandwidth() * 0.5;\n      const hasValueLabels = showValuesVariables.showValues;\n      const yOffset = hasValueLabels ? yValueLabelsOffset + 8 : 0;\n      const y =\n        yScale(Math.max(getY(observation) ?? NaN, 0)) -\n        ANNOTATION_SINGLE_SEGMENT_OFFSET -\n        yOffset;\n\n      return {\n        x,\n        y,\n        color: DEFAULT_ANNOTATION_CIRCLE_COLOR,\n      };\n    },\n    [\n      xScale,\n      getX,\n      showValuesVariables.showValues,\n      yValueLabelsOffset,\n      yScale,\n      getY,\n    ]\n  );\n\n  const getTooltipInfo = (datum: Observation): TooltipInfo => {\n    const xAnchor = (xScale(getX(datum)) as number) + xScale.bandwidth() * 0.5;\n    const yAnchor = isMobile\n      ? chartHeight\n      : yScale(Math.max(getY(datum) ?? NaN, 0));\n    const placement = isMobile\n      ? MOBILE_TOOLTIP_PLACEMENT\n      : getCenteredTooltipPlacement({\n          chartWidth,\n          xAnchor,\n          topAnchor: !fields.segment,\n        });\n    const xLabel = getXAbbreviationOrLabel(datum);\n    const y = getY(datum);\n    const yValueUnitFormatter = (value: number | null) =>\n      formatNumberWithUnit(\n        value,\n        formatters[yMeasure.id] ?? formatNumber,\n        yMeasure.unit\n      );\n\n    return {\n      xAnchor,\n      yAnchor,\n      placement,\n      value: formatXAxisTick(xLabel),\n      datum: {\n        label: undefined,\n        value:\n          y !== null && isNaN(y) ? \"-\" : `${yValueUnitFormatter(getY(datum))}`,\n        error: getFormattedYUncertainty(datum),\n        color: \"\",\n      },\n      values: undefined,\n    };\n  };\n\n  return {\n    colors,\n    getColorLabel: getSegmentLabel,\n    chartType: \"column\",\n    bounds,\n    chartData,\n    allData,\n    xScale,\n    xScaleTimeRange,\n    xScaleInteraction,\n    yScale,\n    segments,\n    getAnnotationInfo,\n    getTooltipInfo,\n    leftAxisLabelSize,\n    leftAxisLabelOffsetTop: top,\n    bottomAxisLabelSize,\n    formatXAxisTick,\n    ...showValuesVariables,\n    ...variables,\n  };\n};\n\nconst ColumnChartProvider = (\n  props: PropsWithChildren<\n    ChartProps<ColumnConfig> & { limits: ReturnType<typeof useLimits> }\n  >\n) => {\n  const { children, ...chartProps } = props;\n  const variables = useColumnsStateVariables(chartProps);\n  const data = useColumnsStateData(chartProps, variables);\n  const state = useColumnsState(chartProps, variables, data);\n\n  return (\n    <ChartContext.Provider value={state}>{children}</ChartContext.Provider>\n  );\n};\n\nexport const ColumnChart = (\n  props: PropsWithChildren<\n    ChartProps<ColumnConfig> & { limits: ReturnType<typeof useLimits> }\n  >\n) => {\n  return (\n    <InteractionProvider>\n      <ColumnChartProvider {...props} />\n    </InteractionProvider>\n  );\n};\n","import { useCallback, useMemo } from \"react\";\n\nimport { GroupedColumnsState } from \"@/charts/column/columns-grouped-state\";\nimport { StackedColumnsState } from \"@/charts/column/columns-stacked-state\";\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport { useGetRenderStackedColumnDatum } from \"@/charts/column/rendering-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { StackedAnnotationHighlight } from \"@/charts/shared/overlay-rects\";\nimport { useAnnotationInteractions } from \"@/charts/shared/use-annotation-interactions\";\nimport { Observation } from \"@/domain/data\";\n\nexport const InteractionColumns = ({\n  disableGaps = true,\n}: {\n  disableGaps?: boolean;\n}) => {\n  const chartState = useChartState() as\n    | ColumnsState\n    | StackedColumnsState\n    | GroupedColumnsState;\n  const {\n    chartData,\n    bounds: { chartHeight, margins },\n    getX,\n    xScale,\n    xScaleInteraction,\n  } = chartState;\n  const { onClick, onHover, onHoverOut } = useAnnotationInteractions({\n    focusingSegment: false,\n  });\n  const scale = disableGaps ? xScaleInteraction : xScale;\n  const bandwidth = scale.bandwidth();\n\n  return (\n    <g transform={`translate(${margins.left} ${margins.top})`}>\n      {chartData.map((d, i) => {\n        const x = getX(d);\n        const xScaled = scale(x) as number;\n\n        return (\n          <rect\n            key={i}\n            x={xScaled}\n            y={0}\n            width={bandwidth}\n            height={Math.max(0, chartHeight)}\n            fill=\"hotpink\"\n            fillOpacity={0}\n            stroke=\"none\"\n            onMouseOver={() => onHover(d, { segment: undefined })}\n            onMouseOut={onHoverOut}\n            onClick={() => onClick(d, { segment: undefined })}\n          />\n        );\n      })}\n    </g>\n  );\n};\n\nexport const InteractionColumnsStacked = () => {\n  const {\n    bounds: { height, margins },\n    series,\n  } = useChartState() as StackedColumnsState;\n  const { onClick, onHover, onHoverOut } = useAnnotationInteractions({\n    focusingSegment: true,\n  });\n  const getRenderDatum = useGetRenderStackedColumnDatum();\n  const renderData = useMemo(() => {\n    return series.flatMap(getRenderDatum);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    getRenderDatum,\n    series,\n    // We need to reset the yRange on height change.\n    height,\n  ]);\n\n  return (\n    <g transform={`translate(${margins.left} ${margins.top})`}>\n      {renderData.map((d) => {\n        return (\n          <rect\n            key={d.key}\n            x={d.x}\n            y={d.y}\n            width={d.width}\n            height={d.height}\n            fill=\"hotpink\"\n            fillOpacity={0}\n            stroke=\"none\"\n            onMouseOver={() => onHover(d.observation, { segment: d.segment })}\n            onMouseOut={onHoverOut}\n            onClick={() => onClick(d.observation, { segment: d.segment })}\n          />\n        );\n      })}\n    </g>\n  );\n};\n\nexport const StackedColumnAnnotationHighlight = () => {\n  const {\n    bounds,\n    getY,\n    getX,\n    yScale,\n    xScale,\n    chartDataGroupedByX,\n    xDimension,\n  } = useChartState() as StackedColumnsState;\n  const getValue = useCallback(\n    (d: Observation) => {\n      return getY(d) ?? 0;\n    },\n    [getY]\n  );\n\n  return (\n    <StackedAnnotationHighlight\n      bounds={bounds}\n      getValue={getValue}\n      getAxisValue={getX}\n      valueScale={yScale}\n      axisScale={xScale}\n      chartDataGrouped={chartDataGroupedByX}\n      dimension={xDimension}\n      isHorizontal={false}\n    />\n  );\n};\n","import { memo } from \"react\";\n\nimport { ChartDataWrapper } from \"@/charts/chart-data-wrapper\";\nimport { Columns, ErrorWhiskers } from \"@/charts/column/columns\";\nimport {\n  ColumnsGrouped,\n  ErrorWhiskers as ErrorWhiskersGrouped,\n} from \"@/charts/column/columns-grouped\";\nimport { GroupedColumnChart } from \"@/charts/column/columns-grouped-state\";\nimport { ColumnsStacked } from \"@/charts/column/columns-stacked\";\nimport { StackedColumnsChart } from \"@/charts/column/columns-stacked-state\";\nimport { ColumnChart } from \"@/charts/column/columns-state\";\nimport {\n  InteractionColumns,\n  InteractionColumnsStacked,\n  StackedColumnAnnotationHighlight,\n} from \"@/charts/column/overlay-columns\";\nimport { useIsEditingAnnotation } from \"@/charts/shared/annotation-utils\";\nimport { Annotations } from \"@/charts/shared/annotations\";\nimport { AxisHeightLinear } from \"@/charts/shared/axis-height-linear\";\nimport { AxisHideXOverflowRect } from \"@/charts/shared/axis-hide-overflow-rect\";\nimport {\n  AxisWidthBand,\n  AxisWidthBandDomain,\n} from \"@/charts/shared/axis-width-band\";\nimport { BrushTime, shouldShowBrush } from \"@/charts/shared/brush\";\nimport {\n  ChartContainer,\n  ChartControlsContainer,\n  ChartSvg,\n} from \"@/charts/shared/containers\";\nimport { HoverAnnotationDot } from \"@/charts/shared/interaction/hover-annotation-dot\";\nimport { Tooltip } from \"@/charts/shared/interaction/tooltip\";\nimport { LegendColor } from \"@/charts/shared/legend-color\";\nimport { VerticalLimits } from \"@/charts/shared/limits/vertical\";\nimport { ColumnConfig } from \"@/config-types\";\nimport { useChartConfigFilters, useLimits } from \"@/config-utils\";\nimport { hasChartConfigs } from \"@/configurator\";\nimport { useConfiguratorState } from \"@/configurator/configurator-state\";\nimport { TimeSlider } from \"@/configurator/interactive-filters/time-slider\";\n\nimport { ChartProps, VisualizationProps } from \"../shared/chart-props\";\n\nexport const ChartColumnsVisualization = (\n  props: VisualizationProps<ColumnConfig>\n) => {\n  return <ChartDataWrapper {...props} Component={ChartColumns} />;\n};\n\nconst ChartColumns = memo((props: ChartProps<ColumnConfig>) => {\n  const { chartConfig, dimensions, measures, dimensionsById } = props;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const filters = useChartConfigFilters(chartConfig);\n  const [{ dashboardFilters }] = useConfiguratorState(hasChartConfigs);\n  const showTimeBrush = shouldShowBrush(\n    interactiveFiltersConfig,\n    dashboardFilters?.timeRange\n  );\n  const limits = useLimits({\n    chartConfig,\n    dimensions,\n    measures,\n  });\n  const isEditingAnnotation = useIsEditingAnnotation();\n\n  return (\n    <>\n      {fields.segment?.componentId && fields.segment.type === \"stacked\" ? (\n        <StackedColumnsChart {...props}>\n          <ChartContainer>\n            <ChartSvg>\n              <AxisHeightLinear />\n              <AxisHideXOverflowRect />\n              <AxisWidthBand />\n              <AxisWidthBandDomain />\n              <ColumnsStacked />\n              {isEditingAnnotation ? (\n                <>\n                  <InteractionColumns disableGaps={false} />\n                  <InteractionColumnsStacked />\n                  <StackedColumnAnnotationHighlight />\n                </>\n              ) : (\n                <InteractionColumns />\n              )}\n              {showTimeBrush && <BrushTime />}\n            </ChartSvg>\n            {isEditingAnnotation ? (\n              <HoverAnnotationDot />\n            ) : (\n              <Tooltip type=\"multiple\" />\n            )}\n          </ChartContainer>\n          <Annotations />\n          <ChartControlsContainer>\n            {fields.animation && (\n              <TimeSlider\n                filters={filters}\n                dimensions={dimensions}\n                {...fields.animation}\n              />\n            )}\n            <LegendColor\n              dimensionsById={dimensionsById}\n              chartConfig={chartConfig}\n              symbol=\"square\"\n              interactive={interactiveFiltersConfig.legend.active}\n              showTitle={fields.segment.showTitle}\n            />\n          </ChartControlsContainer>\n        </StackedColumnsChart>\n      ) : fields.segment?.componentId && fields.segment.type === \"grouped\" ? (\n        <GroupedColumnChart {...props}>\n          <ChartContainer>\n            <ChartSvg>\n              <AxisHeightLinear />\n              <AxisHideXOverflowRect />\n              <AxisWidthBand />\n              <AxisWidthBandDomain />\n              <ColumnsGrouped />\n              <ErrorWhiskersGrouped />\n              <InteractionColumns />\n              {showTimeBrush && <BrushTime />}\n            </ChartSvg>\n            <Tooltip type=\"multiple\" />\n          </ChartContainer>\n          <ChartControlsContainer>\n            {fields.animation && (\n              <TimeSlider\n                filters={filters}\n                dimensions={dimensions}\n                {...fields.animation}\n              />\n            )}\n            <LegendColor\n              dimensionsById={dimensionsById}\n              chartConfig={chartConfig}\n              symbol=\"square\"\n              interactive={interactiveFiltersConfig.legend.active}\n              showTitle={fields.segment.showTitle}\n            />\n          </ChartControlsContainer>\n        </GroupedColumnChart>\n      ) : (\n        <ColumnChart {...props} limits={limits}>\n          <ChartContainer>\n            <ChartSvg>\n              <AxisHeightLinear />\n              <AxisHideXOverflowRect />\n              <AxisWidthBand />\n              <AxisWidthBandDomain />\n              <Columns />\n              <ErrorWhiskers />\n              <VerticalLimits {...limits} />\n              <InteractionColumns />\n              {showTimeBrush && <BrushTime />}\n            </ChartSvg>\n            {isEditingAnnotation ? (\n              <HoverAnnotationDot />\n            ) : (\n              <Tooltip type=\"single\" />\n            )}\n          </ChartContainer>\n          <Annotations />\n          {fields.animation || limits.limits.length > 0 ? (\n            <ChartControlsContainer>\n              {limits.limits.length > 0 && (\n                <LegendColor\n                  limits={limits}\n                  dimensionsById={dimensionsById}\n                  chartConfig={chartConfig}\n                  symbol=\"square\"\n                />\n              )}\n              {fields.animation && (\n                <TimeSlider\n                  filters={filters}\n                  dimensions={dimensions}\n                  {...fields.animation}\n                />\n              )}\n            </ChartControlsContainer>\n          ) : null}\n        </ColumnChart>\n      )}\n    </>\n  );\n});\n","export const PADDING_OUTER = 0;\nexport const PADDING_INNER = 0.1;\nexport const PADDING_WITHIN = 0.1;\n","import { getContrastingColor } from \"@uiw/react-color\";\nimport { select, Selection } from \"d3-selection\";\nimport { Series } from \"d3-shape\";\nimport { useCallback } from \"react\";\n\nimport { StackedColumnsState } from \"@/charts/column/columns-stacked-state\";\nimport { hasSegmentAnnotation } from \"@/charts/shared/annotation-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  setSegmentValueLabelProps,\n  setSegmentWrapperValueLabelProps,\n} from \"@/charts/shared/render-value-labels\";\nimport {\n  maybeTransition,\n  RenderOptions,\n  toggleFocusBorder,\n} from \"@/charts/shared/rendering-utils\";\nimport { getChartConfig, useDefinitiveFilters } from \"@/config-utils\";\nimport { useConfiguratorState } from \"@/configurator/configurator-state\";\nimport { Observation } from \"@/domain/data\";\n\nexport type RenderColumnDatum = {\n  key: string;\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  color: string;\n  focused?: boolean;\n  valueLabel?: string;\n  valueLabelColor?: string;\n  segment?: string;\n  observation: Observation;\n  valueLabelOffset?: number;\n};\n\nexport const useGetRenderStackedColumnDatum = () => {\n  const {\n    colors,\n    showValuesBySegmentMapping,\n    valueLabelFormatter,\n    xScale,\n    yScale,\n    getX,\n    getRenderingKey,\n  } = useChartState() as StackedColumnsState;\n  const [state] = useConfiguratorState();\n  const chartConfig = getChartConfig(state);\n  const definitiveFilters = useDefinitiveFilters();\n  const bandwidth = xScale.bandwidth();\n\n  return useCallback(\n    (s: Series<{ [key: string]: number }, string>) => {\n      const segment = s.key;\n      const color = colors(segment);\n\n      return s.map((d) => {\n        const observation = d.data;\n        const value = observation[segment];\n        const valueLabel =\n          segment && showValuesBySegmentMapping[segment]\n            ? valueLabelFormatter(value)\n            : undefined;\n        const valueLabelColor = valueLabel\n          ? getContrastingColor(color)\n          : undefined;\n        const xRaw = getX(observation);\n        const y = yScale(d[1]) as number;\n\n        const hasAnnotation = hasSegmentAnnotation(\n          observation,\n          segment,\n          chartConfig,\n          definitiveFilters\n        );\n\n        const valueLabelOffset = hasAnnotation ? 20 : 0;\n\n        return {\n          key: getRenderingKey(observation, segment),\n          x: xScale(xRaw) as number,\n          y,\n          width: bandwidth,\n          height: Math.max(0, yScale(d[0]) - y),\n          color,\n          valueLabel,\n          valueLabelColor,\n          observation,\n          segment,\n          valueLabelOffset,\n        } satisfies RenderColumnDatum;\n      });\n    },\n    [\n      bandwidth,\n      colors,\n      getRenderingKey,\n      getX,\n      showValuesBySegmentMapping,\n      valueLabelFormatter,\n      xScale,\n      yScale,\n      chartConfig,\n      definitiveFilters,\n    ]\n  );\n};\n\nexport const renderColumns = (\n  g: Selection<SVGGElement, null, SVGGElement, unknown>,\n  data: RenderColumnDatum[],\n  options: RenderOptions & { y0: number }\n) => {\n  const { transition, y0 } = options;\n\n  g.selectAll<SVGGElement, RenderColumnDatum>(\"g.column\")\n    .data(data, (d) => d.key)\n    .join(\n      (enter) =>\n        enter\n          .append(\"g\")\n          .attr(\"class\", \"column\")\n          .call((g) =>\n            g\n              .append(\"rect\")\n              .attr(\"data-index\", (_, i) => i)\n              .attr(\"x\", (d) => d.x)\n              .attr(\"y\", y0)\n              .attr(\"width\", (d) => d.width)\n              .attr(\"height\", 0)\n              .attr(\"fill\", (d) => d.color)\n              .call((enter) =>\n                maybeTransition(enter, {\n                  transition,\n                  s: (g) =>\n                    g.attr(\"y\", (d) => d.y).attr(\"height\", (d) => d.height),\n                })\n              )\n          )\n          .call((g) =>\n            g\n              .append(\"foreignObject\")\n              .attr(\"x\", (d) => d.x)\n              .attr(\"y\", y0)\n              .attr(\"width\", (d) => d.width)\n              .attr(\"height\", (d) => d.height)\n              .call((g) =>\n                maybeTransition(g, {\n                  transition,\n                  s: (g) => g.attr(\"y\", (d) => d.y + (d.valueLabelOffset ?? 0)),\n                })\n              )\n              .append(\"xhtml:div\")\n              .call(setSegmentWrapperValueLabelProps)\n              .append(\"xhtml:p\")\n              .call(setSegmentValueLabelProps)\n              .style(\"color\", function (d) {\n                return d.valueLabelColor ?? select(this).style(\"color\");\n              })\n              .text((d) => d.valueLabel ?? \"\")\n          ),\n      (update) => {\n        toggleFocusBorder(update.select(\"rect\"));\n\n        return maybeTransition(update, {\n          s: (g) =>\n            g\n              .call((g) =>\n                g\n                  .select(\"rect\")\n                  .attr(\"x\", (d) => d.x)\n                  .attr(\"y\", (d) => d.y)\n                  .attr(\"width\", (d) => d.width)\n                  .attr(\"height\", (d) => d.height)\n                  .attr(\"fill\", (d) => d.color)\n              )\n              .call((g) =>\n                g\n                  .select(\"foreignObject\")\n                  .attr(\"x\", (d) => d.x)\n                  .attr(\"y\", (d) => d.y + (d.valueLabelOffset ?? 0))\n                  .attr(\"width\", (d) => d.width)\n                  .attr(\"height\", (d) => d.height)\n                  .select(\"p\")\n                  .style(\"color\", function (d) {\n                    return d.valueLabelColor ?? select(this).style(\"color\");\n                  })\n                  .text((d) => d.valueLabel ?? \"\")\n              ),\n          transition,\n        });\n      },\n      (exit) =>\n        maybeTransition(exit, {\n          transition,\n          s: (g) =>\n            g\n              .call((g) => g.select(\"rect\").attr(\"y\", y0).attr(\"height\", 0))\n              .remove(),\n        })\n    );\n};\n","import { axisBottom } from \"d3-axis\";\nimport { useEffect, useRef } from \"react\";\n\nimport { GroupedColumnsState } from \"@/charts/column/columns-grouped-state\";\nimport { StackedColumnsState } from \"@/charts/column/columns-stacked-state\";\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport { ComboLineColumnState } from \"@/charts/combo/combo-line-column-state\";\nimport { useXAxisTitleOffset } from \"@/charts/shared/chart-dimensions\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  maybeTransition,\n  renderContainer,\n} from \"@/charts/shared/rendering-utils\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { OpenMetadataPanelWrapper } from \"@/components/metadata-panel\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport const AxisWidthBand = () => {\n  const ref = useRef<SVGGElement>(null);\n  const {\n    xScale,\n    getXLabel,\n    xDimension,\n    xTimeUnit,\n    formatXDate,\n    yScale,\n    bounds: { chartHeight, chartWidth, margins },\n    xAxisLabel,\n    bottomAxisLabelSize,\n    formatXAxisTick,\n  } = useChartState() as\n    | ColumnsState\n    | StackedColumnsState\n    | GroupedColumnsState\n    | ComboLineColumnState;\n  const {\n    labelColor,\n    gridColor,\n    labelFontSize,\n    fontFamily,\n    axisLabelFontSize,\n    domainColor,\n  } = useChartTheme();\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const resolvedFontSize =\n    xScale.bandwidth() > labelFontSize ? labelFontSize : xScale.bandwidth();\n  const xAxisTitleOffset = useXAxisTitleOffset(\n    xScale,\n    getXLabel,\n    xTimeUnit,\n    resolvedFontSize\n  );\n\n  useEffect(() => {\n    if (ref.current) {\n      const rotation = true;\n      const hasNegativeValues = yScale.domain()[0] < 0;\n      const axis = axisBottom(xScale)\n        .tickSizeOuter(0)\n        .tickSizeInner(hasNegativeValues ? -chartHeight : 6)\n        .tickPadding(rotation ? -10 : 0)\n        .tickFormat(formatXAxisTick ?? ((tick) => tick));\n\n      const g = renderContainer(ref.current, {\n        id: \"axis-width-band\",\n        transform: `translate(${margins.left} ${chartHeight + margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g) => g.attr(\"data-testid\", \"axis-width-band\").call(axis),\n        renderUpdate: (g, opts) =>\n          maybeTransition(g, {\n            transition: opts.transition,\n            s: (g) => g.call(axis),\n          }),\n      });\n\n      g.select(\".domain\").remove();\n      g.selectAll(\".tick line\").attr(\n        \"stroke\",\n        hasNegativeValues ? gridColor : domainColor\n      );\n      g.selectAll(\".tick text\")\n        .attr(\"transform\", rotation ? \"rotate(90)\" : \"rotate(0)\")\n        .attr(\n          \"x\",\n          rotation\n            ? resolvedFontSize + (labelFontSize - resolvedFontSize) * 0.6\n            : 0\n        )\n        .attr(\n          \"dy\",\n          hasNegativeValues\n            ? resolvedFontSize + (labelFontSize - resolvedFontSize)\n            : 0.6 * resolvedFontSize + (labelFontSize - resolvedFontSize) * 0.4\n        )\n        .attr(\"font-size\", resolvedFontSize)\n        .attr(\"font-family\", fontFamily)\n        .attr(\"fill\", labelColor)\n        .attr(\"text-anchor\", rotation ? \"start\" : \"unset\");\n    }\n  }, [\n    chartHeight,\n    domainColor,\n    enableTransition,\n    fontFamily,\n    getXLabel,\n    gridColor,\n    labelColor,\n    labelFontSize,\n    margins.left,\n    margins.top,\n    transitionDuration,\n    xScale,\n    xTimeUnit,\n    yScale,\n    formatXDate,\n    formatXAxisTick,\n    resolvedFontSize,\n  ]);\n\n  return (\n    <>\n      <foreignObject\n        x={margins.left + chartWidth / 2 - bottomAxisLabelSize.width / 2}\n        y={margins.top + chartHeight + xAxisTitleOffset + 8}\n        width={chartWidth}\n        height={bottomAxisLabelSize.height}\n        style={{ display: \"flex\" }}\n      >\n        <OpenMetadataPanelWrapper component={xDimension}>\n          <span style={{ fontSize: axisLabelFontSize, lineHeight: 1.5 }}>\n            {xAxisLabel}\n          </span>\n        </OpenMetadataPanelWrapper>\n      </foreignObject>\n      <g ref={ref} />\n    </>\n  );\n};\n\nexport const AxisWidthBandDomain = () => {\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const { xScale, yScale, bounds } = useChartState() as ColumnsState;\n  const { chartHeight, margins } = bounds;\n  const { domainColor } = useChartTheme();\n\n  useEffect(() => {\n    if (ref.current) {\n      const axis = axisBottom(xScale).tickSizeOuter(0);\n      const g = renderContainer(ref.current, {\n        id: \"axis-width-band-domain\",\n        transform: `translate(${margins.left} ${chartHeight + margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g) => g.call(axis),\n        renderUpdate: (g, opts) =>\n          maybeTransition(g, {\n            transition: opts.transition,\n            s: (g) => g.call(axis),\n          }),\n      });\n\n      g.selectAll(\".tick line\").remove();\n      g.selectAll(\".tick text\").remove();\n      g.select(\".domain\")\n        .attr(\"transform\", `translate(0, -${bounds.chartHeight - yScale(0)})`)\n        .attr(\"stroke\", domainColor);\n    }\n  }, [\n    bounds.chartHeight,\n    chartHeight,\n    domainColor,\n    enableTransition,\n    margins.left,\n    margins.top,\n    transitionDuration,\n    xScale,\n    yScale,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { useMemo } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { createLimitsComponent } from \"@/charts/shared/limits/create-component\";\nimport { useLimits } from \"@/config-utils\";\n\nexport type VerticalChartState = AreasState | ColumnsState | LinesState;\n\nexport const VerticalLimits = (props: ReturnType<typeof useLimits>) => {\n  const chartState = useChartState() as VerticalChartState;\n  const LimitsComponent = useMemo(() => {\n    return createLimitsComponent({\n      isHorizontal: false,\n      getChartState: () => chartState,\n    });\n  }, [chartState]);\n\n  return <LimitsComponent {...props} />;\n};\nVerticalLimits.displayName = \"VerticalLimits\";\n","import { sum } from \"d3-array\";\nimport { ScaleBand, ScaleLinear } from \"d3-scale\";\nimport { useCallback, useMemo } from \"react\";\n\nimport { useGetAnnotationRenderState } from \"@/charts/shared/annotation-utils\";\nimport {\n  ANNOTATION_FOCUS_COLOR,\n  ANNOTATION_FOCUS_WIDTH,\n} from \"@/charts/shared/rendering-utils\";\nimport { useInteraction } from \"@/charts/shared/use-interaction\";\nimport { Observation } from \"@/domain/data\";\n\nconst OverlayHighlightRect = ({\n  x,\n  y,\n  width,\n  height,\n}: {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n}) => {\n  return (\n    <rect\n      x={x}\n      y={y}\n      width={width}\n      height={height}\n      fill=\"none\"\n      stroke={ANNOTATION_FOCUS_COLOR}\n      strokeWidth={ANNOTATION_FOCUS_WIDTH}\n      pointerEvents=\"none\"\n    />\n  );\n};\n\nexport const StackedAnnotationHighlight = ({\n  bounds,\n  getValue,\n  getAxisValue,\n  valueScale,\n  axisScale,\n  chartDataGrouped,\n  dimension,\n  isHorizontal,\n}: {\n  bounds: { width: number; margins: { left: number; top: number } };\n  getValue: (d: Observation) => number;\n  getAxisValue: (d: Observation) => string;\n  valueScale: ScaleLinear<number, number>;\n  axisScale: ScaleBand<string>;\n  chartDataGrouped: Map<string, Observation[]>;\n  dimension: { id: string };\n  isHorizontal: boolean;\n}) => {\n  const [interaction] = useInteraction();\n  const getAnnotationRenderState = useGetAnnotationRenderState();\n  const axisSize = axisScale.bandwidth();\n\n  const getHighlightRect = useCallback(\n    (axisKey: string) => {\n      const axisPosition = axisScale(axisKey) as number;\n      const values = chartDataGrouped.get(axisKey) ?? [];\n      const valueSum = sum(values, getValue) ?? 0;\n      const value0 = valueScale(0);\n      const value1 = valueScale(valueSum);\n      const valueSize = Math.abs(value1 - value0);\n\n      if (isHorizontal) {\n        return {\n          x: value0,\n          y: axisPosition,\n          width: valueSize,\n          height: axisSize,\n        };\n      } else {\n        return {\n          x: axisPosition,\n          y: value1,\n          width: axisSize,\n          height: valueSize,\n        };\n      }\n    },\n    [chartDataGrouped, getValue, valueScale, axisScale, axisSize, isHorizontal]\n  );\n\n  const highlightedRects = useMemo(() => {\n    bounds.width;\n\n    const rects: {\n      x: number;\n      y: number;\n      width: number;\n      height: number;\n    }[] = [];\n\n    if (\n      interaction.observation &&\n      interaction.type === \"annotation\" &&\n      interaction.visible &&\n      !interaction.focusingSegment\n    ) {\n      const axisValue = getAxisValue(interaction.observation);\n      const { focused } = getAnnotationRenderState(interaction.observation, {\n        axisComponentId: dimension.id,\n        axisValue,\n      });\n\n      if (focused) {\n        rects.push(getHighlightRect(axisValue));\n      }\n    }\n\n    for (const [axisValue, observations] of chartDataGrouped) {\n      const { focused, isActive } = getAnnotationRenderState(observations[0], {\n        axisComponentId: dimension.id,\n        axisValue,\n      });\n\n      if (\n        isActive ||\n        (focused &&\n          interaction.type === \"annotation\" &&\n          !interaction.focusingSegment)\n      ) {\n        rects.push(getHighlightRect(axisValue));\n      }\n    }\n\n    return rects;\n  }, [\n    bounds.width,\n    interaction,\n    getAxisValue,\n    getAnnotationRenderState,\n    dimension.id,\n    getHighlightRect,\n    chartDataGrouped,\n  ]);\n\n  if (highlightedRects.length === 0) {\n    return null;\n  }\n\n  return (\n    <g transform={`translate(${bounds.margins.left} ${bounds.margins.top})`}>\n      {highlightedRects.map((rect, i) => (\n        <OverlayHighlightRect\n          key={i}\n          x={rect.x}\n          y={rect.y}\n          width={rect.width}\n          height={rect.height}\n        />\n      ))}\n    </g>\n  );\n};\n","import { Box, Button, sliderClasses, Typography } from \"@mui/material\";\nimport { makeStyles } from \"@mui/styles\";\nimport clsx from \"clsx\";\nimport orderBy from \"lodash/orderBy\";\nimport {\n  ChangeEvent,\n  createContext,\n  useContext,\n  useEffect,\n  useMemo,\n} from \"react\";\nimport { useSyncExternalStore } from \"use-sync-external-store/shim\";\n\nimport { ChartState, useChartState } from \"@/charts/shared/chart-state\";\nimport { TableChartState } from \"@/charts/table/table-state\";\nimport { Slider as GenericSlider } from \"@/components/form\";\nimport { AnimationField, Filters, SortingField } from \"@/config-types\";\nimport { parseDate } from \"@/configurator/components/ui-helpers\";\nimport { hasChartConfigs } from \"@/configurator/configurator-state\";\nimport {\n  Dimension,\n  isTemporalDimension,\n  isTemporalEntityDimension,\n  isTemporalOrdinalDimension,\n} from \"@/domain/data\";\nimport { truthy } from \"@/domain/types\";\nimport { useTimeFormatUnit } from \"@/formatters\";\nimport { Icon } from \"@/icons\";\nimport { useConfiguratorState } from \"@/src\";\nimport { useChartInteractiveFilters } from \"@/stores/interactive-filters\";\nimport { Timeline, TimelineProps } from \"@/utils/observables\";\nimport {\n  getSortingOrders,\n  makeDimensionValueSorters,\n} from \"@/utils/sorting-values\";\nimport { useEvent } from \"@/utils/use-event\";\nimport { DISABLE_SCREENSHOT_ATTR } from \"@/utils/use-screenshot\";\n\nconst TimelineContext = createContext<Timeline | undefined>(undefined);\n\nconst useTimeline = () => {\n  const timeline = useContext(TimelineContext);\n\n  if (!timeline) {\n    throw Error(\n      \"useTimeline must be called inside a TimelineContext.Provider!\"\n    );\n  }\n\n  useSyncExternalStore(timeline.subscribe, timeline.getUpdateKey);\n\n  return timeline;\n};\n\ntype TimeSliderProps = {\n  filters: Filters;\n  dimensions: Dimension[];\n} & AnimationField;\n\nexport const TimeSlider = (props: TimeSliderProps) => {\n  const {\n    componentId,\n    showPlayButton,\n    type: animationType,\n    duration: animationDuration,\n    filters,\n    dimensions,\n  } = props;\n\n  const [state] = useConfiguratorState(hasChartConfigs);\n  const dimension = useMemo(() => {\n    return dimensions.find((d) => d.id === componentId);\n  }, [componentId, dimensions]);\n  const temporal = isTemporalDimension(dimension);\n  const temporalEntity = isTemporalEntityDimension(dimension);\n  const temporalOrdinal = isTemporalOrdinalDimension(dimension);\n\n  if (!(temporal || temporalEntity || temporalOrdinal)) {\n    throw Error(\"You can only use TimeSlider with temporal dimensions!\");\n  }\n\n  const timeFormatUnit = useTimeFormatUnit();\n  const timeUnit = \"timeUnit\" in dimension ? dimension.timeUnit : undefined;\n\n  // No TimeSlider for tables.\n  const chartState = useChartState() as NonNullable<\n    Exclude<ChartState, TableChartState>\n  >;\n  const dimensionFilter = filters[dimension.id];\n  const timelineProps: TimelineProps = useMemo(() => {\n    const commonProps = {\n      animationType,\n      msDuration: animationDuration * 1000,\n    };\n    const uniqueValues = Array.from(\n      new Set(\n        chartState.allData\n          .map((d) => d[dimension.id])\n          .filter(truthy) as string[]\n      )\n    );\n\n    if (temporal) {\n      const msValues = uniqueValues.map((d) => parseDate(d).getTime());\n      const formatValue = (d: number) => timeFormatUnit(new Date(d), timeUnit!);\n\n      return {\n        type: \"interval\",\n        msValues,\n        formatValue,\n        ...commonProps,\n      };\n    } else {\n      const sorting: NonNullable<SortingField[\"sorting\"]> = {\n        sortingType: \"byAuto\",\n        sortingOrder: \"asc\",\n      };\n      const sorters = makeDimensionValueSorters(dimension, {\n        dimensionFilter,\n        sorting,\n      });\n      const sortingOrders = getSortingOrders(sorters, sorting);\n      const sortedData = orderBy(uniqueValues, sorters, sortingOrders);\n\n      return {\n        type: \"ordinal\",\n        sortedData,\n        ...commonProps,\n      };\n    }\n  }, [\n    animationType,\n    animationDuration,\n    chartState.allData,\n    temporal,\n    dimension,\n    timeFormatUnit,\n    timeUnit,\n    dimensionFilter,\n  ]);\n\n  const timeline = useMemo(() => {\n    return new Timeline(timelineProps);\n  }, [timelineProps]);\n\n  if (state.dashboardFilters?.timeRange.active) {\n    return null;\n  }\n\n  return (\n    <TimelineContext.Provider value={timeline}>\n      <Root showPlayButton={showPlayButton} />\n    </TimelineContext.Provider>\n  );\n};\n\nconst Root = ({ showPlayButton }: { showPlayButton: boolean }) => {\n  const timeline = useTimeline();\n  const [min, max] = timeline.formattedExtent;\n\n  return (\n    <Box\n      {...DISABLE_SCREENSHOT_ATTR}\n      sx={{\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: 5,\n        mb: 5,\n        mr: 2.5,\n      }}\n    >\n      {showPlayButton && <PlayButton />}\n      <div style={{ position: \"relative\", width: \"100%\" }}>\n        <Slider />\n        <Typography\n          variant=\"caption\"\n          sx={{ position: \"absolute\", left: 0, mt: 2 }}\n        >\n          {min}\n        </Typography>\n        <Typography\n          variant=\"caption\"\n          sx={{ position: \"absolute\", right: 0, mt: 2 }}\n        >\n          {max}\n        </Typography>\n      </div>\n    </Box>\n  );\n};\n\nconst PlayButton = () => {\n  const timeline = useTimeline();\n\n  const onClick = useEvent(() => {\n    timeline.playing ? timeline.stop() : timeline.start();\n  });\n\n  return (\n    <Button\n      onClick={onClick}\n      variant=\"outlined\"\n      style={{\n        minHeight: 32,\n        minWidth: 32,\n        padding: 0,\n        borderRadius: \"50%\",\n      }}\n    >\n      <Icon name={timeline.playing ? \"pause\" : \"play\"} size={16} />\n    </Button>\n  );\n};\n\nconst useStyles = makeStyles(() => ({\n  root: {\n    width: \"100%\",\n\n    [`& .${sliderClasses.root}`]: {\n      height: \"6px\",\n\n      [`& .${sliderClasses.thumb}`]: {\n        width: \"16px\",\n        height: \"16px\",\n      },\n    },\n  },\n\n  playing: {\n    [`& .${sliderClasses.thumb}`]: {\n      transition: \"none\",\n    },\n\n    [`& .${sliderClasses.track}`]: {\n      transition: \"none\",\n    },\n  },\n}));\n\nconst Slider = () => {\n  const timeline = useTimeline();\n  const timeSlider = useChartInteractiveFilters((d) => d.timeSlider);\n  const setTimeSlider = useChartInteractiveFilters((d) => d.setTimeSlider);\n  const classes = useStyles();\n\n  const marks = useMemo(() => {\n    return timeline.domain.map((d) => ({ value: d })) ?? [];\n  }, [timeline.domain]);\n\n  const onChange = useEvent((e: ChangeEvent<HTMLInputElement>) => {\n    timeline.setProgress(+e.target.value);\n  });\n\n  const onClick = useEvent(() => {\n    timeline.stop();\n  });\n\n  useEffect(() => {\n    if (timeline.type !== timeSlider.type) {\n      setTimeSlider({\n        type: timeline.type,\n        value: undefined,\n      });\n    }\n\n    if (\n      timeline.type === \"interval\" &&\n      timeSlider.type === \"interval\" &&\n      timeSlider.value?.getTime() !== timeline.value\n    ) {\n      setTimeSlider({\n        type: \"interval\",\n        value: new Date(timeline.value),\n      });\n    }\n\n    if (\n      timeline.type === \"ordinal\" &&\n      timeSlider.type === \"ordinal\" &&\n      timeSlider?.value !== timeline.value\n    ) {\n      setTimeSlider({\n        type: \"ordinal\",\n        value: timeline.value as string,\n      });\n    }\n  }, [\n    timeline.value,\n    timeline.type,\n    timeSlider.type,\n    timeSlider.value,\n    setTimeSlider,\n  ]);\n\n  return (\n    <GenericSlider\n      name=\"time-slider\"\n      renderTextInput={false}\n      min={0}\n      max={1}\n      step={null}\n      marks={marks}\n      value={timeline.progress}\n      onChange={onChange}\n      onClick={onClick}\n      valueLabelDisplay=\"on\"\n      valueLabelFormat={timeline.formattedValue}\n      className={clsx(classes.root, timeline.playing && classes.playing)}\n    />\n  );\n};\n","export default function(series, order) {\n  if (!((n = series.length) > 0)) return;\n  for (var i, j = 0, d, dy, yp, yn, n, m = series[order[0]].length; j < m; ++j) {\n    for (yp = yn = 0, i = 0; i < n; ++i) {\n      if ((dy = (d = series[order[i]][j])[1] - d[0]) > 0) {\n        d[0] = yp, d[1] = yp += dy;\n      } else if (dy < 0) {\n        d[1] = yn, d[0] = yn += dy;\n      } else {\n        d[0] = 0, d[1] = dy;\n      }\n    }\n  }\n}\n","import none from \"./none.js\";\n\nexport default function(series) {\n  var sums = series.map(sum);\n  return none(series).sort(function(a, b) { return sums[a] - sums[b]; });\n}\n\nexport function sum(series) {\n  var s = 0, i = -1, n = series.length, v;\n  while (++i < n) if (v = +series[i][1]) s += v;\n  return s;\n}\n","import ascending from \"./ascending.js\";\n\nexport default function(series) {\n  return ascending(series).reverse();\n}\n","export default function(series) {\n  var n = series.length, o = new Array(n);\n  while (--n >= 0) o[n] = n;\n  return o;\n}\n","import none from \"./none.js\";\n\nexport default function(series) {\n  return none(series).reverse();\n}\n","export default function(series, order) {\n  if (!((n = series.length) > 1)) return;\n  for (var i = 1, j, s0, s1 = series[order[0]], n, m = s1.length; i < n; ++i) {\n    s0 = s1, s1 = series[order[i]];\n    for (j = 0; j < m; ++j) {\n      s1[j][1] += s1[j][0] = isNaN(s0[j][1]) ? s0[j][0] : s0[j][1];\n    }\n  }\n}\n","import array from \"./array.js\";\nimport constant from \"./constant.js\";\nimport offsetNone from \"./offset/none.js\";\nimport orderNone from \"./order/none.js\";\n\nfunction stackValue(d, key) {\n  return d[key];\n}\n\nfunction stackSeries(key) {\n  const series = [];\n  series.key = key;\n  return series;\n}\n\nexport default function() {\n  var keys = constant([]),\n      order = orderNone,\n      offset = offsetNone,\n      value = stackValue;\n\n  function stack(data) {\n    var sz = Array.from(keys.apply(this, arguments), stackSeries),\n        i, n = sz.length, j = -1,\n        oz;\n\n    for (const d of data) {\n      for (i = 0, ++j; i < n; ++i) {\n        (sz[i][j] = [0, +value(d, sz[i].key, j, data)]).data = d;\n      }\n    }\n\n    for (i = 0, oz = array(order(sz)); i < n; ++i) {\n      sz[oz[i]].index = i;\n    }\n\n    offset(sz, oz);\n    return sz;\n  }\n\n  stack.keys = function(_) {\n    return arguments.length ? (keys = typeof _ === \"function\" ? _ : constant(Array.from(_)), stack) : keys;\n  };\n\n  stack.value = function(_) {\n    return arguments.length ? (value = typeof _ === \"function\" ? _ : constant(+_), stack) : value;\n  };\n\n  stack.order = function(_) {\n    return arguments.length ? (order = _ == null ? orderNone : typeof _ === \"function\" ? _ : constant(Array.from(_)), stack) : order;\n  };\n\n  stack.offset = function(_) {\n    return arguments.length ? (offset = _ == null ? offsetNone : _, stack) : offset;\n  };\n\n  return stack;\n}\n"],"names":["useColumnValueLabelsData","bounds","width","height","showValues","getValueOffset","renderEveryNthValue","chartData","getRenderingKey","xScale","getX","yScale","getY","valueLabelFormatter","useChartState","bandwidth","useMemo","map","d","i","key","valueRaw","xScaled","value","isNaN","x","y","yRender","Math","max","valueLabel","filter","truthy","ErrorWhiskers","getYErrorPresent","getYErrorRange","showYUncertainty","margins","ref","useRef","enableTransition","useTransitionStore","state","enable","transitionDuration","duration","renderData","x0","barWidth","min","y1","y2","useEffect","current","renderContainer","id","transform","left","top","transition","render","g","opts","renderVerticalWhiskers","_jsx","Columns","xDimension","colors","rotateValues","labelFontSize","fontFamily","useChartTheme","y0","getAnnotationRenderState","useGetAnnotationRenderState","columnsData","abs","color","focused","axisComponentId","axisValue","copy","observation","valueLabelsData","common","_objectSpread","renderColumns","renderTotalValueLabels","rotate","fontSize","xScaleIn","getSegment","grouped","some","flatMap","_ref","segment","observations","ColumnsGrouped","_ref2","useColumnsGroupedStateVariables","props","chartConfig","dimensions","dimensionsById","measures","measuresById","fields","interactiveFiltersConfig","animation","componentId","filters","useChartConfigFilters","baseVariables","useBaseVariables","bandXVariables","useBandXVariables","numericalYVariables","useNumericalYVariables","numericalYErrorVariables","useNumericalYErrorVariables","getValue","segmentVariables","useSegmentVariables","interactiveFiltersVariables","useInteractiveFiltersVariables","getXAsDate","sortData","useCallback","data","sortingOrder","sortingType","sorting","xGetter","isTemporalEntityDimension","getTime","toString","order","rollup","v","sum","sort","a","b","ascending","orderBy","sortByIndex","getCategory","useRenderingKeyVariable","useColumnsGroupedStateData","chartProps","variables","getSegmentAbbreviationOrLabel","getTimeRangeDate","plottableData","usePlottableData","useChartData","timeRangeDimensionId","getAxisValueAsDate","useColumnsGroupedState","getXAbbreviationOrLabel","getXLabel","formatXDate","yMeasure","getMinY","getFormattedYUncertainty","segmentDimension","segmentsByAbbreviationOrLabel","getSegmentLabel","xAxisLabel","yAxisLabel","scalesData","segmentData","timeRangeData","paddingData","allData","useSize","formatNumber","useFormatNumber","decimals","formatters","useChartFormatters","segmentsByValue","Map","values","segmentSortingOrder","sumsBySegment","Object","fromEntries","segmentFilter","cubes","find","iri","cubeIri","undefined","allSegments","segments","allUniqueSegments","Array","from","Set","uniqueSegments","sorters","makeDimensionValueSorters","useAbbreviations","dimensionFilter","getSortingOrders","includes","xFilter","sumsByX","xTimeRangeDomainLabels","paddingYScale","xScaleTimeRange","xScaleInteraction","scaleOrdinal","type","segmentColor","orderedSegmentLabelsAndColors","dvIri","get","label","colorMapping","schemeCategory10","domain","s","range","getPalette","paletteId","colorField","unknown","xValues","xTimeRangeValues","xSorting","xSorters","measureBySegment","xDomain","scaleBand","paddingInner","PADDING_INNER","paddingOuter","PADDING_OUTER","padding","PADDING_WITHIN","xScaleTimeRangeDomain","extent","scaleTime","scaleLinear","customDomain","minValue","maxValue","nice","minPaddingValue","maxPaddingValue","xKeys","groupedMap","group","size","length","has","bottom","useChartPadding","xLabelPresent","bandDomain","every","leftAxisLabelSize","useAxisLabelSizeVariables","bottomAxisLabelSize","DEFAULT_MARGIN_TOP","offset","right","chartWidth","getChartWidth","useChartBounds","chartHeight","isMobile","useIsMobile","formatXAxisTick","tick","isTemporalDimension","chartType","getColorLabel","getTooltipInfo","datum","bw","tooltipValues","yValues","sortedTooltipValues","xAnchorRaw","yMin","yMax","yAnchor","placement","MOBILE_TOOLTIP_PLACEMENT","getCenteredTooltipPlacement","xAnchor","topAnchor","xLabel","formatNumberWithUnit","unit","error","axis","axisOffset","leftAxisLabelOffsetTop","GroupedColumnChartProvider","children","_objectWithoutProperties","_excluded","ChartContext","Provider","GroupedColumnChart","InteractionProvider","ColumnsStacked","series","getRenderDatum","useGetRenderStackedColumnDatum","useColumnsStackedStateVariables","plottableDataWide","xOrder","total","descending","useColumnsStackedStateData","plottableDataByX","getWideData","dataGrouped","getAxisValue","sortPlottableData","useColumnsStackedState","getIdentityY","useGetIdentityY","calculationType","useChartInteractiveFilters","calculation","xKey","normalize","chartDataGroupedByX","normalizeData","getTotalGroupValue","chartWideData","imputationType","console","warn","animationIri","getAnimation","getStackedYScale","active","scale","stackOrder","stackOrderAscending","stackOrderDescending","stackOrderReverse","stacked","stack","stackOffsetDiverging","keys","getAnnotationInfo","focusingSegment","getStackedPosition","measureScale","fallbackMeasureValue","ANNOTATION_SINGLE_SEGMENT_OFFSET","yValueFormatter","getStackedTooltipValueFormatter","measureId","measureUnit","useValueLabelFormatter","StackedColumnsChartProvider","StackedColumnsChart","useColumnsStateVariables","limits","limitsVariables","useLimitsVariables","useColumnsStateData","useColumnsState","minLimitValue","maxLimitValue","sortingOrders","paddingMinValue","paddingMaxValue","_useShowBandValueLabe","useShowBandValueLabelsVariables","getErrorRange","yValueLabelsOffset","showValuesVariables","yOffset","hasValueLabels","NaN","DEFAULT_ANNOTATION_CIRCLE_COLOR","ColumnChartProvider","_excluded2","ColumnChart","InteractionColumns","disableGaps","onClick","onHover","onHoverOut","useAnnotationInteractions","fill","fillOpacity","stroke","onMouseOver","onMouseOut","InteractionColumnsStacked","StackedColumnAnnotationHighlight","StackedAnnotationHighlight","valueScale","axisScale","chartDataGrouped","dimension","isHorizontal","ChartColumnsVisualization","ChartDataWrapper","Component","ChartColumns","memo","dashboardFilters","useConfiguratorState","hasChartConfigs","showTimeBrush","shouldShowBrush","timeRange","useLimits","isEditingAnnotation","useIsEditingAnnotation","_Fragment","_jsxs","ChartContainer","ChartSvg","AxisHeightLinear","AxisHideXOverflowRect","AxisWidthBand","AxisWidthBandDomain","BrushTime","HoverAnnotationDot","Tooltip","Annotations","ChartControlsContainer","TimeSlider","LegendColor","symbol","interactive","legend","showTitle","ErrorWhiskersGrouped","VerticalLimits","showValuesBySegmentMapping","getChartConfig","definitiveFilters","useDefinitiveFilters","valueLabelColor","getContrastingColor","xRaw","hasAnnotation","hasSegmentAnnotation","valueLabelOffset","options","selectAll","join","enter","append","attr","call","_","maybeTransition","setSegmentWrapperValueLabelProps","setSegmentValueLabelProps","style","select","text","update","toggleFocusBorder","exit","remove","xTimeUnit","labelColor","gridColor","axisLabelFontSize","domainColor","resolvedFontSize","xAxisTitleOffset","useXAxisTitleOffset","hasNegativeValues","axisBottom","tickSizeOuter","tickSizeInner","tickPadding","tickFormat","renderUpdate","display","OpenMetadataPanelWrapper","component","lineHeight","chartState","LimitsComponent","createLimitsComponent","getChartState","displayName","OverlayHighlightRect","ANNOTATION_FOCUS_COLOR","strokeWidth","ANNOTATION_FOCUS_WIDTH","pointerEvents","interaction","useInteraction","axisSize","getHighlightRect","axisKey","axisPosition","valueSum","value0","value1","valueSize","highlightedRects","rects","visible","push","isActive","rect","TimelineContext","createContext","useTimeline","timeline","useContext","Error","useSyncExternalStore","subscribe","getUpdateKey","showPlayButton","animationType","animationDuration","temporal","temporalEntity","temporalOrdinal","isTemporalOrdinalDimension","timeFormatUnit","useTimeFormatUnit","timeUnit","timelineProps","commonProps","msDuration","uniqueValues","msValues","parseDate","formatValue","Date","sortedData","Timeline","Root","formattedExtent","Box","DISABLE_SCREENSHOT_ATTR","sx","alignItems","gap","mb","mr","PlayButton","position","Slider","Typography","variant","mt","useEvent","playing","stop","start","Button","minHeight","minWidth","borderRadius","Icon","name","useStyles","makeStyles","root","sliderClasses","thumb","track","timeSlider","setTimeSlider","classes","marks","onChange","e","setProgress","target","GenericSlider","renderTextInput","step","progress","valueLabelDisplay","valueLabelFormat","formattedValue","className","clsx","__WEBPACK_DEFAULT_EXPORT__","n","dy","yp","yn","j","m","sums","_none_js__WEBPACK_IMPORTED_MODULE_0__","Z","_ascending_js__WEBPACK_IMPORTED_MODULE_0__","reverse","o","none","s0","s1","stackValue","stackSeries","constant","order_none","oz","sz","apply","arguments","array","index"],"sourceRoot":""}