{"version":3,"file":"static/chunks/17139.2c0e41ceb03ac83a.js","mappings":"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","sources":["webpack://_N_E/./charts/area/rendering-utils.ts","webpack://_N_E/./charts/area/areas.tsx","webpack://_N_E/./charts/area/areas-state-props.ts","webpack://_N_E/./charts/area/areas-state.tsx","webpack://_N_E/./charts/area/chart-area.tsx","webpack://_N_E/./charts/shared/axis-width-time.tsx","webpack://_N_E/./charts/shared/interaction/ruler.tsx","webpack://_N_E/./charts/shared/limits/vertical.tsx","webpack://_N_E/./charts/shared/overlay-horizontal.tsx","webpack://_N_E/./charts/shared/overlay-voronoi.tsx"],"sourcesContent":["import { interpolatePath } from \"d3-interpolate-path\";\nimport { select, Selection } from \"d3-selection\";\n\nimport {\n  maybeTransition,\n  RenderOptions,\n} from \"@/charts/shared/rendering-utils\";\n\nexport type RenderAreaDatum = {\n  key: string;\n  d: string;\n  dEmpty: string;\n  color: string;\n};\n\nexport const renderAreas = (\n  g: Selection<SVGGElement, null, SVGGElement, unknown>,\n  data: RenderAreaDatum[],\n  options: RenderOptions\n) => {\n  const { transition } = options;\n\n  g.selectAll<SVGPathElement, RenderAreaDatum>(\"path\")\n    .data(data, (d) => d.key)\n    .join(\n      (enter) =>\n        enter\n          .append(\"path\")\n          .attr(\"d\", (d) => d.dEmpty)\n          .attr(\"fill\", (d) => d.color)\n          .call((enter) =>\n            maybeTransition(enter, {\n              transition,\n              s: (g) => g.attr(\"d\", (d) => d.d),\n              t: (g) => g.attrTween(\"d\", (d) => interpolatePath(d.dEmpty, d.d)),\n            })\n          ),\n      (update) =>\n        maybeTransition(update, {\n          transition,\n          s: (g) => g.attr(\"d\", (d) => d.d).attr(\"fill\", (d) => d.color),\n          t: (g) =>\n            g\n              .attrTween(\"d\", function (d) {\n                return interpolatePath(select(this).attr(\"d\"), d.d);\n              })\n              .attr(\"fill\", (d) => d.color),\n        }),\n      (exit) =>\n        maybeTransition(exit, {\n          transition,\n          s: (g) => g.attr(\"d\", (d) => d.dEmpty).remove(),\n          t: (g) =>\n            g.attrTween(\"d\", (d) => interpolatePath(d.d, d.dEmpty)).remove(),\n        })\n    );\n};\n","import { area } from \"d3-shape\";\nimport { useEffect, useMemo, useRef } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { RenderAreaDatum, renderAreas } from \"@/charts/area/rendering-utils\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { renderTotalValueLabels } from \"@/charts/shared/render-value-labels\";\nimport {\n  renderContainer,\n  RenderContainerOptions,\n} from \"@/charts/shared/rendering-utils\";\nimport { useRenderTemporalValueLabelsData } from \"@/charts/shared/show-values-utils\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\nexport const Areas = () => {\n  const { bounds, getX, xScale, yScale, colors, series } =\n    useChartState() as AreasState;\n  const { margins } = bounds;\n  const { labelFontSize, fontFamily } = useChartTheme();\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const areaGenerator = area<$FixMe>()\n    .defined(\n      (d) =>\n        d[0] !== null &&\n        d[1] !== null &&\n        !Number.isNaN(d[0]) &&\n        !Number.isNaN(d[1])\n    )\n    .x((d) => xScale(getX(d.data)))\n    .y0((d) => yScale(d[0]))\n    .y1((d) => yScale(d[1]));\n  const renderData = useMemo(() => {\n    return series.map((d) => {\n      return {\n        key: d.key,\n        d: areaGenerator(d) as string,\n        dEmpty: areaGenerator(\n          d.map((d) => {\n            const dNew = { ...d };\n            dNew[1] = d[0];\n\n            return dNew;\n          })\n        ) as string,\n        color: colors(d.key),\n      } satisfies RenderAreaDatum;\n    });\n  }, [series, areaGenerator, colors]);\n\n  const valueLabelsData = useRenderTemporalValueLabelsData();\n\n  useEffect(() => {\n    const g = ref.current;\n\n    if (g) {\n      const common: Pick<\n        RenderContainerOptions,\n        \"id\" | \"transform\" | \"transition\"\n      > = {\n        id: \"areas\",\n        transform: `translate(${margins.left} ${margins.top})`,\n        transition: {\n          enable: enableTransition,\n          duration: transitionDuration,\n        },\n      };\n      renderContainer(g, {\n        ...common,\n        render: (g, opts) => renderAreas(g, renderData, opts),\n      });\n      renderContainer(g, {\n        ...common,\n        render: (g, opts) =>\n          renderTotalValueLabels(g, valueLabelsData, {\n            ...opts,\n            rotate: false,\n            fontFamily,\n            fontSize: labelFontSize,\n          }),\n      });\n    }\n  }, [\n    enableTransition,\n    margins.left,\n    margins.top,\n    renderData,\n    transitionDuration,\n    valueLabelsData,\n    labelFontSize,\n    fontFamily,\n  ]);\n\n  return <g ref={ref} />;\n};\n","import { ascending } from \"d3-array\";\nimport { useCallback } from \"react\";\n\nimport { usePlottableData } from \"@/charts/shared/chart-helpers\";\nimport {\n  BaseVariables,\n  ChartStateData,\n  InteractiveFiltersVariables,\n  LimitsVariables,\n  NumericalYVariables,\n  SegmentVariables,\n  SortingVariables,\n  TemporalXVariables,\n  useBaseVariables,\n  useChartData,\n  useInteractiveFiltersVariables,\n  useLimitsVariables,\n  useNumericalYVariables,\n  useSegmentVariables,\n  useTemporalXVariables,\n} from \"@/charts/shared/chart-state\";\nimport { AreaConfig } from \"@/config-types\";\nimport { useLimits } from \"@/config-utils\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type AreasStateVariables = BaseVariables &\n  SortingVariables &\n  TemporalXVariables &\n  NumericalYVariables &\n  SegmentVariables &\n  InteractiveFiltersVariables &\n  LimitsVariables;\n\nexport const useAreasStateVariables = (\n  props: ChartProps<AreaConfig> & { limits: ReturnType<typeof useLimits> }\n): AreasStateVariables => {\n  const { chartConfig, observations, dimensionsById, measuresById, limits } =\n    props;\n  const { fields } = chartConfig;\n  const { x, y, segment } = fields;\n\n  const baseVariables = useBaseVariables(chartConfig);\n  const temporalXVariables = useTemporalXVariables(x, {\n    dimensionsById,\n  });\n  const numericalYVariables = useNumericalYVariables(\"area\", y, {\n    measuresById,\n  });\n  const segmentVariables = useSegmentVariables(segment, {\n    dimensionsById,\n    observations,\n  });\n  const interactiveFiltersVariables = useInteractiveFiltersVariables(\n    chartConfig.interactiveFiltersConfig,\n    { dimensionsById }\n  );\n  const limitsVariables = useLimitsVariables(limits);\n\n  const { getX } = temporalXVariables;\n  const sortData: AreasStateVariables[\"sortData\"] = useCallback(\n    (data) => {\n      return [...data].sort((a, b) => {\n        return ascending(getX(a), getX(b));\n      });\n    },\n    [getX]\n  );\n\n  return {\n    ...baseVariables,\n    sortData,\n    ...temporalXVariables,\n    ...numericalYVariables,\n    ...segmentVariables,\n    ...interactiveFiltersVariables,\n    ...limitsVariables,\n  };\n};\n\nexport const useAreasStateData = (\n  chartProps: ChartProps<AreaConfig> & { limits: ReturnType<typeof useLimits> },\n  variables: AreasStateVariables\n): ChartStateData => {\n  const { chartConfig, observations, limits } = chartProps;\n  const {\n    sortData,\n    xDimension,\n    getX,\n    getY,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  } = variables;\n  const plottableData = usePlottableData(observations, {\n    getX,\n    getY,\n  });\n\n  return useChartData(plottableData, {\n    sortData,\n    chartConfig,\n    axisDimensionId: xDimension.id,\n    limits: limits.limits.map((limit) => limit.measureLimit),\n    timeRangeDimensionId: xDimension.id,\n    getAxisValueAsDate: getX,\n    getSegmentAbbreviationOrLabel,\n    getTimeRangeDate,\n  });\n};\n","import { extent, group, rollup, sum } from \"d3-array\";\nimport {\n  ScaleLinear,\n  scaleLinear,\n  ScaleOrdinal,\n  scaleOrdinal,\n  ScaleTime,\n  scaleTime,\n} from \"d3-scale\";\nimport { schemeCategory10 } from \"d3-scale-chromatic\";\nimport {\n  Series,\n  stack,\n  stackOrderAscending,\n  stackOrderDescending,\n  stackOrderReverse,\n} from \"d3-shape\";\nimport orderBy from \"lodash/orderBy\";\nimport { PropsWithChildren, useCallback, useMemo } from \"react\";\n\nimport {\n  AreasStateVariables,\n  useAreasStateData,\n  useAreasStateVariables,\n} from \"@/charts/area/areas-state-props\";\nimport { GetAnnotationInfo } from \"@/charts/shared/annotations\";\nimport {\n  AxisLabelSizeVariables,\n  getChartWidth,\n  useAxisLabelSizeVariables,\n  useChartBounds,\n  useChartPadding,\n} from \"@/charts/shared/chart-dimensions\";\nimport {\n  getWideData,\n  normalizeData,\n  stackOffsetDivergingPositiveZeros,\n  useGetIdentityY,\n} from \"@/charts/shared/chart-helpers\";\nimport {\n  ChartContext,\n  ChartStateData,\n  CommonChartState,\n  InteractiveXTimeRangeState,\n} from \"@/charts/shared/chart-state\";\nimport { TooltipInfo, TooltipValue } from \"@/charts/shared/interaction/tooltip\";\nimport {\n  getCenteredTooltipPlacement,\n  MOBILE_TOOLTIP_PLACEMENT,\n} from \"@/charts/shared/interaction/tooltip-box\";\nimport { DEFAULT_MARGIN_TOP } from \"@/charts/shared/margins\";\nimport {\n  ShowTemporalValueLabelsVariables,\n  useShowTemporalValueLabelsVariables,\n} from \"@/charts/shared/show-values-utils\";\nimport {\n  getStackedPosition,\n  getStackedTooltipValueFormatter,\n  getStackedYScale,\n} from \"@/charts/shared/stacked-helpers\";\nimport { useChartFormatters } from \"@/charts/shared/use-chart-formatters\";\nimport { InteractionProvider } from \"@/charts/shared/use-interaction\";\nimport { useSize } from \"@/charts/shared/use-size\";\nimport { useLimits } from \"@/config-utils\";\nimport { AreaConfig } from \"@/configurator\";\nimport { Observation } from \"@/domain/data\";\nimport { useFormatNumber, useTimeFormatUnit } from \"@/formatters\";\nimport { getPalette } from \"@/palettes\";\nimport { useChartInteractiveFilters } from \"@/stores/interactive-filters\";\nimport { sortByIndex } from \"@/utils/array\";\nimport {\n  getSortingOrders,\n  makeDimensionValueSorters,\n} from \"@/utils/sorting-values\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\n\nimport { ChartProps } from \"../shared/chart-props\";\n\nexport type AreasState = CommonChartState &\n  AreasStateVariables &\n  InteractiveXTimeRangeState &\n  Omit<ShowTemporalValueLabelsVariables, \"yOffset\"> & {\n    chartType: \"area\";\n    xScale: ScaleTime<number, number>;\n    yScale: ScaleLinear<number, number>;\n    segments: string[];\n    colors: ScaleOrdinal<string, string>;\n    getColorLabel: (segment: string) => string;\n    chartWideData: ArrayLike<Observation>;\n    series: Series<{ [key: string]: number }, string>[];\n    getAnnotationInfo: GetAnnotationInfo;\n    getTooltipInfo: (d: Observation) => TooltipInfo;\n    leftAxisLabelSize: AxisLabelSizeVariables;\n    leftAxisLabelOffsetTop: number;\n    bottomAxisLabelSize: AxisLabelSizeVariables;\n  };\n\nconst useAreasState = (\n  chartProps: ChartProps<AreaConfig>,\n  variables: AreasStateVariables,\n  data: ChartStateData\n): AreasState => {\n  const { chartConfig, dimensions, measures } = chartProps;\n  const {\n    xDimension,\n    getX,\n    getXAsString,\n    yMeasure,\n    getY,\n    segmentDimension,\n    segmentsByAbbreviationOrLabel,\n    getSegment,\n    getSegmentAbbreviationOrLabel,\n    getSegmentLabel,\n    xAxisLabel,\n    yAxisLabel,\n    minLimitValue,\n    maxLimitValue,\n  } = variables;\n  const getIdentityY = useGetIdentityY(yMeasure.id);\n  const {\n    chartData,\n    scalesData,\n    segmentData,\n    timeRangeData,\n    paddingData,\n    allData,\n  } = data;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const { y } = fields;\n\n  const { width, height } = useSize();\n  const formatNumber = useFormatNumber({ decimals: \"auto\" });\n  const formatters = useChartFormatters(chartProps);\n  const timeFormatUnit = useTimeFormatUnit();\n  const calculationType = useChartInteractiveFilters((d) => d.calculation.type);\n\n  const segmentsByValue = useMemo(() => {\n    const values = segmentDimension?.values ?? [];\n\n    return new Map(values.map((d) => [d.value, d]));\n  }, [segmentDimension?.values]);\n\n  /** Ordered segments */\n  const segmentSorting = fields.segment?.sorting;\n  const segmentSortingType = segmentSorting?.sortingType;\n  const segmentSortingOrder = segmentSorting?.sortingOrder;\n\n  const segmentFilter = segmentDimension?.id\n    ? chartConfig.cubes.find((d) => d.iri === segmentDimension.cubeIri)\n        ?.filters[segmentDimension.id]\n    : undefined;\n\n  const sumsBySegment = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        segmentData,\n        (v) => sum(v, (x) => getY(x)),\n        (x) => getSegment(x)\n      )\n    );\n  }, [segmentData, getY, getSegment]);\n\n  const { allSegments, segments } = useMemo(() => {\n    const allUniqueSegments = Array.from(\n      new Set(segmentData.map((d) => getSegment(d)))\n    );\n    const uniqueSegments = Array.from(\n      new Set(scalesData.map((d) => getSegment(d)))\n    );\n    const sorters = makeDimensionValueSorters(segmentDimension, {\n      sorting: segmentSorting,\n      sumsBySegment,\n      useAbbreviations: fields.segment?.useAbbreviations,\n      dimensionFilter: segmentFilter,\n    });\n    const allSegments = orderBy(\n      allUniqueSegments,\n      sorters,\n      getSortingOrders(sorters, segmentSorting)\n    );\n\n    return {\n      allSegments,\n      segments: allSegments.filter((d) => uniqueSegments.includes(d)),\n    };\n  }, [\n    segmentData,\n    scalesData,\n    sumsBySegment,\n    segmentDimension,\n    segmentSorting,\n    segmentFilter,\n    getSegment,\n    fields.segment?.useAbbreviations,\n  ]);\n\n  const xKey = fields.x.componentId;\n  const sumsByX = useMemo(() => {\n    return Object.fromEntries(\n      rollup(\n        chartData,\n        (v) => sum(v, (x) => getY(x)),\n        (x) => getXAsString(x)\n      )\n    );\n  }, [chartData, getXAsString, getY]);\n\n  const normalize = calculationType === \"percent\";\n  const chartDataGroupedByX = useMemo(() => {\n    if (normalize) {\n      return group(\n        normalizeData(chartData, {\n          key: yMeasure.id,\n          getAxisValue: getY,\n          getTotalGroupValue: (d) => {\n            return sumsByX[getXAsString(d)];\n          },\n        }),\n        getXAsString\n      );\n    }\n\n    return group(chartData, getXAsString);\n  }, [normalize, chartData, getXAsString, yMeasure.id, getY, sumsByX]);\n\n  const chartWideData = useMemo(() => {\n    return getWideData({\n      dataGrouped: chartDataGroupedByX,\n      key: xKey,\n      getAxisValue: getY,\n      getSegment,\n      allSegments: segments,\n      imputationType: fields.y.imputationType,\n    });\n  }, [\n    getSegment,\n    getY,\n    chartDataGroupedByX,\n    segments,\n    xKey,\n    fields.y.imputationType,\n  ]);\n\n  /** Transform data  */\n  const series = useMemo(() => {\n    const stackOrder =\n      segmentSortingType === \"byTotalSize\" && segmentSortingOrder === \"asc\"\n        ? stackOrderAscending\n        : segmentSortingType === \"byTotalSize\" && segmentSortingOrder === \"desc\"\n          ? stackOrderDescending\n          : stackOrderReverse;\n    const stacked = stack()\n      .order(stackOrder)\n      .offset(stackOffsetDivergingPositiveZeros)\n      .keys(segments);\n\n    return stacked(chartWideData as { [key: string]: number }[]);\n  }, [chartWideData, segmentSortingOrder, segmentSortingType, segments]);\n\n  /** Scales */\n  const { colors, xScale, xScaleTimeRange } = useMemo(() => {\n    const xDomain = extent(scalesData, (d) => getX(d)) as [Date, Date];\n    const xScale = scaleTime().domain(xDomain);\n    const xScaleTimeRangeDomain = extent(timeRangeData, (d) => getX(d)) as [\n      Date,\n      Date,\n    ];\n    const xScaleTimeRange = scaleTime().domain(xScaleTimeRangeDomain);\n    const colors = scaleOrdinal<string, string>();\n\n    if (segmentDimension && fields.color?.type === \"segment\") {\n      const segmentColor = fields.color;\n      const orderedSegmentLabelsAndColors = allSegments.map((segment) => {\n        const dvIri =\n          segmentsByAbbreviationOrLabel.get(segment)?.value ??\n          segmentsByValue.get(segment)?.value ??\n          \"\";\n\n        return {\n          label: segment,\n          color: segmentColor.colorMapping[dvIri] ?? schemeCategory10[0],\n        };\n      });\n\n      colors.domain(orderedSegmentLabelsAndColors.map((s) => s.label));\n      colors.range(orderedSegmentLabelsAndColors.map((s) => s.color));\n    } else {\n      colors.domain(allSegments);\n      colors.range(\n        getPalette({\n          paletteId: fields.color?.paletteId,\n          colorField: fields.color,\n        })\n      );\n    }\n\n    colors.unknown(() => undefined);\n\n    return {\n      colors,\n      xScale,\n      xScaleTimeRange,\n    };\n  }, [\n    fields.color,\n    getX,\n    scalesData,\n    timeRangeData,\n    segmentsByAbbreviationOrLabel,\n    segmentsByValue,\n    allSegments,\n    segmentDimension,\n  ]);\n\n  const yScale = useMemo(() => {\n    return getStackedYScale(scalesData, {\n      normalize,\n      getX: getXAsString,\n      getY,\n      minLimitValue,\n      maxLimitValue,\n      customDomain: y.customDomain,\n    });\n  }, [\n    scalesData,\n    normalize,\n    getXAsString,\n    getY,\n    minLimitValue,\n    maxLimitValue,\n    y.customDomain,\n  ]);\n\n  const paddingYScale = useMemo(() => {\n    //  When the user can toggle between absolute and relative values, we use the\n    // absolute values to calculate the yScale domain, so that the yScale doesn't\n    // change when the user toggles between absolute and relative values.\n    if (interactiveFiltersConfig.calculation.active) {\n      const scale = getStackedYScale(paddingData, {\n        normalize: false,\n        getX: getXAsString,\n        getY,\n        minLimitValue,\n        maxLimitValue,\n        customDomain: y.customDomain,\n      });\n\n      if (scale.domain()[1] < 100 && scale.domain()[0] > -100) {\n        return scaleLinear().domain([0, 100]);\n      }\n\n      return scale;\n    }\n\n    return getStackedYScale(paddingData, {\n      normalize,\n      getX: getXAsString,\n      getY,\n      minLimitValue,\n      maxLimitValue,\n      customDomain: y.customDomain,\n    });\n  }, [\n    interactiveFiltersConfig.calculation.active,\n    paddingData,\n    normalize,\n    getXAsString,\n    getY,\n    minLimitValue,\n    maxLimitValue,\n    y.customDomain,\n  ]);\n\n  /** Dimensions */\n  const { top, left, bottom } = useChartPadding({\n    xLabelPresent: !!xAxisLabel,\n    yScale: paddingYScale,\n    width,\n    height,\n    interactiveFiltersConfig,\n    formatNumber,\n    normalize,\n  });\n  const right = 40;\n\n  const chartWidth = getChartWidth({ width, left, right });\n  xScale.range([0, chartWidth]);\n  xScaleTimeRange.range([0, chartWidth]);\n\n  const leftAxisLabelSize = useAxisLabelSizeVariables({\n    label: yAxisLabel,\n    width,\n  });\n  const bottomAxisLabelSize = useAxisLabelSizeVariables({\n    label: xAxisLabel,\n    width,\n  });\n  const { yOffset: yValueLabelsOffset, ...showValuesVariables } =\n    useShowTemporalValueLabelsVariables(y, {\n      dimensions,\n      measures,\n      segment: fields.segment,\n    });\n  const margins = {\n    top:\n      DEFAULT_MARGIN_TOP + top + leftAxisLabelSize.offset + yValueLabelsOffset,\n    right,\n    bottom,\n    left,\n  };\n  const bounds = useChartBounds({ width, chartWidth, height, margins });\n  const { chartHeight } = bounds;\n\n  yScale.range([chartHeight, 0]);\n\n  const isMobile = useIsMobile();\n\n  const getAnnotationInfo: GetAnnotationInfo = useCallback(\n    (observation, { segment }) => {\n      const x = xScale(getX(observation));\n      const y = getStackedPosition({\n        observation,\n        series,\n        key: xKey,\n        getAxisValue: getXAsString,\n        measureScale: yScale,\n        fallbackMeasureValue: yScale(getY(observation) ?? 0),\n        segment,\n      });\n\n      return {\n        x,\n        y,\n        color: segment ? colors(segment) : undefined,\n      };\n    },\n    [xScale, getX, series, xKey, getXAsString, yScale, getY, colors]\n  );\n\n  const getTooltipInfo = useCallback(\n    (datum: Observation): TooltipInfo => {\n      const x = getXAsString(datum);\n      const tooltipValues = chartDataGroupedByX.get(x) ?? [];\n      const yValues = tooltipValues.map(getY);\n      const sortedTooltipValues = sortByIndex({\n        data: tooltipValues,\n        order: segments,\n        getCategory: getSegment,\n        sortingOrder: \"asc\",\n      });\n      const yValueFormatter = getStackedTooltipValueFormatter({\n        normalize,\n        measureId: yMeasure.id,\n        measureUnit: yMeasure.unit,\n        formatters,\n        formatNumber,\n      });\n      const xAnchor = xScale(getX(datum));\n      const allNaN = yValues.every((d) => Number.isNaN(d));\n      const yDesktopAnchor = allNaN\n        ? NaN\n        : normalize\n          ? yScale.range()[0] * 0.5\n          : yScale(sum(yValues) * (fields.segment ? 0.5 : 1));\n      const yAnchor = isMobile ? chartHeight : yDesktopAnchor;\n      const placement = isMobile\n        ? MOBILE_TOOLTIP_PLACEMENT\n        : getCenteredTooltipPlacement({\n            chartWidth,\n            xAnchor,\n            topAnchor: !fields.segment,\n          });\n\n      return {\n        xAnchor,\n        yAnchor,\n        placement,\n        value: timeFormatUnit(getX(datum), xDimension.timeUnit),\n        datum: {\n          label: fields.segment && getSegmentAbbreviationOrLabel(datum),\n          value: yValueFormatter(getY(datum), getIdentityY(datum)),\n          color: colors(getSegment(datum)),\n        },\n        values: sortedTooltipValues.map((d) => {\n          const segment = getSegment(d);\n          const y = getStackedPosition({\n            observation: d,\n            series,\n            key: xKey,\n            getAxisValue: getXAsString,\n            measureScale: yScale,\n            fallbackMeasureValue: yScale(getY(d) ?? 0),\n            segment,\n          });\n\n          return {\n            label: getSegmentAbbreviationOrLabel(d),\n            value: yValueFormatter(getY(d), getIdentityY(d)),\n            axis: \"y\",\n            axisOffset: y,\n            color: colors(segment),\n          } satisfies TooltipValue;\n        }),\n      };\n    },\n    [\n      getXAsString,\n      chartDataGroupedByX,\n      getY,\n      segments,\n      getSegment,\n      normalize,\n      yMeasure.id,\n      yMeasure.unit,\n      formatters,\n      formatNumber,\n      xScale,\n      getX,\n      yScale,\n      fields.segment,\n      isMobile,\n      chartHeight,\n      chartWidth,\n      timeFormatUnit,\n      xDimension.timeUnit,\n      getSegmentAbbreviationOrLabel,\n      getIdentityY,\n      colors,\n      series,\n      xKey,\n    ]\n  );\n\n  return {\n    chartType: \"area\",\n    bounds,\n    chartData,\n    allData,\n    xScale,\n    xScaleTimeRange,\n    yScale,\n    segments,\n    colors,\n    getColorLabel: getSegmentLabel,\n    chartWideData,\n    series,\n    getAnnotationInfo,\n    getTooltipInfo,\n    leftAxisLabelSize,\n    leftAxisLabelOffsetTop: top,\n    bottomAxisLabelSize,\n    ...showValuesVariables,\n    ...variables,\n  };\n};\n\nconst AreaChartProvider = (\n  props: PropsWithChildren<\n    ChartProps<AreaConfig> & { limits: ReturnType<typeof useLimits> }\n  >\n) => {\n  const { children, ...chartProps } = props;\n  const variables = useAreasStateVariables(chartProps);\n  const data = useAreasStateData(chartProps, variables);\n  const state = useAreasState(chartProps, variables, data);\n\n  return (\n    <ChartContext.Provider value={state}>{children}</ChartContext.Provider>\n  );\n};\n\nexport const AreaChart = (\n  props: PropsWithChildren<\n    ChartProps<AreaConfig> & { limits: ReturnType<typeof useLimits> }\n  >\n) => {\n  return (\n    <InteractionProvider>\n      <AreaChartProvider {...props} />\n    </InteractionProvider>\n  );\n};\n","import { memo } from \"react\";\n\nimport { Areas } from \"@/charts/area/areas\";\nimport { AreaChart } from \"@/charts/area/areas-state\";\nimport { ChartDataWrapper } from \"@/charts/chart-data-wrapper\";\nimport { useIsEditingAnnotation } from \"@/charts/shared/annotation-utils\";\nimport { Annotations } from \"@/charts/shared/annotations\";\nimport { AxisHeightLinear } from \"@/charts/shared/axis-height-linear\";\nimport { AxisHideXOverflowRect } from \"@/charts/shared/axis-hide-overflow-rect\";\nimport { AxisTime, AxisTimeDomain } from \"@/charts/shared/axis-width-time\";\nimport { BrushTime } from \"@/charts/shared/brush\";\nimport {\n  ChartContainer,\n  ChartControlsContainer,\n  ChartSvg,\n} from \"@/charts/shared/containers\";\nimport { HoverAnnotationDot } from \"@/charts/shared/interaction/hover-annotation-dot\";\nimport { Ruler } from \"@/charts/shared/interaction/ruler\";\nimport { Tooltip } from \"@/charts/shared/interaction/tooltip\";\nimport { LegendColor } from \"@/charts/shared/legend-color\";\nimport { VerticalLimits } from \"@/charts/shared/limits/vertical\";\nimport { InteractionHorizontal } from \"@/charts/shared/overlay-horizontal\";\nimport { InteractionVoronoi } from \"@/charts/shared/overlay-voronoi\";\nimport { AreaConfig } from \"@/config-types\";\nimport { useLimits } from \"@/config-utils\";\n\nimport { ChartProps, VisualizationProps } from \"../shared/chart-props\";\n\nexport const ChartAreasVisualization = (\n  props: VisualizationProps<AreaConfig>\n) => {\n  return <ChartDataWrapper {...props} Component={ChartAreas} />;\n};\n\nconst ChartAreas = memo((props: ChartProps<AreaConfig>) => {\n  const { chartConfig, dimensions, measures, dimensionsById } = props;\n  const { fields, interactiveFiltersConfig } = chartConfig;\n  const limits = useLimits({\n    chartConfig,\n    dimensions,\n    measures,\n  });\n  const isEditingAnnotation = useIsEditingAnnotation();\n\n  return (\n    <AreaChart {...props} limits={limits}>\n      <ChartContainer>\n        <ChartSvg>\n          <AxisHeightLinear />\n          <AxisHideXOverflowRect />\n          <AxisTime />\n          <AxisTimeDomain />\n          <Areas />\n          <VerticalLimits {...limits} />\n          {isEditingAnnotation ? (\n            <InteractionVoronoi />\n          ) : (\n            <InteractionHorizontal />\n          )}\n          {interactiveFiltersConfig.timeRange.active && <BrushTime />}\n        </ChartSvg>\n        {isEditingAnnotation ? (\n          <HoverAnnotationDot />\n        ) : (\n          <Tooltip type={fields.segment ? \"multiple\" : \"single\"} />\n        )}\n        <Ruler />\n      </ChartContainer>\n      <Annotations />\n      {(fields.segment || limits.limits.length > 0) && (\n        <ChartControlsContainer>\n          <LegendColor\n            chartConfig={chartConfig}\n            symbol=\"square\"\n            interactive={interactiveFiltersConfig.legend.active}\n            showTitle={fields.segment?.showTitle}\n            dimensionsById={dimensionsById}\n            limits={limits}\n          />\n        </ChartControlsContainer>\n      )}\n    </AreaChart>\n  );\n});\n","import { axisBottom } from \"d3-axis\";\nimport { useEffect, useRef } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { ComboLineDualState } from \"@/charts/combo/combo-line-dual-state\";\nimport { ComboLineSingleState } from \"@/charts/combo/combo-line-single-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { useXAxisTitleOffset } from \"@/charts/shared/chart-dimensions\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  maybeTransition,\n  renderContainer,\n} from \"@/charts/shared/rendering-utils\";\nimport { useChartTheme } from \"@/charts/shared/use-chart-theme\";\nimport { OpenMetadataPanelWrapper } from \"@/components/metadata-panel\";\nimport { useFormatShortDateAuto } from \"@/formatters\";\nimport { useTransitionStore } from \"@/stores/transition\";\n\n// Approximate the longest date format we're using for.\n// Roughly equivalent to the text width of \"99.99.9999\" with 12px font size.\nconst MAX_DATE_LABEL_LENGTH = 70;\n\nexport const AxisTime = () => {\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const formatDateAuto = useFormatShortDateAuto();\n  const {\n    xScale,\n    yScale,\n    bounds,\n    xDimension,\n    xAxisLabel,\n    bottomAxisLabelSize,\n  } = useChartState() as\n    | LinesState\n    | AreasState\n    | ComboLineSingleState\n    | ComboLineDualState;\n  const { chartHeight, chartWidth, margins } = bounds;\n  const {\n    labelColor,\n    gridColor,\n    domainColor,\n    labelFontSize,\n    fontFamily,\n    axisLabelFontSize,\n  } = useChartTheme();\n  const xAxisTitleOffset = useXAxisTitleOffset();\n  const hasNegativeValues = yScale.domain()[0] < 0;\n  const ticks = bounds.chartWidth / (MAX_DATE_LABEL_LENGTH + 20);\n\n  useEffect(() => {\n    if (ref.current) {\n      const axis = axisBottom(xScale)\n        .ticks(ticks)\n        .tickSizeInner(hasNegativeValues ? -chartHeight : 6)\n        .tickPadding(hasNegativeValues ? 6 : 3)\n        .tickFormat((x) => formatDateAuto(x as Date));\n      const g = renderContainer(ref.current, {\n        id: \"axis-width-time\",\n        transform: `translate(${margins.left} ${chartHeight + margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g) => g.call(axis),\n        renderUpdate: (g, opts) =>\n          maybeTransition(g, {\n            transition: opts.transition,\n            s: (g) => g.call(axis),\n          }),\n      });\n\n      g.select(\".domain\").remove();\n      g.selectAll(\".tick line\").attr(\n        \"stroke\",\n        hasNegativeValues ? gridColor : domainColor\n      );\n      g.selectAll(\".tick text\")\n        .attr(\"font-size\", labelFontSize)\n        .attr(\"font-family\", fontFamily)\n        .attr(\"fill\", labelColor);\n    }\n  }, [\n    chartHeight,\n    domainColor,\n    enableTransition,\n    fontFamily,\n    formatDateAuto,\n    gridColor,\n    hasNegativeValues,\n    labelColor,\n    labelFontSize,\n    margins.left,\n    margins.top,\n    ticks,\n    transitionDuration,\n    xScale,\n  ]);\n\n  return (\n    <>\n      <foreignObject\n        x={margins.left + chartWidth / 2 - bottomAxisLabelSize.width / 2}\n        y={margins.top + chartHeight + xAxisTitleOffset}\n        width={chartWidth}\n        height={bottomAxisLabelSize.height}\n        style={{ display: \"flex\" }}\n      >\n        <OpenMetadataPanelWrapper component={xDimension}>\n          <span style={{ fontSize: axisLabelFontSize, lineHeight: 1.5 }}>\n            {xAxisLabel}\n          </span>\n        </OpenMetadataPanelWrapper>\n      </foreignObject>\n      <g ref={ref} />\n    </>\n  );\n};\n\nexport const AxisTimeDomain = () => {\n  const ref = useRef<SVGGElement>(null);\n  const enableTransition = useTransitionStore((state) => state.enable);\n  const transitionDuration = useTransitionStore((state) => state.duration);\n  const { xScale, yScale, bounds } = useChartState() as\n    | LinesState\n    | AreasState\n    | ComboLineSingleState\n    | ComboLineDualState;\n  const { chartHeight, margins } = bounds;\n  const { domainColor } = useChartTheme();\n\n  useEffect(() => {\n    if (ref.current) {\n      const axis = axisBottom(xScale).tickSizeOuter(0);\n      const g = renderContainer(ref.current, {\n        id: \"axis-width-time-domain\",\n        transform: `translate(${margins.left} ${chartHeight + margins.top})`,\n        transition: { enable: enableTransition, duration: transitionDuration },\n        render: (g) => g.call(axis),\n        renderUpdate: (g, opts) =>\n          maybeTransition(g, {\n            transition: opts.transition,\n            s: (g) => g.call(axis),\n          }),\n      });\n\n      g.selectAll(\".tick line\").remove();\n      g.selectAll(\".tick text\").remove();\n      g.select(\".domain\")\n        .attr(\"transform\", `translate(0, -${bounds.chartHeight - yScale(0)})`)\n        .attr(\"stroke\", domainColor)\n        .attr(\"stroke-linecap\", \"round\");\n    }\n  });\n\n  return <g ref={ref} />;\n};\n","import { Theme } from \"@mui/material\";\nimport { makeStyles } from \"@mui/styles\";\n\nimport { ComboLineColumnState } from \"@/charts/combo/combo-line-column-state\";\nimport { ComboLineDualState } from \"@/charts/combo/combo-line-dual-state\";\nimport { ComboLineSingleState } from \"@/charts/combo/combo-line-single-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport {\n  TooltipPlacement,\n  TooltipValue,\n} from \"@/charts/shared/interaction/tooltip\";\nimport { useInteraction } from \"@/charts/shared/use-interaction\";\nimport { Margins } from \"@/charts/shared/use-size\";\nimport { Observation } from \"@/domain/data\";\nimport { useIsMobile } from \"@/utils/use-is-mobile\";\n\ntype RulerProps = {\n  rotate?: boolean;\n};\n\nexport const Ruler = (props: RulerProps) => {\n  const { rotate = false } = props;\n  const [{ type, visible, observation }] = useInteraction();\n\n  return (\n    <>\n      {type === \"tooltip\" && visible && observation && (\n        <RulerInner d={observation} rotate={rotate} />\n      )}\n    </>\n  );\n};\n\ntype RulerInnerProps = {\n  d: Observation;\n  rotate: boolean;\n};\n\nconst RulerInner = (props: RulerInnerProps) => {\n  const { d, rotate } = props;\n  const { getTooltipInfo, bounds } = useChartState() as\n    | LinesState\n    | ComboLineSingleState\n    | ComboLineDualState\n    | ComboLineColumnState;\n  const { xAnchor, value, datum, placement, values } = getTooltipInfo(d);\n\n  return (\n    <RulerContent\n      rotate={rotate}\n      xValue={value}\n      values={values}\n      chartHeight={bounds.chartHeight}\n      margins={bounds.margins}\n      xAnchor={xAnchor}\n      datum={datum}\n      placement={placement}\n    />\n  );\n};\n\ntype RulerContentProps = {\n  rotate: boolean;\n  xValue: string;\n  values: TooltipValue[] | undefined;\n  chartHeight: number;\n  margins: Margins;\n  xAnchor: number;\n  datum: TooltipValue;\n  placement: TooltipPlacement;\n  showXValue?: boolean;\n};\n\nconst useStyles = makeStyles<Theme, { rotate: boolean }>((theme: Theme) => ({\n  left: {\n    width: 0,\n    position: \"absolute\",\n    borderWidth: 0.5,\n    borderStyle: \"solid\",\n    borderColor: theme.palette.cobalt[50],\n    pointerEvents: \"none\",\n    transform: \"translateX(-50%)\",\n  },\n  right: {\n    position: \"absolute\",\n    fontWeight: \"bold\",\n    backgroundColor: theme.palette.background.paper,\n    transform: ({ rotate }) =>\n      rotate\n        ? \"translateX(-50%) translateY(50%) rotate(90deg)\"\n        : \"translateX(-50%)\",\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1),\n    fontSize: \"0.875rem\",\n  },\n}));\n\nexport const RulerContent = (props: RulerContentProps) => {\n  const { rotate, xValue, chartHeight, margins, xAnchor } = props;\n  const classes = useStyles({ rotate });\n  const isMobile = useIsMobile();\n\n  return (\n    <>\n      <div\n        className={classes.left}\n        style={{\n          height: chartHeight,\n          left: xAnchor + margins.left,\n          top: margins.top,\n        }}\n      />\n      {!isMobile && (\n        <div\n          className={classes.right}\n          style={{\n            left: xAnchor + margins.left,\n            top: chartHeight + margins.top + 6,\n          }}\n        >\n          {xValue}\n        </div>\n      )}\n    </>\n  );\n};\n","import { useMemo } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { ColumnsState } from \"@/charts/column/columns-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { createLimitsComponent } from \"@/charts/shared/limits/create-component\";\nimport { useLimits } from \"@/config-utils\";\n\nexport type VerticalChartState = AreasState | ColumnsState | LinesState;\n\nexport const VerticalLimits = (props: ReturnType<typeof useLimits>) => {\n  const chartState = useChartState() as VerticalChartState;\n  const LimitsComponent = useMemo(() => {\n    return createLimitsComponent({\n      isHorizontal: false,\n      getChartState: () => chartState,\n    });\n  }, [chartState]);\n\n  return <LimitsComponent {...props} />;\n};\nVerticalLimits.displayName = \"VerticalLimits\";\n","import { bisector } from \"d3-array\";\nimport { pointer } from \"d3-selection\";\nimport { memo, MouseEvent, useCallback, useRef } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { ComboLineDualState } from \"@/charts/combo/combo-line-dual-state\";\nimport { ComboLineSingleState } from \"@/charts/combo/combo-line-single-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { useInteraction } from \"@/charts/shared/use-interaction\";\nimport { Observation } from \"@/domain/data\";\nimport { useEvent } from \"@/utils/use-event\";\n\nexport const InteractionHorizontal = memo(function InteractionHorizontal() {\n  const {\n    chartData,\n    chartWideData,\n    xScale,\n    getX,\n    getTooltipInfo,\n    bounds: { chartWidth, chartHeight, margins },\n  } = useChartState() as\n    | AreasState\n    | LinesState\n    | ComboLineSingleState\n    | ComboLineDualState;\n  const [interaction, dispatch] = useInteraction();\n  const ref = useRef<SVGGElement>(null);\n\n  const hideTooltip = useEvent(() => {\n    dispatch({\n      type: \"INTERACTION_HIDE\",\n    });\n  });\n\n  const showTooltip = useCallback(\n    (e: MouseEvent) => {\n      if (!ref.current) {\n        return;\n      }\n\n      const [x, y] = pointer(e, ref.current);\n      const bisectDate = bisector(\n        (d: Observation, date: Date) => getX(d).getTime() - date.getTime()\n      ).left;\n      const thisDate = xScale.invert(x);\n      const i = bisectDate(chartWideData, thisDate, 1);\n      const dLeft = chartWideData[i - 1];\n      const dRight = chartWideData[i] ?? dLeft;\n      const closestDatum =\n        thisDate.getTime() - getX(dLeft).getTime() >\n        getX(dRight).getTime() - thisDate.getTime()\n          ? dRight\n          : dLeft;\n      const yAnchor = closestDatum\n        ? getTooltipInfo(closestDatum).yAnchor\n        : undefined;\n\n      if (!closestDatum || Number.isNaN(yAnchor) || yAnchor === undefined) {\n        if (interaction.visible) {\n          hideTooltip();\n        }\n\n        return;\n      }\n\n      const closestDatumTime = getX(closestDatum).getTime();\n      const observation = chartData.find(\n        (d) => closestDatumTime === getX(d).getTime()\n      );\n\n      if (\n        !interaction.observation ||\n        closestDatumTime !== getX(interaction.observation).getTime() ||\n        !interaction.visible\n      ) {\n        dispatch({\n          type: \"INTERACTION_UPDATE\",\n          value: {\n            type: \"tooltip\",\n            visible: true,\n            observation,\n            mouse: { x, y },\n          },\n        });\n      }\n    },\n    [\n      chartData,\n      chartWideData,\n      dispatch,\n      getTooltipInfo,\n      getX,\n      hideTooltip,\n      interaction.observation,\n      interaction.visible,\n      xScale,\n    ]\n  );\n\n  return (\n    <g ref={ref} transform={`translate(${margins.left} ${margins.top})`}>\n      <rect\n        width={chartWidth}\n        height={chartHeight}\n        fillOpacity={0}\n        onMouseOut={hideTooltip}\n        onMouseOver={showTooltip}\n        onMouseMove={showTooltip}\n      />\n    </g>\n  );\n});\n","import { Delaunay } from \"d3-delaunay\";\nimport { pointer } from \"d3-selection\";\nimport { memo, MouseEvent, useCallback, useMemo, useRef } from \"react\";\n\nimport { AreasState } from \"@/charts/area/areas-state\";\nimport { LinesState } from \"@/charts/line/lines-state\";\nimport { ScatterplotState } from \"@/charts/scatterplot/scatterplot-state\";\nimport { useChartState } from \"@/charts/shared/chart-state\";\nimport { useAnnotationInteractions } from \"@/charts/shared/use-annotation-interactions\";\nimport { Observation } from \"@/domain/data\";\n\ntype InteractionVoronoiChartState = AreasState | LinesState | ScatterplotState;\n\nexport const InteractionVoronoi = memo(function InteractionVoronoi({\n  debug,\n}: {\n  debug?: boolean;\n}) {\n  const ref = useRef<SVGGElement>(null);\n  const chartState = useChartState() as InteractionVoronoiChartState;\n  const {\n    bounds: { chartWidth, chartHeight, margins },\n    getSegment,\n    colors,\n  } = chartState;\n  const { onClick, onHover, onHoverOut } = useAnnotationInteractions({\n    focusingSegment: true,\n  });\n\n  const voronoiPoints = useMemo(() => {\n    return getVoronoiPoints(chartState);\n  }, [chartState]);\n\n  const delaunay = useMemo(() => {\n    return Delaunay.from(\n      voronoiPoints,\n      (d) => d.x,\n      (d) => d.y\n    );\n  }, [voronoiPoints]);\n\n  const voronoi = useMemo(() => {\n    return delaunay.voronoi([\n      0,\n      0,\n      atLeastZero(chartWidth),\n      atLeastZero(chartHeight),\n    ]);\n  }, [chartWidth, chartHeight, delaunay]);\n\n  const findVoronoiPoint = useCallback(\n    (e: MouseEvent) => {\n      if (!ref.current) {\n        return;\n      }\n\n      const [x, y] = pointer(e, ref.current);\n      const i = delaunay.find(x, y);\n\n      return voronoiPoints[i];\n    },\n    [voronoiPoints, delaunay]\n  );\n\n  const handleHover = useCallback(\n    (e: MouseEvent) => {\n      const point = findVoronoiPoint(e);\n\n      if (point) {\n        onHover(point.observation, { segment: point.segment });\n      }\n    },\n    [findVoronoiPoint, onHover]\n  );\n\n  const handleClick = useCallback(\n    (e: MouseEvent) => {\n      const point = findVoronoiPoint(e);\n\n      if (point) {\n        onClick(point.observation, { segment: point.segment });\n      }\n    },\n    [findVoronoiPoint, onClick]\n  );\n\n  return (\n    <g ref={ref} transform={`translate(${margins.left} ${margins.top})`}>\n      {debug &&\n        voronoiPoints.map(({ observation }, i) => (\n          <path\n            key={i}\n            d={voronoi.renderCell(i)}\n            stroke=\"white\"\n            strokeOpacity={1}\n            fill={colors(getSegment(observation))}\n            fillOpacity={0.2}\n          />\n        ))}\n      <rect\n        width={chartWidth}\n        height={chartHeight}\n        fillOpacity={0}\n        onMouseOver={handleHover}\n        onMouseMove={handleHover}\n        onMouseOut={onHoverOut}\n        onClick={handleClick}\n      />\n    </g>\n  );\n});\n\ntype VoronoiDataPoint = {\n  x: number;\n  y: number;\n  observation: Observation;\n  segment?: string;\n};\n\nconst getVoronoiPoints = (chartState: InteractionVoronoiChartState) => {\n  const { chartData, xScale, getX, yScale, getY, getSegment } = chartState;\n\n  switch (chartState.chartType) {\n    case \"area\": {\n      const { series } = chartState;\n\n      return series.flatMap((s) => {\n        const segment = s.key;\n\n        return s\n          .map((d) => {\n            const observation = d.data;\n            const x = xScale(getX(observation) ?? NaN);\n            const y = yScale(series.length === 1 ? d[0] : (d[0] + d[1]) * 0.5);\n\n            return {\n              x,\n              y,\n              observation,\n              segment,\n            };\n          })\n          .filter(\n            (point) => !Number.isNaN(point.x) && !Number.isNaN(point.y)\n          ) satisfies VoronoiDataPoint[];\n      });\n    }\n    case \"line\":\n    case \"scatterplot\": {\n      return chartData\n        .map((d) => {\n          const segment = getSegment(d);\n\n          return {\n            observation: d,\n            x: xScale(getX(d) ?? NaN),\n            y: yScale(getY(d) ?? NaN),\n            segment,\n          };\n        })\n        .filter(\n          (point) => !Number.isNaN(point.x) && !Number.isNaN(point.y)\n        ) satisfies VoronoiDataPoint[];\n    }\n    default:\n      const _exhaustiveCheck: never = chartState;\n      return _exhaustiveCheck;\n  }\n};\n\nconst atLeastZero = (n: number) => (n < 0 ? 0 : n);\n"],"names":["renderAreas","g","data","options","transition","selectAll","d","key","join","enter","append","attr","dEmpty","color","call","maybeTransition","s","t","attrTween","interpolatePath","update","select","exit","remove","Areas","bounds","getX","xScale","yScale","colors","series","useChartState","margins","labelFontSize","fontFamily","useChartTheme","ref","useRef","enableTransition","useTransitionStore","state","enable","transitionDuration","duration","areaGenerator","area","defined","Number","isNaN","x","y0","y1","renderData","useMemo","map","dNew","_objectSpread","valueLabelsData","useRenderTemporalValueLabelsData","useEffect","current","common","id","transform","left","top","renderContainer","render","opts","renderTotalValueLabels","rotate","fontSize","_jsx","useAreasStateVariables","props","chartConfig","observations","dimensionsById","measuresById","limits","fields","y","segment","baseVariables","useBaseVariables","temporalXVariables","useTemporalXVariables","numericalYVariables","useNumericalYVariables","segmentVariables","useSegmentVariables","interactiveFiltersVariables","useInteractiveFiltersVariables","interactiveFiltersConfig","limitsVariables","useLimitsVariables","sortData","useCallback","sort","a","b","ascending","useAreasStateData","chartProps","variables","xDimension","getY","getSegmentAbbreviationOrLabel","getTimeRangeDate","plottableData","usePlottableData","useChartData","axisDimensionId","limit","measureLimit","timeRangeDimensionId","getAxisValueAsDate","useAreasState","dimensions","measures","getXAsString","yMeasure","segmentDimension","segmentsByAbbreviationOrLabel","getSegment","getSegmentLabel","xAxisLabel","yAxisLabel","minLimitValue","maxLimitValue","getIdentityY","useGetIdentityY","chartData","scalesData","segmentData","timeRangeData","paddingData","allData","width","height","useSize","formatNumber","useFormatNumber","decimals","formatters","useChartFormatters","timeFormatUnit","useTimeFormatUnit","calculationType","useChartInteractiveFilters","calculation","type","segmentsByValue","Map","values","value","segmentSorting","sorting","segmentSortingType","sortingType","segmentSortingOrder","sortingOrder","segmentFilter","cubes","find","iri","cubeIri","filters","undefined","sumsBySegment","Object","fromEntries","rollup","v","sum","allSegments","segments","allUniqueSegments","Array","from","Set","uniqueSegments","sorters","makeDimensionValueSorters","useAbbreviations","dimensionFilter","orderBy","getSortingOrders","filter","includes","xKey","componentId","sumsByX","normalize","chartDataGroupedByX","group","normalizeData","getAxisValue","getTotalGroupValue","chartWideData","getWideData","dataGrouped","imputationType","stackOrder","stackOrderAscending","stackOrderDescending","stackOrderReverse","stacked","stack","order","offset","stackOffsetDivergingPositiveZeros","keys","xScaleTimeRange","xDomain","extent","scaleTime","domain","xScaleTimeRangeDomain","scaleOrdinal","segmentColor","orderedSegmentLabelsAndColors","dvIri","get","label","colorMapping","schemeCategory10","range","getPalette","paletteId","colorField","unknown","getStackedYScale","customDomain","paddingYScale","active","scale","scaleLinear","bottom","useChartPadding","xLabelPresent","chartWidth","getChartWidth","right","leftAxisLabelSize","useAxisLabelSizeVariables","bottomAxisLabelSize","_useShowTemporalValue","useShowTemporalValueLabelsVariables","yOffset","yValueLabelsOffset","showValuesVariables","_objectWithoutProperties","_excluded","DEFAULT_MARGIN_TOP","useChartBounds","chartHeight","isMobile","useIsMobile","getAnnotationInfo","observation","_ref","getStackedPosition","measureScale","fallbackMeasureValue","getTooltipInfo","datum","tooltipValues","yValues","sortedTooltipValues","sortByIndex","getCategory","yValueFormatter","getStackedTooltipValueFormatter","measureId","measureUnit","unit","xAnchor","yDesktopAnchor","allNaN","every","NaN","yAnchor","placement","MOBILE_TOOLTIP_PLACEMENT","getCenteredTooltipPlacement","topAnchor","timeUnit","axis","axisOffset","chartType","getColorLabel","leftAxisLabelOffsetTop","AreaChartProvider","children","_excluded2","ChartContext","Provider","AreaChart","InteractionProvider","ChartAreasVisualization","ChartDataWrapper","Component","ChartAreas","memo","useLimits","isEditingAnnotation","useIsEditingAnnotation","_jsxs","ChartContainer","ChartSvg","AxisHeightLinear","AxisHideXOverflowRect","AxisTime","AxisTimeDomain","VerticalLimits","InteractionVoronoi","InteractionHorizontal","timeRange","BrushTime","HoverAnnotationDot","Tooltip","Ruler","Annotations","length","ChartControlsContainer","LegendColor","symbol","interactive","legend","showTitle","formatDateAuto","useFormatShortDateAuto","labelColor","gridColor","domainColor","axisLabelFontSize","xAxisTitleOffset","useXAxisTitleOffset","hasNegativeValues","ticks","MAX_DATE_LABEL_LENGTH","axisBottom","tickSizeInner","tickPadding","tickFormat","renderUpdate","_Fragment","style","display","OpenMetadataPanelWrapper","component","lineHeight","tickSizeOuter","visible","useInteraction","RulerInner","RulerContent","xValue","useStyles","makeStyles","theme","position","borderWidth","borderStyle","borderColor","palette","cobalt","pointerEvents","fontWeight","backgroundColor","background","paper","paddingLeft","spacing","paddingRight","classes","className","chartState","LimitsComponent","createLimitsComponent","isHorizontal","getChartState","displayName","interaction","dispatch","hideTooltip","useEvent","showTooltip","e","pointer","bisectDate","bisector","date","getTime","thisDate","invert","i","dLeft","dRight","closestDatum","closestDatumTime","mouse","fillOpacity","onMouseOut","onMouseOver","onMouseMove","debug","onClick","onHover","onHoverOut","useAnnotationInteractions","focusingSegment","voronoiPoints","getVoronoiPoints","delaunay","Delaunay","voronoi","atLeastZero","findVoronoiPoint","handleHover","point","handleClick","_ref2","renderCell","stroke","strokeOpacity","fill","flatMap","n"],"sourceRoot":""}