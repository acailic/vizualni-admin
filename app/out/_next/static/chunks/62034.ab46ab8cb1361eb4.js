"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[62034],{62034:function(e,t,r){r.r(t),r.d(t,{ChartBarsVisualization:function(){return ta}});var n=r(17043),i=r(27378),o=r(68049),a=r(59245),l=r(93730),s=r(43137),c=r(83540),u=r(80491),d=r(25390),m=r(15658),f=r(87358);let p=()=>{let{colors:e,showValuesBySegmentMapping:t,valueLabelFormatter:r,xScale:n,yScale:a,getY:c,getRenderingKey:u}=(0,s.gH)(),[p]=(0,m.lY)(),g=(0,d.f6)(p),b=(0,d.B6)(),h=a.bandwidth();return(0,i.useCallback)(i=>{let s=i.key,d=e(s);return i.map(e=>{let i=e.data,m=i[s],p=s&&t[s]?r(m):void 0,y=p?(0,o.Qg)(d):void 0,j=n(e[0]),O=a(c(i)),v=(0,l.zm)(i,s,g,b)&&p?-((0,f.m)(p,{fontSize:12})+2):0;return{key:u(i,s),y:O,x:j,height:h,width:-1*Math.min(0,j-n(e[1])),color:d,valueLabel:p,valueLabelColor:y,observation:i,segment:s,valueLabelOffset:v}})},[h,e,u,c,t,r,n,a,g,b])},g=(e,t,r)=>{let{transition:n,x0:i}=r;e.selectAll("g.bar").data(t,e=>e.key).join(e=>e.append("g").attr("class","bar").call(e=>e.append("rect").attr("data-index",(e,t)=>t).attr("y",e=>e.y).attr("x",i).attr("width",0).attr("height",e=>e.height).attr("fill",e=>e.color).call(e=>(0,u.u5)(e,{transition:n,s:e=>e.attr("x",e=>e.x).attr("width",e=>e.width)}))).call(e=>e.append("foreignObject").attr("x",i).attr("y",e=>e.y).attr("width",e=>e.width).attr("height",e=>e.height).call(e=>(0,u.u5)(e,{transition:n,s:e=>e.attr("x",e=>e.x+(e.valueLabelOffset??0))})).append("xhtml:div").call(c.hy).append("xhtml:p").call(c.oG).style("color",function(e){return e.valueLabelColor??(0,a.Z)(this).style("color")}).text(e=>e.valueLabel??"")),e=>((0,u.pA)(e.select("rect")),(0,u.u5)(e,{s:e=>e.call(e=>e.select("rect").attr("x",e=>e.x).attr("y",e=>e.y).attr("width",e=>e.width).attr("height",e=>e.height).attr("fill",e=>e.color)).call(e=>e.select("foreignObject").attr("x",e=>e.x+(e.valueLabelOffset??0)).attr("y",e=>e.y).attr("width",e=>e.width).attr("height",e=>e.height).select("p").style("color",function(e){return e.valueLabelColor??(0,a.Z)(this).style("color")}).text(e=>e.valueLabel??"")),transition:n})),e=>(0,u.u5)(e,{transition:n,s:e=>e.call(e=>e.select("rect").attr("x",i).attr("width",0)).remove()}))};var b=r(17510);let h=()=>{let{bounds:{width:e,height:t},showValues:r,renderEveryNthValue:n,chartData:o,getRenderingKey:a,xScale:l,getX:c,yScale:u,getY:d,valueLabelFormatter:m,getValueOffset:f}=(0,s.gH)(),p=u.bandwidth();return(0,i.useMemo)(()=>r&&e&&t?o.map((e,t)=>{if(t%n!=0)return null;let r=a(e),i=c(e),o=null===i||isNaN(i)?0:i,s=l(Math.max(o,0)),g=u(d(e));return{key:r,x:s+f(e),y:g+p/2,valueLabel:m(o)}}).filter(b.y):[],[r,e,t,o,n,a,c,l,u,d,p,m,f])};var y=r(3663),j=r(80733),O=r(24246);function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let w=()=>{let{getY:e,getXErrorPresent:t,getXErrorRange:r,chartData:n,yScale:o,xScale:a,showXUncertainty:l,bounds:c}=(0,s.gH)(),{margins:d,width:m,chartHeight:f}=c,p=(0,i.useRef)(null),g=(0,j.K)(e=>e.enable),b=(0,j.K)(e=>e.duration),h=(0,i.useMemo)(()=>{if(!r||!l)return[];let i=o.bandwidth();return n.filter(t).map((t,n)=>{let l=o(e(t)),s=Math.min(i,16),[c,u]=r(t);return{key:`${n}`,y:l+i/2-s/2,x1:a(c),x2:a(u),height:s}})},[n,e,t,r,l,a,o,m,f]);return(0,i.useEffect)(()=>{p.current&&(0,u.sS)(p.current,{id:"bars-error-whiskers",transform:`translate(${d.left} ${d.top})`,transition:{enable:g,duration:b},render:(e,t)=>(0,u.xS)(e,h,t)})},[g,d.left,d.top,h,b]),(0,O.jsx)("g",{ref:p})},P=()=>{let{chartData:e,bounds:{width:t,margins:r},getX:n,xScale:o,yDimension:a,getY:d,yScale:m,getRenderingKey:f,colors:p,rotateValues:b}=(0,s.gH)(),{labelFontSize:v,fontFamily:w}=(0,y.$)(),P=(0,i.useRef)(null),Z=(0,j.K)(e=>e.enable),S=(0,j.K)(e=>e.duration),k=m.bandwidth(),D=o(0),M=(0,l.gf)(),A=(0,i.useMemo)(()=>e.map(e=>{let t=f(e),r=d(e),i=m(r),l=n(e),s=null===l||isNaN(l)?0:l,c=o(s),u=o(Math.min(s,0)),g=Math.max(0,Math.abs(c-D)),{color:b,focused:h}=M(e,{axisComponentId:a.id,axisValue:r});return{key:t,x:u,y:i,width:g,height:k,color:b??p.copy()(t),focused:h,observation:e}}),[t,e,k,n,d,o,m,D,f,M,a.id,p]),E=h();return(0,i.useEffect)(()=>{let e=P.current;if(e){let t={id:"bars",transform:`translate(${r.left} ${r.top})`,transition:{enable:Z,duration:S}};(0,u.sS)(e,x(x({},t),{},{render:(e,t)=>g(e,A,x(x({},t),{},{x0:D}))})),(0,u.sS)(e,x(x({},t),{},{render:(e,t)=>(0,c.HD)(e,E,x(x({},t),{},{rotate:b,textAnchor:"start",dx:6,dy:4,fontFamily:w,fontSize:v}))}))}},[Z,w,v,r.left,r.top,A,b,S,E,D]),(0,O.jsx)("g",{ref:P})};function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let k=()=>{let{bounds:e,xScale:t,yScaleIn:r,getXErrorRange:n,getXErrorPresent:o,yScale:a,getSegment:l,grouped:c,showXUncertainty:d}=(0,s.gH)(),{margins:m,width:f,height:p}=e,g=(0,i.useRef)(null),b=(0,j.K)(e=>e.enable),h=(0,j.K)(e=>e.duration),y=(0,i.useMemo)(()=>{if(!n||!d)return[];let e=r.bandwidth();return c.filter(e=>e[1].some(o)).flatMap(i=>{let[o,s]=i;return s.map(i=>{let s=r(l(i)),c=Math.min(e,15),[u,d]=n(i);return{key:`${o}-${l(i)}`,y:a(o)+s+e/2-c/2,x1:t(u),x2:t(d),height:c}})})},[l,n,o,c,d,t,r,a,f,p]);return(0,i.useEffect)(()=>{g.current&&(0,u.sS)(g.current,{id:"bars-grouped-error-whiskers",transform:`translate(${m.left} ${m.top})`,transition:{enable:b,duration:h},render:(e,t)=>(0,u.xS)(e,y,t)})},[b,m.left,m.top,y,h]),(0,O.jsx)("g",{ref:g})},D=()=>{let{bounds:e,xScale:t,yScaleIn:r,getX:n,yScale:o,getSegment:a,colors:l,grouped:c,getRenderingKey:d}=(0,s.gH)(),m=(0,i.useRef)(null),f=(0,j.K)(e=>e.enable),p=(0,j.K)(e=>e.duration),{margins:b,height:h}=e,y=r.bandwidth(),v=t(0),x=(0,i.useMemo)(()=>c.flatMap(e=>{let[i,s]=e;return s.map(e=>{let s=d(e,a(e)),c=a(e),u=n(e)??NaN;return{key:s,y:o(i)+r(c),x:t(Math.min(u,0)),width:Math.max(0,Math.abs(t(u)-v)),height:y,color:l(c),observation:e}})}),[l,a,y,n,c,r,t,o,v,d,h]);return(0,i.useEffect)(()=>{m.current&&(0,u.sS)(m.current,{id:"bars-grouped",transform:`translate(${b.left} ${b.top})`,transition:{enable:f,duration:p},render:(e,t)=>g(e,x,S(S({},t),{},{x0:v}))})},[f,b.left,b.top,x,p,v]),(0,O.jsx)("g",{ref:m})};var M=r(90089),A=r(23175),E=r(50228),I=r(51894),T=r(49951),C=r(36890),$=r(81829),H=r(9787),L=r(47626),z=r(67291),F=r(43605),V=r.n(F),R=r(60090),K=r(97091),N=r(64103),B=r(63122);function U(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function G(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?U(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let _=e=>{let{chartConfig:t,observations:r,dimensions:n,dimensionsById:o,measures:a,measuresById:l}=e,{fields:c,interactiveFiltersConfig:m}=t,{x:f,y:p,segment:g,animation:b}=c,h=o[p.componentId],y=(0,d.In)(t),j=(0,s.Ck)(t),O=(0,s.Zr)("bar",f,{measuresById:l}),v=(0,s.MT)(p,{dimensionsById:o,observations:r}),x=(0,s.Xt)(f,{getValue:O.getX,dimensions:n,measures:a}),w=(0,s.HR)(g,{dimensionsById:o,observations:r}),P=(0,s.SU)(m,{dimensionsById:o}),{getY:Z,getYAsDate:S}=v,{getX:k}=O,D=(0,i.useCallback)(e=>{let{sortingOrder:t,sortingType:r}=p.sorting??{},n=(0,N.eP)(h)?e=>S(e).getTime().toString():Z,i=[...(0,A.jJ)(e,e=>(0,E.Z)(e,e=>k(e)),e=>n(e))].sort((e,t)=>(0,R.Z)(e[1],t[1])).map(e=>e[0]);return"byDimensionLabel"===r?V()(e,n,t):"byMeasure"===r?(0,B.h)({data:e,order:i,getCategory:n,sortingOrder:t}):V()(e,n,"asc")},[k,S,Z,p.sorting,h]),M=(0,u.Tw)(n,y,b);return G(G(G(G(G(G(G({},j),{},{sortData:D},v),O),x),w),P),{},{getRenderingKey:M})},q=(e,t)=>{let{chartConfig:r,observations:n}=e,{sortData:i,yDimension:o,getYAsDate:a,getX:l,getSegmentAbbreviationOrLabel:c,getTimeRangeDate:u}=t,d=(0,K.Tq)(n,{getX:l});return(0,s.q1)(d,{sortData:i,chartConfig:r,timeRangeDimensionId:o.id,getAxisValueAsDate:a,getSegmentAbbreviationOrLabel:c,getTimeRangeDate:u})};var X=r(86932),Y=r(44830),J=r(91160),W=r(18185),Q=r(81364),ee=r(93477),et=r(41494),er=r(41282),en=r(7673),ei=r(98016);let eo=["children"];function ea(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function el(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ea(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let es=(e,t,r)=>{let{chartConfig:n}=e,{yDimension:o,getX:a,getYAsDate:l,getYAbbreviationOrLabel:s,getYLabel:c,xMeasure:u,getY:d,formatYDate:m,getMinX:f,getXErrorRange:p,getFormattedXUncertainty:g,segmentDimension:b,segmentsByAbbreviationOrLabel:h,getSegment:y,getSegmentAbbreviationOrLabel:j,getSegmentLabel:O,xAxisLabel:v,yAxisLabel:x}=t,{chartData:w,scalesData:P,segmentData:Z,timeRangeData:S,paddingData:k,allData:D}=r,{fields:M,interactiveFiltersConfig:F}=n,{x:R}=M,{width:K,height:U}=(0,ee.tH)(),G=(0,et.D2)({decimals:"auto"}),_=(0,W.c)(e),q=(0,i.useMemo)(()=>new Map((b?.values||[]).map(e=>[e.value,e])),[b?.values]),Q=M.segment?.sorting?.sortingOrder,eo=(0,i.useMemo)(()=>Object.fromEntries((0,A.jJ)(Z,e=>(0,E.Z)(e,e=>a(e)),e=>y(e))),[Z,a,y]),ea=b?.id?n.cubes.find(e=>e.iri===b.cubeIri)?.filters[b.id]:void 0,{allSegments:es,segments:ec}=(0,i.useMemo)(()=>{let e=Array.from(new Set(Z.map(e=>y(e)))),t=Array.from(new Set(P.map(e=>y(e)))),r=M?.segment?.sorting,n=(0,en.tf)(b,{sorting:r,sumsBySegment:eo,useAbbreviations:M.segment?.useAbbreviations,dimensionFilter:ea}),i=V()(e,n,(0,en.jS)(n,r));return{allSegments:i,segments:i.filter(e=>t.includes(e))}},[P,Z,b,M.segment?.sorting,M.segment?.useAbbreviations,eo,ea,y]),eu=n.cubes.find(e=>e.iri===o.cubeIri)?.filters[o.id],ed=(0,i.useMemo)(()=>Object.fromEntries((0,A.jJ)(w,e=>(0,E.Z)(e,e=>a(e)),e=>d(e))),[w,a,d]),{yTimeRangeDomainLabels:em,colors:ef,xScale:ep,paddingXScale:eg,yScaleTimeRange:eb,yScale:eh,yScaleIn:ey,yScaleInteraction:ej}=(0,i.useMemo)(()=>{let e=(0,C.Z)();if(M.segment&&b&&M.color){let t=es.map(e=>{let t=h.get(e)?.value||q.get(e)?.value||"";return{label:e,color:"segment"===M.color.type?M.color.colorMapping[t]??z.Z[0]:z.Z[0]}});e.domain(t.map(e=>e.label)),e.range(t.map(e=>e.color))}else e.domain(es),e.range((0,er.XN)({paletteId:M.color.paletteId,colorField:M.color}));e.unknown(()=>void 0);let t=[...new Set(P.map(d))],r=[...new Set(S.map(d))],n=M.y?.sorting,i=(0,en.tf)(o,{sorting:n,useAbbreviations:M.y?.useAbbreviations,measureBySegment:ed,dimensionFilter:eu}),s=V()(t,i,(0,en.jS)(i,n)),u=r.map(c),m=(0,$.Z)().domain(s).paddingInner(.1).paddingOuter(0),g=(0,$.Z)().domain(s).paddingInner(0).paddingOuter(0),y=(0,$.Z)().domain(ec).padding(.1),j=(0,I.Z)(S,e=>l(e)),O=(0,H.Z)().domain(j),v=(0,L.Z)(),x=(0,L.Z)();if(R.customDomain)v.domain(R.customDomain),x.domain(R.customDomain);else{let e=f(P,e=>p?.(e)[0]??a(e)),t=Math.max((0,T.Z)(P,e=>p?.(e)[1]??a(e))??0,0);v.domain([e,t]).nice();let r=f(k,e=>p?.(e)[0]??a(e)),n=Math.max((0,T.Z)(k,e=>p?.(e)[1]??a(e))??0,0);x.domain([r,n]).nice()}return{colors:e,xScale:v,paddingXScale:x,yScaleTimeRange:O,yScale:m,yScaleIn:y,yScaleInteraction:g,yTimeRangeDomainLabels:u}},[M.color,M.segment,M.y?.sorting,M.y?.useAbbreviations,b,P,d,o,ed,eu,c,ec,S,k,es,h,q,l,p,a,f,R.customDomain]),eO=(0,i.useMemo)(()=>{let e=eh.domain(),t=(0,A.ZP)(w,d);return(t.size<e.length?e.map(e=>t.has(e)?[e,t.get(e)]:[e,[]]):[...t]).map(e=>{let[t,r]=e;return[t,(0,B.h)({data:r,order:ec,getCategory:y,sortingOrder:Q})]})},[y,d,w,Q,ec,eh]),{top:ev,left:ex,bottom:ew}=(0,X.u8)({xLabelPresent:!!u.label,yScale:eg,width:K,height:U,interactiveFiltersConfig:F,formatNumber:G,bandDomain:em.every(e=>void 0===e)?eh.domain():em,isFlipped:!0}),eP=(0,X.Ti)({label:x,width:K}),eZ=(0,X.Ti)({label:v,width:K}),eS={top:J.L+ev+eP.offset,right:40,bottom:ew+45,left:ex},ek=(0,X.vG)({width:K,left:ex,right:40}),eD=(0,X.dE)({width:K,chartWidth:ek,height:U,margins:eS}),{chartHeight:eM}=eD;eh.range([0,eM]),ej.range([0,eM]),ey.range([0,eh.bandwidth()]),eb.range([0,eM]),ep.range([0,ek]);let eA=(0,ei.d)(),eE=(0,i.useCallback)(e=>(0,N.fF)(o)?m(e):c(e),[o,m,c]);return el({chartType:"bar",bounds:eD,chartData:w,allData:D,yScale:eh,yScaleInteraction:ej,yScaleIn:ey,yScaleTimeRange:eb,xScale:ep,segments:ec,colors:ef,getColorLabel:O,grouped:eO,getTooltipInfo:e=>{let t;let r=eh.bandwidth(),n=d(e),i=w.filter(e=>d(e)===n),o=i.map(a),l=(0,B.h)({data:i,order:ec,getCategory:y,sortingOrder:"asc"}),c=eh(n)+.5*r,[m,f]=(0,I.Z)(o,e=>e??0),p=eA?eM:ep(m+f),b=eA?Y.h0:(0,Y.Y7)({chartWidth:ek,xAnchor:p,topAnchor:!M.segment}),h=s(e);return{yAnchor:c+("bottom"===b.y?.5:-.5)*r,xAnchor:p,placement:b,value:eE(h),datum:{label:M.segment&&j(e),value:(t=a(e),(0,et._1)(t,_[u.id]??G,u.unit)),error:g(e),color:ef(y(e))},values:l.map(e=>{let t=y(e);return{label:j(e),value:u.unit?`${G(a(e))}â€‰${u.unit}`:G(a(e)),error:g(e),color:ef(t)}})}},leftAxisLabelSize:eP,leftAxisLabelOffsetTop:ev,bottomAxisLabelSize:eZ,formatYAxisTick:eE},t)},ec=e=>{let{children:t}=e,r=(0,M.Z)(e,eo),n=_(r),i=q(r,n),o=es(r,n,i);return(0,O.jsx)(s._M.Provider,{value:o,children:t})},eu=e=>(0,O.jsx)(Q.o,{children:(0,O.jsx)(ec,el({},e))});function ed(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function em(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ed(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ed(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ef=()=>{let e=(0,i.useRef)(null),t=(0,j.K)(e=>e.enable),r=(0,j.K)(e=>e.duration),{bounds:{height:n,margins:o},xScale:a,series:l}=(0,s.gH)(),c=p(),d=(0,i.useMemo)(()=>l.flatMap(c),[c,l,n]),m=a(0);return(0,i.useEffect)(()=>{e.current&&(0,u.sS)(e.current,{id:"bars-stacked",transform:`translate(${o.left} ${o.top})`,transition:{enable:t,duration:r},render:(e,t)=>g(e,d,em(em({},t),{},{x0:m}))})},[t,o.left,o.top,d,r,m]),(0,O.jsx)("g",{ref:e})};var ep=r(70585),eg=r(82965),eb=r(91597),eh=r(8379),ey=r(26088),ej=r(40499);function eO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ev(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eO(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eO(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ex=e=>{let{chartConfig:t,observations:r,dimensions:n,dimensionsById:o,measuresById:a}=e,{fields:l,interactiveFiltersConfig:c}=t,{x:m,y:f,segment:p,animation:g}=l,b=o[f.componentId],h=(0,d.In)(t),y=(0,s.Ck)(t),j=(0,s.Zr)("bar",m,{measuresById:a}),O=(0,s.MT)(f,{dimensionsById:o,observations:r}),v=(0,s.HR)(p,{dimensionsById:o,observations:r}),x=(0,s.SU)(c,{dimensionsById:o}),{getY:w,getYAsDate:P}=O,Z=(0,i.useCallback)((e,t)=>{let{plottableDataWide:r}=t,{sortingOrder:n,sortingType:i}=f.sorting??{},o=(0,N.eP)(b)?e=>P(e).getTime().toString():w,a=r.sort((e,t)=>(0,R.Z)(e.total??void 0,t.total??void 0)).map(o);return"desc"===n&&"byDimensionLabel"===i?[...e].sort((e,t)=>(0,ej.Z)(o(e),o(t))):"asc"===n&&"byDimensionLabel"===i?[...e].sort((e,t)=>(0,R.Z)(o(e),o(t))):"byMeasure"===i?(0,B.h)({data:e,order:a,getCategory:o,sortingOrder:n}):[...e].sort((e,t)=>(0,R.Z)(o(e),o(t)))},[w,P,f.sorting,b]),S=(0,u.Tw)(n,h,g);return ev(ev(ev(ev(ev(ev({},y),{},{sortData:Z},O),j),v),x),{},{getRenderingKey:S})},ew=(e,t)=>{let{chartConfig:r,observations:n}=e,{fields:o}=r,{y:a}=o,{sortData:l,yDimension:c,getX:u,getYAsDate:d,getY:m,getSegment:f,getSegmentAbbreviationOrLabel:p,getTimeRangeDate:g}=t,b=(0,K.Tq)(n,{getX:u}),h=(0,i.useMemo)(()=>{let e=(0,A.ZP)(b,m);return(0,K.gS)({dataGrouped:e,key:a.componentId,getAxisValue:u,getSegment:f})},[b,u,a.componentId,m,f]),y=(0,i.useCallback)(e=>l(e,{plottableDataWide:h}),[h,l]);return ev(ev({},(0,s.q1)(b,{sortData:y,chartConfig:r,timeRangeDimensionId:c.id,getAxisValueAsDate:d,getSegmentAbbreviationOrLabel:p,getTimeRangeDate:g})),{},{plottableDataWide:h})};var eP=r(35696),eZ=r(26006),eS=r(70022),ek=r(8788);let eD=["children"];function eM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eA(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eM(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eM(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eE=(e,t,r)=>{let{chartConfig:n,dimensions:o,measures:a}=e,{yDimension:l,xMeasure:s,getX:c,getYAsDate:u,getYAbbreviationOrLabel:d,getYLabel:m,getY:f,formatYDate:p,segmentDimension:g,segmentsByAbbreviationOrLabel:b,getSegment:h,getSegmentAbbreviationOrLabel:y,getSegmentLabel:j,xAxisLabel:O,yAxisLabel:v}=t,x=(0,K.vc)(s.id),{chartData:w,scalesData:P,segmentData:Z,timeRangeData:S,paddingData:k,allData:D}=r,{fields:M,interactiveFiltersConfig:T}=n,{x:F}=M,{width:R,height:U}=(0,ee.tH)(),G=(0,et.D2)({decimals:"auto"}),_=(0,W.c)(e),q=(0,ek.bI)(e=>e.calculation.type),Q=M.y.componentId,eo=(0,i.useMemo)(()=>new Map((g?.values||[]).map(e=>[e.value,e])),[g?.values]),ea=(0,i.useMemo)(()=>Object.fromEntries((0,A.jJ)(P,e=>(0,E.Z)(e,e=>c(e)),e=>h(e))),[h,c,P]),el=g?.id?n.cubes.find(e=>e.iri===g.cubeIri)?.filters[g.id]:void 0,{allSegments:es,segments:ec}=(0,i.useMemo)(()=>{let e=Array.from(new Set(Z.map(h))),t=Array.from(new Set(P.map(h))),r=M?.segment?.sorting,n=(0,en.tf)(g,{sorting:r,sumsBySegment:ea,useAbbreviations:M.segment?.useAbbreviations,dimensionFilter:el}),i=V()(e,n,(0,en.jS)(n,r));return{allSegments:i,segments:i.filter(e=>t.includes(e))}},[P,Z,g,M.segment?.sorting,M.segment?.useAbbreviations,ea,el,h]),eu=(0,i.useMemo)(()=>Object.fromEntries((0,A.jJ)(w,e=>(0,E.Z)(e,e=>c(e)),e=>f(e))),[w,c,f]),ed="percent"===q,em=(0,i.useMemo)(()=>ed?(0,A.ZP)((0,K.Fi)(w,{key:s.id,getAxisValue:c,getTotalGroupValue:e=>eu[f(e)]}),f):(0,A.ZP)(w,f),[ed,w,f,s.id,c,eu]),ef=(0,i.useMemo)(()=>(0,K.gS)({dataGrouped:em,key:Q,getAxisValue:c,getSegment:h,allSegments:ec,imputationType:"zeros"}),[h,c,em,ec,Q]),ej=n.cubes.find(e=>e.iri===l.cubeIri)?.filters[l.id],{colors:eO,yScale:ev,yTimeRangeDomainLabels:ex,yScaleInteraction:ew,yScaleTimeRange:eD}=(0,i.useMemo)(()=>{let e=(0,C.Z)();if(M.segment&&b&&M.color){let t=es.map(e=>{let t=b.get(e)?.value||eo.get(e)?.value||"";return t||console.warn(`Can't find color for '${e}'.`),{label:e,color:"segment"===M.color.type?M.color.colorMapping[t]??z.Z[0]:z.Z[0]}});e.domain(t.map(e=>e.label)),e.range(t.map(e=>e.color))}else e.domain(es),e.range((0,er.XN)({paletteId:M.color.paletteId,colorField:M.color}));e.unknown(()=>void 0);let t=[...new Set(P.map(f))],r=[...new Set(S.map(f))],n=M.y?.sorting,i=(0,en.tf)(l,{sorting:n,useAbbreviations:M.y?.useAbbreviations,measureBySegment:eu,dimensionFilter:ej}),o=V()(t,i,(0,en.jS)(i,n)),a=r.map(m),s=(0,$.Z)().domain(o).paddingInner(.1).paddingOuter(0),c=(0,$.Z)().domain(o).paddingInner(0).paddingOuter(0),d=(0,I.Z)(S,e=>u(e));return{colors:e,yScale:s,yTimeRangeDomainLabels:a,yScaleTimeRange:(0,H.Z)().domain(d),yScaleInteraction:c}},[M.color,M.segment,M.y.sorting,M.y.useAbbreviations,l,ej,eu,f,m,u,P,S,b,eo,es]),eM=M.animation?.componentId,eE=(0,i.useCallback)(e=>eM?e[eM]:"",[eM]),eI=(0,i.useMemo)(()=>(0,eS.A1)(P,{normalize:ed,getY:f,getX:c,getTime:eE,customDomain:F.customDomain}),[P,ed,c,f,eE,F.customDomain]),eT=(0,i.useMemo)(()=>{if(T.calculation.active){let e=(0,eS.A1)(k,{normalize:!1,getX:c,getY:f,getTime:eE,customDomain:F.customDomain});return e.domain()[1]<100&&e.domain()[0]>-100?(0,L.Z)().domain([0,100]):e}return(0,eS.A1)(k,{normalize:ed,getX:c,getY:f,getTime:eE,customDomain:F.customDomain})},[T.calculation.active,k,ed,c,f,eE,F.customDomain]),eC=(0,i.useMemo)(()=>{let e=M.segment?.sorting,t=e?.sortingType,r=e?.sortingOrder,n="byTotalSize"===t?"asc"===r?ep.Z:eg.Z:eb.Z;return(0,eh.Z)().order(n).offset(ey.Z).keys(ec)(ef)},[ef,M.segment?.sorting,ec]),{top:e$,left:eH,bottom:eL}=(0,X.u8)({xLabelPresent:!!s.label,yScale:eT,width:R,height:U,interactiveFiltersConfig:T,formatNumber:G,bandDomain:ex.every(e=>void 0===e)?ev.domain():ex,normalize:ed,isFlipped:!0}),ez=(0,X.Ti)({label:v,width:R}),eF=(0,X.Ti)({label:O,width:R}),eV={top:J.L+e$+ez.offset,right:40,bottom:eL+45,left:eH},eR=ev.domain().length,eK=(0,X.vG)({width:R,left:eH,right:40}),eN=(0,X.dE)({width:R,chartWidth:eK,height:U,margins:eV}),{chartHeight:eB}=eN,eU=16*eR>eB?16*eR:eB;ev.range([0,eU]),ew.range([0,eU]),eD.range([0,eU]),eI.range([0,eK]);let eG=(0,ei.d)(),e_=(0,i.useCallback)(e=>(0,N.fF)(l)?p(e):m(e),[l,p,m]),eq=(0,i.useCallback)((e,t)=>{let r,n,{segment:i,focusingSegment:o}=t,a=f(e);if(o)r=(0,eS.R0)({observation:e,series:eC,key:Q,getAxisValue:f,measureScale:eI,fallbackMeasureValue:eI(c(e)??0),segment:i}),n=eO(i);else{let e=(em.get(a)??[]).map(c);r=eI((0,E.Z)(e.map(e=>e??0)))+eP.x}return{x:r,y:ev(a)+.5*ev.bandwidth(),color:n}},[eO,c,f,eC,eI,Q,ev,em]),eX=(0,i.useCallback)(e=>{let t=ev.bandwidth(),r=f(e),n=em.get(r)??[],i=n.map(c),o=(0,B.h)({data:n,order:ec,getCategory:h,sortingOrder:"asc"}),a=(0,eS.S8)({normalize:ed,measureId:s.id,measureUnit:s.unit,formatters:_,formatNumber:G}),l=ev(r)+.5*t,u=eG?eB:eI((0,E.Z)(i.map(e=>e??0))),m=eG?Y.h0:(0,Y.Y7)({chartWidth:eK,xAnchor:u,topAnchor:!M.segment}),p=d(e);return{yAnchor:l+("top"===m.y?t:0),xAnchor:u,placement:m,value:e_(p),datum:{label:M.segment&&y(e),value:a(c(e),x(e)),color:eO(h(e))},values:o.map(e=>{let t=h(e),r=(0,eS.R0)({observation:e,series:eC,key:Q,getAxisValue:f,measureScale:eI,fallbackMeasureValue:eI(c(e)??0),segment:t});return{label:y(e),value:a(c(e),x(e)),axis:"x",axisOffset:r,color:eO(t)}})}},[ev,f,em,c,ec,h,ed,s.id,s.unit,_,G,eG,eB,eI,eK,M.segment,d,e_,y,x,eO,eC,Q]),eY=(0,eZ.wI)({measureId:s.id,dimensions:o,measures:a,normalize:ed});return eA({chartType:"bar",chartDataGroupedByY:em,bounds:eA(eA({},eN),{},{chartHeight:eU}),chartData:w,allData:D,xScale:eI,yScaleInteraction:ew,yScaleTimeRange:eD,yScale:ev,segments:ec,colors:eO,getColorLabel:j,chartWideData:ef,series:eC,getAnnotationInfo:eq,getTooltipInfo:eX,leftAxisLabelSize:ez,leftAxisLabelOffsetTop:e$,bottomAxisLabelSize:eF,valueLabelFormatter:eY,formatYAxisTick:e_},t)},eI=e=>{let{children:t}=e,r=(0,M.Z)(e,eD),n=ex(r),i=ew(r,n),o=eE(r,n,i);return(0,O.jsx)(s._M.Provider,{value:o,children:t})},eT=e=>(0,O.jsx)(Q.o,{children:(0,O.jsx)(eI,eA({},e))});function eC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function e$(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eC(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eC(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eH=e=>{let{chartConfig:t,observations:r,dimensions:n,dimensionsById:o,measures:a,measuresById:l,limits:c}=e,{fields:m,interactiveFiltersConfig:f}=t,{x:p,y:g,animation:b,segment:h}=m,y=o[g.componentId],j=(0,d.In)(t),O=(0,s.Ck)(t),v=(0,s.Zr)("bar",p,{measuresById:l}),x=(0,s.MT)(g,{dimensionsById:o,observations:r}),w=(0,s.Xt)(p,{getValue:v.getX,dimensions:n,measures:a}),P=(0,s.SU)(f,{dimensionsById:o}),Z=(0,s.m$)(c),{getY:S,getYAsDate:k}=x,{getX:D}=v,M=(0,i.useCallback)(e=>{let{sortingOrder:t,sortingType:r}=g.sorting??{},n=(0,N.eP)(y)?k:S;return"desc"===t&&"byDimensionLabel"===r?[...e].sort((e,t)=>(0,ej.Z)(n(e),n(t))):"asc"===t&&"byDimensionLabel"===r?[...e].sort((e,t)=>(0,R.Z)(n(e),n(t))):"desc"===t&&"byMeasure"===r?[...e].sort((e,t)=>(0,ej.Z)(D(e)??-1,D(t)??-1)):"asc"===t&&"byMeasure"===r?[...e].sort((e,t)=>(0,R.Z)(D(e)??-1,D(t)??-1)):[...e].sort((e,t)=>(0,R.Z)(n(e),n(t)))},[D,k,S,g.sorting,y]),A=(0,s.HR)(h,{dimensionsById:o,observations:r}),E=(0,u.Tw)(n,j,b);return e$(e$(e$(e$(e$(e$(e$(e$({},A),O),{},{sortData:M},x),v),w),P),Z),{},{getRenderingKey:E})},eL=(e,t)=>{let{chartConfig:r,observations:n}=e,{sortData:i,yDimension:o,getYAsDate:a,getX:l,getTimeRangeDate:c}=t,u=(0,K.Tq)(n,{getX:l});return(0,s.q1)(u,{sortData:i,chartConfig:r,timeRangeDimensionId:o.id,getAxisValueAsDate:a,getTimeRangeDate:c})};var ez=r(62326);let eF=["offset"],eV=["children"];function eR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function eK(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?eR(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eR(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let eN=(e,t,r)=>{let{chartConfig:n,dimensions:o,measures:a}=e,{yDimension:l,getX:s,getYAsDate:c,getYAbbreviationOrLabel:u,getYLabel:d,formatYDate:m,xMeasure:f,getY:p,getMinX:g,getXErrorRange:b,getFormattedXUncertainty:h,getSegmentLabel:y,xAxisLabel:j,yAxisLabel:O,minLimitValue:v,maxLimitValue:x}=t,{chartData:w,scalesData:P,timeRangeData:Z,paddingData:S,allData:k}=r,{fields:D,interactiveFiltersConfig:z}=n,{x:F}=D,{width:R,height:K}=(0,ee.tH)(),B=(0,et.D2)({decimals:"auto"}),U=(0,W.c)(e),G=(0,i.useMemo)(()=>Object.fromEntries((0,A.jJ)(w,e=>(0,E.Z)(e,e=>s(e)),e=>p(e))),[w,s,p]),{xScale:_,paddingXScale:q,yScale:Q,minY:eo,yScaleTimeRange:ea,yScaleInteraction:el,yTimeRangeDomainLabels:es}=(0,i.useMemo)(()=>{let e=(0,en.tf)(l,{sorting:D.y.sorting,measureBySegment:G,useAbbreviations:D.y.useAbbreviations,dimensionFilter:l?.id?n.cubes.find(e=>e.iri===l.cubeIri)?.filters[l.id]:void 0}),t=(0,en.jS)(e,D.y.sorting),r=V()([...new Set(P.map(p))],e,t),i=[...new Set(Z.map(p))].map(d),o=(0,$.Z)().domain(r).paddingInner(.1).paddingOuter(0),a=(0,$.Z)().domain(r).paddingInner(0).paddingOuter(0),u=(0,I.Z)(Z,e=>c(e)),m=(0,H.Z)().domain(u),f=(0,L.Z)(),h=(0,L.Z)();if(F.customDomain)f.domain(F.customDomain),h.domain(F.customDomain);else{let e=g(P,e=>b?.(e)[0]??s(e)),t=Math.max((0,T.Z)(P,e=>b?.(e)[1]??s(e))??0,0);f.domain([void 0!==v?Math.min(v,e):e,void 0!==x?Math.max(x,t):t]).nice();let r=g(S,e=>b?.(e)[0]??s(e)),n=Math.max((0,T.Z)(S,e=>b?.(e)[1]??s(e))??0,0);h.domain([void 0!==v?Math.min(v,r):r,void 0!==x?Math.max(x,n):n]).nice()}return{xScale:f,yScale:o,minY:r[0],paddingXScale:h,yScaleTimeRange:m,yScaleInteraction:a,yTimeRangeDomainLabels:i}},[l,D.y.sorting,D.y.useAbbreviations,G,n.cubes,P,p,Z,d,g,v,x,S,c,b,s,F.customDomain]),{top:ec,left:eu,bottom:ed}=(0,X.u8)({xLabelPresent:!!f.label,yScale:q,width:R,height:K,interactiveFiltersConfig:z,formatNumber:B,bandDomain:es.every(e=>void 0===e)?Q.domain():es,isFlipped:!0}),em=(0,X.Ti)({label:O,width:R}),ef=(0,X.Ti)({label:j,width:R}),ep={top:J.L+ec+em.offset,right:40,bottom:ed+45,left:eu},eg=(0,eZ.fv)(F,{chartData:w,dimensions:o,measures:a,getValue:s,getErrorRange:b,scale:_}),{offset:eb}=eg,eh=(0,M.Z)(eg,eF),ey=(0,X.vG)({width:R,left:eu,right:40}),ej=(0,X.dE)({width:R,chartWidth:ey,height:K,margins:ep}),{chartHeight:eO}=ej,ev=Q.domain().length,ex=16*ev>eO?16*ev:eO;_.range([0,ey-eb]),el.range([0,ex]),ea.range([0,ex]),Q.range([0,ex]);let ew=(0,ei.d)(),eS=(0,i.useCallback)(e=>(0,N.fF)(l)?m(e):d(e),[l,m,d]),ek=(0,i.useCallback)(e=>{let t=eh.showValues?eb+8:0;return{x:_(Math.max(s(e)??NaN,0))+eP.x+t,y:Q(p(e))+.5*Q.bandwidth(),color:ez.i}},[eh.showValues,eb,_,s,Q,p]),{segments:eD,colors:eM}=(0,i.useMemo)(()=>{let e=(0,C.Z)();return e.range((0,er.XN)({paletteId:D.color.paletteId,colorField:D.color})),{segments:[],colors:e}},[D.color]);return eK(eK({chartType:"bar",bounds:eK(eK({},ej),{},{chartHeight:ex}),chartData:w,allData:k,xScale:_,minY:eo,yScaleTimeRange:ea,yScaleInteraction:el,yScale:Q,getAnnotationInfo:ek,getTooltipInfo:e=>{let t;let r=Q(p(e))+.5*Q.bandwidth(),n=ew?eO:_(Math.max(s(e)??NaN,0)),i=ew?Y.h0:(0,Y.Y7)({chartWidth:ey,xAnchor:r,topAnchor:!D.segment}),o=u(e),a=s(e);return{xAnchor:n,yAnchor:r,placement:i,value:eS(o),datum:{label:void 0,value:null!==a&&isNaN(a)?"-":`${t=s(e),(0,et._1)(t,U[f.id]??B,f.unit)}`,error:h(e),color:""},values:void 0}},getColorLabel:y,segments:eD,colors:eM,leftAxisLabelSize:em,leftAxisLabelOffsetTop:ec,bottomAxisLabelSize:ef,formatYAxisTick:eS},eh),t)},eB=e=>{let{children:t}=e,r=(0,M.Z)(e,eV),n=eH(r),i=eL(r,n),o=eN(r,n,i);return(0,O.jsx)(s._M.Provider,{value:o,children:t})},eU=e=>(0,O.jsx)(Q.o,{children:(0,O.jsx)(eB,eK({},e))});var eG=r(18330),e_=r(40907);let eq=e=>{let{disableGaps:t=!0}=e,{chartData:r,bounds:{chartWidth:n,margins:i},getY:o,yScale:a,yScaleInteraction:l}=(0,s.gH)(),{onClick:c,onHover:u,onHoverOut:d}=(0,e_.A)({focusingSegment:!1}),m=t?l:a,f=m.bandwidth();return(0,O.jsx)("g",{transform:`translate(${i.left} ${i.top})`,children:r.map((e,t)=>(0,O.jsx)("rect",{x:0,y:m(o(e)),height:f,width:Math.max(0,n),stroke:"none",fill:"hotpink",fillOpacity:0,onMouseOver:()=>u(e,{segment:void 0}),onMouseOut:d,onClick:()=>c(e,{segment:void 0})},t))})},eX=()=>{let{bounds:{height:e,margins:t},series:r}=(0,s.gH)(),{onClick:n,onHover:o,onHoverOut:a}=(0,e_.A)({focusingSegment:!0}),l=p(),c=(0,i.useMemo)(()=>r.flatMap(l),[l,r,e]);return(0,O.jsx)("g",{transform:`translate(${t.left} ${t.top})`,children:c.map(e=>(0,O.jsx)("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:"hotpink",fillOpacity:0,stroke:"none",onMouseOver:()=>o(e.observation,{segment:e.segment}),onMouseOut:a,onClick:()=>n(e.observation,{segment:e.segment})},e.key))})},eY=()=>{let{bounds:e,getY:t,getX:r,yScale:n,xScale:o,chartDataGroupedByY:a,yDimension:l}=(0,s.gH)(),c=(0,i.useCallback)(e=>r(e)??0,[r]);return(0,O.jsx)(eG.x,{bounds:e,getValue:c,getAxisValue:t,valueScale:o,axisScale:n,chartDataGrouped:a,dimension:l,isHorizontal:!0})};var eJ=r(93226),eW=r(27454),eQ=r(97358);let e0=()=>{let e=(0,i.useRef)(null),{xScale:t,getYLabel:r,yTimeUnit:n,yScale:o,bounds:a,yDimension:l,leftAxisLabelSize:c,leftAxisLabelOffsetTop:d,formatYAxisTick:m}=(0,s.gH)(),f=(0,j.K)(e=>e.enable),p=(0,j.K)(e=>e.duration),g=(0,et.z6)(),{chartHeight:b,margins:h}=a,{labelColor:v,axisLabelFontSize:x,gridColor:w,labelFontSize:P,fontFamily:Z,domainColor:S}=(0,y.$)(),k=o.bandwidth(),D=k>P?P:k;return(0,i.useEffect)(()=>{if(e.current){let r=t.domain()[0]<0,n=(0,eW.y4)(o).tickSizeOuter(0).tickSizeInner(r?-b:6).tickFormat(m??(e=>e)),i=(0,u.sS)(e.current,{id:"axis-height-band",transform:`translate(${h.left} ${h.top})`,transition:{enable:f,duration:p},render:e=>e.attr("data-testid","axis-height-band").call(n),renderUpdate:(e,t)=>(0,u.u5)(e,{transition:t.transition,s:e=>e.call(n)})});i.select(".domain").remove(),i.selectAll(".tick line").attr("stroke",r?w:S),i.selectAll(".tick text").attr("font-size",D).attr("font-family",Z).attr("fill",v).attr("text-anchor","unset")}},[b,S,f,Z,g,r,w,v,P,h.left,h.top,p,t,n,o,D,m]),(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)("g",{ref:e}),(0,O.jsx)("foreignObject",{y:d,width:c.width,height:c.height,style:{display:"flex"},children:(0,O.jsx)(eQ.K,{component:l,children:(0,O.jsx)("span",{style:{fontSize:x,lineHeight:1.5},children:l.label})})})]})},e1=()=>{let e=(0,i.useRef)(null),t=(0,j.K)(e=>e.enable),r=(0,j.K)(e=>e.duration),{xScale:n,yScale:o,bounds:a,minY:l}=(0,s.gH)(),{chartHeight:c,margins:d}=a,{domainColor:m}=(0,y.$)();return(0,i.useEffect)(()=>{if(e.current){let n=(0,eW.y4)(o).tickSizeOuter(0),i=(0,u.sS)(e.current,{id:"axis-height-band-domain",transform:`translate(${d.left} ${d.top})`,transition:{enable:t,duration:r},render:e=>e.call(n),renderUpdate:(e,t)=>(0,u.u5)(e,{transition:t.transition,s:e=>e.call(n)})});i.selectAll(".tick line").remove(),i.selectAll(".tick text").remove(),i.select(".domain").attr("transform","translate(0, 0)").attr("stroke",m)}},[l,a.chartHeight,c,m,t,d.left,d.top,r,n,o]),(0,O.jsx)("g",{ref:e})};var e4=r(43334),e2=r(2424),e8=r(50051),e6=r(83001),e3=r(36831),e5=r(18984),e7=r(80750),e9=r(40964);function te(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}let tt=e=>{let t=(0,s.gH)(),r=(0,i.useMemo)(()=>(0,e9.x)({isHorizontal:!0,getChartState:()=>t}),[t]);return(0,O.jsx)(r,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?te(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):te(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e))};tt.displayName="HorizontalLimits";var tr=r(71238),tn=r(4148);function ti(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function to(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ti(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let ta=e=>(0,O.jsx)(eJ.F,to(to({},e),{},{Component:tl})),tl=(0,i.memo)(e=>{let{chartConfig:t,dimensions:r,dimensionsById:n,measures:i}=e,{fields:o,interactiveFiltersConfig:a}=t,s=(0,d.In)(t),[{dashboardFilters:c}]=(0,m.lY)(tr.Sc),u=(0,e8.O)(a,c?.timeRange),f=(0,d.sH)({chartConfig:t,dimensions:r,measures:i}),p=(0,l.I4)();return(0,O.jsx)(O.Fragment,{children:o.segment?.componentId&&"stacked"===o.segment.type?(0,O.jsxs)(eT,to(to({},e),{},{children:[(0,O.jsxs)(e6.BO,{children:[(0,O.jsxs)(e6.ST,{children:[(0,O.jsx)(e2.L,{}),(0,O.jsx)(e4.g,{}),(0,O.jsx)(e0,{}),(0,O.jsx)(e1,{}),(0,O.jsx)(ef,{}),p?(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(eq,{disableGaps:!1}),(0,O.jsx)(eX,{}),(0,O.jsx)(eY,{})]}):(0,O.jsx)(eq,{}),u&&(0,O.jsx)(e8.j,{})]}),p?(0,O.jsx)(e3.r,{}):(0,O.jsx)(e5.u,{type:"multiple"})]}),(0,O.jsx)(eP.u,{}),(0,O.jsxs)(e6.dt,{children:[o.animation&&(0,O.jsx)(tn.j,to({filters:s,dimensions:r},o.animation)),(0,O.jsx)(e7.Ek,{dimensionsById:n,chartConfig:t,symbol:"square",interactive:a.legend.active,showTitle:o.segment.showTitle})]})]})):o.segment?.componentId&&"grouped"===o.segment.type?(0,O.jsxs)(eu,to(to({},e),{},{children:[(0,O.jsxs)(e6.BO,{children:[(0,O.jsxs)(e6.ST,{children:[(0,O.jsx)(e2.L,{}),(0,O.jsx)(e4.g,{}),(0,O.jsx)(e0,{}),(0,O.jsx)(e1,{}),(0,O.jsx)(D,{}),(0,O.jsx)(k,{}),(0,O.jsx)(eq,{}),u&&(0,O.jsx)(e8.j,{})]}),(0,O.jsx)(e5.u,{type:"multiple"})]}),(0,O.jsxs)(e6.dt,{children:[o.animation&&(0,O.jsx)(tn.j,to({filters:s,dimensions:r},o.animation)),(0,O.jsx)(e7.Ek,{dimensionsById:n,chartConfig:t,symbol:"square",interactive:a.legend.active,showTitle:o.segment.showTitle})]})]})):(0,O.jsxs)(eU,to(to({},e),{},{limits:f,children:[(0,O.jsxs)(e6.BO,{children:[(0,O.jsxs)(e6.ST,{children:[(0,O.jsx)(e2.L,{}),(0,O.jsx)(e4.g,{}),(0,O.jsx)(e0,{}),(0,O.jsx)(e1,{}),(0,O.jsx)(P,{}),(0,O.jsx)(w,{}),(0,O.jsx)(tt,to({},f)),(0,O.jsx)(eq,{}),u&&(0,O.jsx)(e8.j,{})]}),p?(0,O.jsx)(e3.r,{}):(0,O.jsx)(e5.u,{type:"single"})]}),(0,O.jsx)(eP.u,{}),o.animation||f.limits.length>0?(0,O.jsxs)(e6.dt,{children:[f.limits.length>0&&(0,O.jsx)(e7.Ek,{limits:f,dimensionsById:n,chartConfig:t,symbol:"square"}),o.animation&&(0,O.jsx)(tn.j,to({filters:s,dimensions:r},o.animation))]}):null]}))})})},2424:function(e,t,r){r.d(t,{L:function(){return p},b:function(){return g}});var n=r(27454),i=r(27378),o=r(86932),a=r(43137),l=r(80491),s=r(3663),c=r(97358),u=r(41494),d=r(80733),m=r(87358),f=r(24246);let p=()=>{let e=(0,u.D2)(),{xScale:t,bounds:r,xAxisLabel:p,xMeasure:g,chartType:b,bottomAxisLabelSize:h}=(0,a.gH)(),{chartWidth:y,chartHeight:j,margins:O}=r,{labelColor:v,labelFontSize:x,axisLabelFontSize:w,gridColor:P,fontFamily:Z}=(0,s.$)(),S=(0,o.Fc)(),k=(0,i.useRef)(null),D=(0,d.K)(e=>e.enable),M=(0,d.K)(e=>e.duration);return(0,i.useEffect)(()=>{if(k.current){let i=(0,m.m)(e(t.domain()[1]),{fontSize:x}),o=Math.min(r.chartWidth/(i+20),4),a=t.ticks(o),s=(0,n.LL)(t).tickValues(a).tickSizeInner(-j-10).tickSizeOuter(-j).tickFormat(e),c=(0,l.sS)(k.current,{id:"axis-width-linear",transform:`translate(${O.left} ${j+O.top})`,transition:{enable:D,duration:M},render:e=>e.call(s),renderUpdate:(e,t)=>(0,l.u5)(e,{transition:t.transition,s:e=>e.call(s)})});c.selectAll(".tick line").attr("y1",10).attr("stroke",(e,t)=>0===t?"#000000":P).attr("stroke-width",1),c.selectAll(".tick text").attr("font-size",x).attr("font-family",Z).attr("fill",v).attr("dy",x+10).attr("text-anchor","middle"),c.select("path.domain").attr("stroke",P),"bar"===b&&c.select("path.domain").remove()}},[b,r.chartWidth,j,D,Z,e,P,v,x,O.left,O.top,M,t]),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("foreignObject",{x:O.left+y/2-h.width/2,y:O.top+j+S,width:y,height:h.height,style:{display:"flex"},children:(0,f.jsx)(c.K,{component:g,children:(0,f.jsx)("span",{style:{fontSize:w,lineHeight:1.5},children:p})})}),(0,f.jsx)("g",{ref:k})]})},g=()=>{let{xScale:e,yScale:t,bounds:r}=(0,a.gH)(),{chartHeight:o,margins:c}=r,{domainColor:u}=(0,s.$)(),m=(0,i.useRef)(null),p=(0,d.K)(e=>e.enable),g=(0,d.K)(e=>e.duration);return(0,i.useEffect)(()=>{if(m.current){let i=(0,n.LL)(e).tickSizeOuter(0),a=(0,l.sS)(m.current,{id:"axis-width-linear-domain",transform:`translate(${c.left} ${o+c.top})`,transition:{enable:p,duration:g},render:e=>e.call(i),renderUpdate:(e,t)=>(0,l.u5)(e,{transition:t.transition,s:e=>e.call(i)})});a.selectAll(".tick line").remove(),a.selectAll(".tick text").remove(),a.select("path.domain").attr("data-name","width-axis-domain").attr("transform",`translate(0, -${r.chartHeight-t(0)})`).attr("stroke",u)}},[r.chartHeight,o,u,p,c.left,c.top,g,e,t]),(0,f.jsx)("g",{ref:m})}},18330:function(e,t,r){r.d(t,{x:function(){return u}});var n=r(50228),i=r(27378),o=r(93730),a=r(80491),l=r(81364),s=r(24246);let c=e=>{let{x:t,y:r,width:n,height:i}=e;return(0,s.jsx)("rect",{x:t,y:r,width:n,height:i,fill:"none",stroke:a.x_,strokeWidth:a.iE,pointerEvents:"none"})},u=e=>{let{bounds:t,getValue:r,getAxisValue:a,valueScale:u,axisScale:d,chartDataGrouped:m,dimension:f,isHorizontal:p}=e,[g]=(0,l.X)(),b=(0,o.gf)(),h=d.bandwidth(),y=(0,i.useCallback)(e=>{let t=d(e),i=m.get(e)??[],o=(0,n.Z)(i,r)??0,a=u(0),l=u(o),s=Math.abs(l-a);return p?{x:a,y:t,width:s,height:h}:{x:t,y:l,width:h,height:s}},[m,r,u,d,h,p]),j=(0,i.useMemo)(()=>{t.width;let e=[];if(g.observation&&"annotation"===g.type&&g.visible&&!g.focusingSegment){let t=a(g.observation),{focused:r}=b(g.observation,{axisComponentId:f.id,axisValue:t});r&&e.push(y(t))}for(let[t,r]of m){let{focused:n,isActive:i}=b(r[0],{axisComponentId:f.id,axisValue:t});(i||n&&"annotation"===g.type&&!g.focusingSegment)&&e.push(y(t))}return e},[t.width,g,a,b,f.id,y,m]);return 0===j.length?null:(0,s.jsx)("g",{transform:`translate(${t.margins.left} ${t.margins.top})`,children:j.map((e,t)=>(0,s.jsx)(c,{x:e.x,y:e.y,width:e.width,height:e.height},t))})}},4148:function(e,t,r){r.d(t,{j:function(){return T}});var n=r(17043),i=r(60116),o=r(87026),a=r(12548),l=r(56125),s=r(64986),c=r(40624),u=r(43605),d=r.n(u),m=r(27378),f=r(70644),p=r(43137),g=r(99990),b=r(10359),h=r(15658),y=r(64103),j=r(17510),O=r(41494),v=r(48947),x=r(27102),w=r(8788),P=r(7378),Z=r(7673),S=r(77142),k=r(71171),D=r(24246);function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function A(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let E=(0,m.createContext)(void 0),I=()=>{let e=(0,m.useContext)(E);if(!e)throw Error("useTimeline must be called inside a TimelineContext.Provider!");return(0,f.useSyncExternalStore)(e.subscribe,e.getUpdateKey),e},T=e=>{let{componentId:t,showPlayButton:r,type:n,duration:i,filters:o,dimensions:a}=e,[l]=(0,x.lY)(h.Sc),s=(0,m.useMemo)(()=>a.find(e=>e.id===t),[t,a]),c=(0,y.fF)(s),u=(0,y.eP)(s),f=(0,y.a6)(s);if(!(c||u||f))throw Error("You can only use TimeSlider with temporal dimensions!");let g=(0,O.z6)(),v="timeUnit"in s?s.timeUnit:void 0,w=(0,p.gH)(),S=o[s.id],k=(0,m.useMemo)(()=>{let e={animationType:n,msDuration:1e3*i},t=Array.from(new Set(w.allData.map(e=>e[s.id]).filter(j.y)));if(c)return A({type:"interval",msValues:t.map(e=>(0,b.sG)(e).getTime()),formatValue:e=>g(new Date(e),v)},e);{let r={sortingType:"byAuto",sortingOrder:"asc"},n=(0,Z.tf)(s,{dimensionFilter:S,sorting:r}),i=(0,Z.jS)(n,r);return A({type:"ordinal",sortedData:d()(t,n,i)},e)}},[n,i,w.allData,c,s,g,v,S]),M=(0,m.useMemo)(()=>new P.T(k),[k]);return l.dashboardFilters?.timeRange.active?null:(0,D.jsx)(E.Provider,{value:M,children:(0,D.jsx)(C,{showPlayButton:r})})},C=e=>{let{showPlayButton:t}=e,[r,n]=I().formattedExtent;return(0,D.jsxs)(i.Z,A(A({},k.nT),{},{sx:{display:"flex",alignItems:"center",gap:5,mb:5,mr:2.5},children:[t&&(0,D.jsx)($,{}),(0,D.jsxs)("div",{style:{position:"relative",width:"100%"},children:[(0,D.jsx)(L,{}),(0,D.jsx)(o.Z,{variant:"caption",sx:{position:"absolute",left:0,mt:2},children:r}),(0,D.jsx)(o.Z,{variant:"caption",sx:{position:"absolute",right:0,mt:2},children:n})]})]}))},$=()=>{let e=I(),t=(0,S.z)(()=>{e.playing?e.stop():e.start()});return(0,D.jsx)(a.Z,{onClick:t,variant:"outlined",style:{minHeight:32,minWidth:32,padding:0,borderRadius:"50%"},children:(0,D.jsx)(v.JO,{name:e.playing?"pause":"play",size:16})})},H=(0,s.Z)(()=>({root:{width:"100%",[`& .${l.Z.root}`]:{height:"6px",[`& .${l.Z.thumb}`]:{width:"16px",height:"16px"}}},playing:{[`& .${l.Z.thumb}`]:{transition:"none"},[`& .${l.Z.track}`]:{transition:"none"}}})),L=()=>{let e=I(),t=(0,w.bI)(e=>e.timeSlider),r=(0,w.bI)(e=>e.setTimeSlider),n=H(),i=(0,m.useMemo)(()=>e.domain.map(e=>({value:e}))??[],[e.domain]),o=(0,S.z)(t=>{e.setProgress(+t.target.value)}),a=(0,S.z)(()=>{e.stop()});return(0,m.useEffect)(()=>{e.type!==t.type&&r({type:e.type,value:void 0}),"interval"===e.type&&"interval"===t.type&&t.value?.getTime()!==e.value&&r({type:"interval",value:new Date(e.value)}),"ordinal"===e.type&&"ordinal"===t.type&&t?.value!==e.value&&r({type:"ordinal",value:e.value})},[e.value,e.type,t.type,t.value,r]),(0,D.jsx)(g.iR,{name:"time-slider",renderTextInput:!1,min:0,max:1,step:null,marks:i,value:e.progress,onChange:o,onClick:a,valueLabelDisplay:"on",valueLabelFormat:e.formattedValue,className:(0,c.Z)(n.root,e.playing&&n.playing)})}},26088:function(e,t,r){r.d(t,{Z:function(){return n}});function n(e,t){if((l=e.length)>0)for(var r,n,i,o,a,l,s=0,c=e[t[0]].length;s<c;++s)for(o=a=0,r=0;r<l;++r)(i=(n=e[t[r]][s])[1]-n[0])>0?(n[0]=o,n[1]=o+=i):i<0?(n[1]=a,n[0]=a+=i):(n[0]=0,n[1]=i)}},70585:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(89884);function i(e){var t=e.map(o);return(0,n.Z)(e).sort(function(e,r){return t[e]-t[r]})}function o(e){for(var t,r=0,n=-1,i=e.length;++n<i;)(t=+e[n][1])&&(r+=t);return r}},82965:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(70585);function i(e){return(0,n.Z)(e).reverse()}},89884:function(e,t,r){r.d(t,{Z:function(){return n}});function n(e){for(var t=e.length,r=Array(t);--t>=0;)r[t]=t;return r}},91597:function(e,t,r){r.d(t,{Z:function(){return i}});var n=r(89884);function i(e){return(0,n.Z)(e).reverse()}},8379:function(e,t,r){r.d(t,{Z:function(){return c}});var n=r(91648),i=r(1058);function o(e,t){if((i=e.length)>1)for(var r,n,i,o=1,a=e[t[0]],l=a.length;o<i;++o)for(n=a,a=e[t[o]],r=0;r<l;++r)a[r][1]+=a[r][0]=isNaN(n[r][1])?n[r][0]:n[r][1]}var a=r(89884);function l(e,t){return e[t]}function s(e){let t=[];return t.key=e,t}function c(){var e=(0,i.Z)([]),t=a.Z,r=o,c=l;function u(i){var o,a,l=Array.from(e.apply(this,arguments),s),u=l.length,d=-1;for(let e of i)for(o=0,++d;o<u;++o)(l[o][d]=[0,+c(e,l[o].key,d,i)]).data=e;for(o=0,a=(0,n.Z)(t(l));o<u;++o)l[a[o]].index=o;return r(l,a),l}return u.keys=function(t){return arguments.length?(e="function"==typeof t?t:(0,i.Z)(Array.from(t)),u):e},u.value=function(e){return arguments.length?(c="function"==typeof e?e:(0,i.Z)(+e),u):c},u.order=function(e){return arguments.length?(t=null==e?a.Z:"function"==typeof e?e:(0,i.Z)(Array.from(e)),u):t},u.offset=function(e){return arguments.length?(r=null==e?o:e,u):r},u}}}]);
//# sourceMappingURL=62034.ab46ab8cb1361eb4.js.map