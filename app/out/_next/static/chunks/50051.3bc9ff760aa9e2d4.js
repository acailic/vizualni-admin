"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50051],{50051:function(e,t,n){n.d(t,{O:function(){return j},j:function(){return w}});var r=n(17043),i=n(54417),l=n(99714),o=n(93161),s=n(59245),a=n(28810),c=n(4405),u=n(27378),m=n(50988),f=n(43137),g=n(3663),y=n(41494),h=n(8788),p=n(80733),d=n(87358),b=n(71171),T=n(24246);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}let j=(e,t)=>{let n=e.timeRange;return!t?.active&&n?.active},w=e=>{let{yOffset:t}=e,n=(0,u.useRef)(null),r=(0,h.bI)(e=>e.timeRange),v=(0,h.bI)(e=>e.setTimeRange),j=(0,h.Uq)(),w=(0,p.K)(e=>e.setEnable),O=(0,p.K)(e=>e.setBrushing),{0:k,1:E}=(0,u.useState)(!0),{0:Z,1:S}=(0,u.useState)(0),C=e=>{e?S(e[1]-e[0]):S(0)},{brushOverlayColor:P,brushSelectionColor:H,brushHandleStrokeColor:$,brushHandleFillColor:z,labelFontSize:R}=(0,g.$)(),{bounds:D,xScaleTimeRange:M,xDimension:N}=(0,f.gH)(),{chartType:_}=(0,f.gH)(),{yScaleTimeRange:U,yDimension:A}=(0,f.gH)(),I=(0,y.z6)(),K=e=>"bar"===_?I(e,A.timeUnit):I(e,N.timeUnit),{getX:q}=(0,f.gH)(),{getXAsDate:B,allData:L}=(0,f.gH)(),{getYAsDate:W}=(0,f.gH)(),Y="bar"===_?W:"column"===_||"comboLineColumn"===_?B:q,{width:F,margins:G,chartHeight:J}=D,Q="bar"===_?U:M,{from:V,to:X}=r;isNaN(X?.getTime()??0)&&(X=Q.domain()[1]);let ee=(0,d.m)(K(Q.domain()[0]),{fontSize:R})+(0,d.m)(" - ",{fontSize:R})+(0,d.m)(K(Q.domain()[1]),{fontSize:R})+12,et=F-ee-G.right,en=Q.copy();en.range([0,et]);let{0:er,1:ei}=(0,u.useMemo)(()=>en.domain().map(e=>e.getTime()),[en]),el=(0,u.useCallback)(e=>{let[t,n]=e;return(0,m.W)(L.sort((e,t)=>Y(e).getTime()-Y(t).getTime()),Y)(t,n)},[L,Y]),{0:eo,1:es}=(0,u.useMemo)(()=>V&&X?el([V,X]):en.domain(),[V,el,X,en]),ea=(0,i.Z)(e=>{let{selection:t}=e;if(E(!1),t){let[e,n]=t.map(e=>en.invert(e)),[r,i]=el([e,n]),{from:l,to:o}=j().timeRange;(l?.getTime()!==r.getTime()||o?.getTime()!==i.getTime())&&v(r,i)}}),ec=(0,o.Yu)().extent([[0,0],[et,4]]).on("start",e=>{ea(e),e.sourceEvent instanceof MouseEvent&&(w(!1),O(!0))}).on("brush",ea).on("end",function(e){if(C(e.selection),e.sourceEvent){if(e.sourceEvent instanceof MouseEvent&&(w(!0),O(!1),!e.selection&&n.current)){let t=(0,s.Z)(n.current),[r]=(0,a.Z)(e,this),i=r<0?0:r>et?et:r;t.call(ec.move,[i,i])}E(!0)}else E(!1)}),eu=(0,u.useCallback)((e,t)=>{if(V&&X){E(!1);let n=(0,l.Z)((e,t)=>Y(e).getTime()-t.getTime()).left,r=(0,l.Z)((e,t)=>Y(e).getTime()-t.getTime()).right;if(37===e.keyCode&&"w"===t){let e=n(L,V,1),t=L[e-1];Y(t).getTime()<X.getTime()?v(Y(t),X):v(V,X)}else if(39===e.keyCode&&"w"===t){let e=r(L,V,1),t=L[e];Y(t).getTime()<X.getTime()?v(Y(t),X):v(V,X)}else if(37===e.keyCode&&"e"===t){let e=n(L,X,1),t=L[e-1];Y(t).getTime()>V.getTime()?v(V,Y(t)):v(V,X)}else if(39===e.keyCode&&"e"===t){let e=r(L,X,1),t=L[e];t&&Y(t).getTime()>V.getTime()?v(V,Y(t)):v(V,X)}E(!0)}},[L,v,V,Y,X]);(0,u.useEffect)(()=>{n.current&&(0,s.Z)(n.current).call(e=>{e.call(ec),e.select(".overlay").datum({type:"selection"}).attr("fill-opacity",0).style("y","-5px").style("height",12).on("mousedown touchstart",t=>{let[[n]]=(0,c.Z)(t),r=n-Z/2,i=n+Z/2,l=r<0,o=i>et;e.call(ec.move,l?[0,Z]:o?[et-Z,et]:[r,i])},{passive:!0}),e.select(".selection").attr("fill",H).attr("fill-opacity",1).attr("stroke","none"),e.selectAll(".handle").attr("fill",z).attr("stroke",$).attr("stroke-width",2).style("y","-4px").style("width","12px").style("height","12px").attr("rx","12px"),e.select(".handle--w").attr("tabindex",0).on("keydown",e=>eu(e,"w")),e.select(".handle--e").attr("tabindex",0).on("keydown",e=>eu(e,"e"))})},[ec,et,z,$,P,H,eu,Z]);let em=eo?.toString(),ef=es?.toString();return(0,u.useEffect)(()=>{let e=(0,s.Z)(n.current);if(eo&&es&&k){let t=[en(eo),en(es)];e.transition().call(ec.move,t),E(!1)}},[en,k,v,em,ef]),(0,u.useEffect)(()=>{let e=(0,s.Z)(n.current),t=[0,Z];e.call(ec.move,t)},[er,ei]),(0,u.useEffect)(()=>{if(n.current){let e=[en(eo),en(es)];(0,s.Z)(n.current).call(ec.move,e)}},[et]),L.length?(0,T.jsxs)("g",x(x({},b.nT),{},{transform:`translate(0, ${t??J+G.top+G.bottom-24})`,children:[(0,T.jsx)("g",{children:eo&&es&&(0,T.jsx)("text",{fontSize:R,textAnchor:"start",x:0,y:0,dy:.4*R,children:`${K(eo)} - ${K(es)}`})}),(0,T.jsx)("g",{transform:`translate(${ee}, 0)`,children:(0,T.jsx)("rect",{x:0,y:0,width:et,height:4,fill:P})}),(0,T.jsx)("g",{ref:n,transform:`translate(${ee}, 0)`})]})):null}}}]);
//# sourceMappingURL=50051.3bc9ff760aa9e2d4.js.map